<!doctype html>
<html class="no-js" lang="ja">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
    <link rel="icon" href="../_static/MAINICON_0016-0256_light.ico" type="image/vnd.microsoft.icon">
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="検索" href="../search.html" /><link rel="next" title="特殊変数" href="special_variables.html" /><link rel="prev" title="サンプルコード集" href="../usage/example.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>スクリプト構文 - UWSCR 1.1.5</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">UWSCR 1.1.5</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">UWSCR 1.1.5</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=検索 name="q" aria-label="検索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">使い方</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/installation.html">インストール方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/how_to_run.html">実行方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/settings.html">設定ファイル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/how_to_build.html">ビルド方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/language_server.html">Language Server機能について</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/example.html">サンプルコード集</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">スクリプト構文</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">スクリプト構文</a></li>
<li class="toctree-l1"><a class="reference internal" href="special_variables.html">特殊変数</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ビルトイン関数</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../builtins/about_parameters.html">引数の型について</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/text.html">文字列操作関数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/window.html">ウィンドウ操作関数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/scriptcontrol.html">スクリプト制御</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/system.html">システム関数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/file.html">ファイル操作関数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/gui.html">GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/array.html">配列操作関数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/math.html">数学関数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/comobject.html">COMオブジェクト</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/excel.html">Excel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/web.html">ウェブ関連</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/socket.html">ソケット通信</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="id1">
<h1>スクリプト構文<a class="headerlink" href="#id1" title="この見出しへのパーマリンク">#</a></h1>
<section id="id2">
<h2>識別子<a class="headerlink" href="#id2" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">識別子とは変数、定数、関数などの名前を示す文字列です</div>
<div class="line">以下の文字の組み合わせで命名できます</div>
</div>
<ul class="simple">
<li><p>英字 (大文字・小文字の区別はしません)</p></li>
<li><p>数字</p></li>
<li><dl class="simple">
<dt>記号</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">_</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>全角文字</p></li>
</ul>
<section id="id3">
<h3>キーワード一覧<a class="headerlink" href="#id3" title="この見出しへのパーマリンク">#</a></h3>
<section id="id4">
<h4>識別子 (変数名、定数名、関数名など) に使用できないキーワード<a class="headerlink" href="#id4" title="この見出しへのパーマリンク">#</a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>特殊構文キーワード</dt><dd><ul>
<li><p>call</p></li>
<li><p>async</p></li>
<li><p>await</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>特殊な値を示すもの</dt><dd><ul>
<li><p>null</p></li>
<li><p>empty</p></li>
<li><p>nothing</p></li>
<li><p>true, false</p></li>
<li><p>NaN</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>演算子</dt><dd><ul>
<li><p>mod</p></li>
<li><p>and, andL, andB</p></li>
<li><p>or, orL, orB</p></li>
<li><p>xor, xorL, xorB</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
</section>
</section>
<section id="id5">
<h2>変数定義<a class="headerlink" href="#id5" title="この見出しへのパーマリンク">#</a></h2>
<section id="dim">
<h3>dim<a class="headerlink" href="#dim" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">ローカル変数を定義します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">hoge</span><span class="w">     </span><span class="c">// 変数 hoge を定義</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">fuga</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// 値の代入も同時に行える</span>
<span class="n">piyo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w">     </span><span class="c">// 未宣言変数への代入式で新たな変数が定義される(dim省略)</span>
</pre></div>
</div>
<div class="caution admonition">
<p class="admonition-title">OPTION EXPLICIT指定時の動作</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">OPTION</span> <span class="pre">EXPLICIT</span></code> を指定した場合は未宣言の変数への代入がエラーとなります</div>
<div class="line">未宣言変数への代入や複合代入は解析エラーとなります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">EXPLICIT</span>

<span class="kd">dim</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w">      </span><span class="c">// ok</span>
<span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w">          </span><span class="c">// ok</span>
<span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c">// 解析エラー</span>
<span class="n">bar</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m">4</span><span class="w">         </span><span class="c">// 解析エラー</span>
<span class="n">baz</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="m">5</span><span class="w">         </span><span class="c">// 解析エラー</span>
<span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qux</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="c">// 解析エラー</span>
</pre></div>
</div>
</div>
</section>
<section id="public">
<h3>public<a class="headerlink" href="#public" title="この見出しへのパーマリンク">#</a></h3>
<p>グローバル変数を定義します</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="n">fuga</span><span class="p">()</span><span class="w"> </span><span class="c">// 1</span>
<span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="n">fuga</span><span class="p">()</span><span class="w"> </span><span class="c">// 2</span>

<span class="kd">procedure</span><span class="w"> </span><span class="n">fuga</span><span class="p">()</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">hoge</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="const">
<h3>const<a class="headerlink" href="#const" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">定数を定義します</div>
<div class="line">再代入ができません</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// エラー</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>一括定義<a class="headerlink" href="#id6" title="この見出しへのパーマリンク">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">,</span></code> 区切りで変数を一括定義できます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">e</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="o">,</span><span class="m">5</span>
<span class="kd">public</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="kd">const</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<p>UWSCではエラーになっていたconstの一括定義も可能</p>
<div class="admonition caution">
<p class="admonition-title">注意</p>
<p>配列定義に続けて記述するのはNG</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">foo</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="w"> </span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// a = 1 は定義できない</span>
</pre></div>
</div>
</div>
</section>
<section id="id7">
<h3>配列<a class="headerlink" href="#id7" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">配列の定義はdimを使った方法と、配列リテラル(新機能)を使う方法があります</div>
<div class="line">配列の各要素には <code class="docutils literal notranslate"><span class="pre">配列変数[添字]</span></code> という書式でアクセスできます</div>
<div class="line">添字は数値で、n番目の要素に対してn-1を指定します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 従来の配列定義</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">hoge</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="c">// 1</span>

<span class="c">// 配列リテラル</span>
<span class="n">fuga</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span>
<span class="k">print</span><span class="w"> </span><span class="n">fuga</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="c">// 1</span>

<span class="c">// 配列リテラルにインデックスを指定することも可能</span>
<span class="k">print</span><span class="w"> </span><span class="p">[</span><span class="m">4</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="o">,</span><span class="w"> </span><span class="m">6</span><span class="p">][</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="c">// 4</span>
</pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">リスト末尾のカンマについて</p>
<div class="line-block">
<div class="line">dim配列宣言ではリストの末尾がカンマだと解析エラーになります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">hoge</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="o">,</span><span class="w"> </span><span class="c">// [1, 21] - リストの終端をカンマにはできません</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">配列リテラルであれば末尾カンマは有効です (無視されます)</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">fuga</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="o">,</span><span class="w"> </span><span class="p">]</span>
<span class="k">print</span><span class="w"> </span><span class="n">fuga</span><span class="w"> </span><span class="c">// [1, 2, 3]</span>

<span class="n">piyo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="m">4</span><span class="o">,</span>
<span class="w">    </span><span class="m">5</span><span class="o">,</span>
<span class="w">    </span><span class="m">6</span><span class="o">,</span>
<span class="p">]</span>
<span class="k">print</span><span class="w"> </span><span class="n">piyo</span><span class="w"> </span><span class="c">// [4, 5, 6]</span>
</pre></div>
</div>
</div>
<section id="id8">
<h4>+演算子による要素の追加<a class="headerlink" href="#id8" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">+</span></code> 演算子で配列の末尾に要素を追加できます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">4</span>
<span class="c">// [1, 2, 3, 4]</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">5</span><span class="o">,</span><span class="w"> </span><span class="m">6</span><span class="o">,</span><span class="w"> </span><span class="m">7</span><span class="p">]</span>
<span class="n">arr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m">8</span>
<span class="k">print</span><span class="w"> </span><span class="n">arr</span>
<span class="c">// [5, 6, 7, 8]</span>
</pre></div>
</div>
</section>
</section>
<section id="id9">
<h3>多次元配列<a class="headerlink" href="#id9" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="mi">2</span><span class="n">次元</span>
<span class="n">dim</span> <span class="n">配列名</span><span class="p">[</span><span class="n">要素数</span><span class="p">][</span><span class="n">要素数</span><span class="p">]</span> <span class="o">=</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span> <span class="o">...</span>
<span class="o">//</span> <span class="mi">3</span><span class="n">次元</span>
<span class="n">dim</span> <span class="n">配列名</span><span class="p">[</span><span class="n">要素数</span><span class="p">][</span><span class="n">要素数</span><span class="p">][</span><span class="n">要素数</span><span class="p">]</span> <span class="o">=</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span> <span class="o">...</span>

<span class="o">//</span> <span class="n">以下の書式も可能</span>
<span class="n">dim</span> <span class="n">配列名</span><span class="p">[</span><span class="n">要素数</span><span class="p">,</span> <span class="n">要素数</span><span class="p">]</span> <span class="o">=</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span> <span class="o">...</span>
<span class="n">dim</span> <span class="n">配列名</span><span class="p">[</span><span class="n">要素数</span><span class="p">,</span> <span class="n">要素数</span><span class="p">,</span> <span class="n">要素数</span><span class="p">]</span> <span class="o">=</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span> <span class="o">...</span>

<span class="o">//</span> <span class="n">一番左の要素数のみ省略可能</span>
<span class="n">dim</span> <span class="n">配列名</span><span class="p">[][</span><span class="n">要素数</span><span class="p">][</span><span class="n">要素数</span><span class="p">]</span> <span class="o">=</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span> <span class="o">...</span>
<span class="n">dim</span> <span class="n">配列名</span><span class="p">[,</span> <span class="n">要素数</span><span class="p">,</span> <span class="n">要素数</span><span class="p">]</span> <span class="o">=</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span><span class="p">,</span> <span class="n">値</span> <span class="o">...</span>

<span class="o">//</span> <span class="n">呼び出しは次元数分だけ</span><span class="p">[]</span><span class="n">をつける</span>

<span class="nb">print</span> <span class="n">配列名</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">3</span><span class="n">次元配列の1つ目の要素</span>
</pre></div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 不足分はEMPTYで埋められる</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">sample1</span><span class="p">[</span><span class="m">2</span><span class="p">][</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span>
<span class="k">print</span><span class="w"> </span><span class="n">sample1</span><span class="w"> </span><span class="c">// [[0, 1], [2, 3], [, ]]</span>

<span class="c">// 超過分は捨てられる</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">sample2</span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="o">,</span><span class="w"> </span><span class="m">4</span><span class="o">,</span><span class="w"> </span><span class="m">5</span>
<span class="k">print</span><span class="w"> </span><span class="n">sample2</span><span class="w"> </span><span class="c">// [[0, 1], [2, 3]]</span>

<span class="c">// 要素数省略</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">sample3</span><span class="p">[][</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="o">,</span><span class="m">5</span><span class="o">,</span><span class="m">6</span><span class="o">,</span><span class="m">7</span><span class="o">,</span><span class="m">8</span>
<span class="k">print</span><span class="w"> </span><span class="n">sample3</span><span class="w"> </span><span class="c">// [[1,2] ,[3,4], [5,6], [7,8]]</span>

<span class="c">// 一番左以外は省略不可</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">bad_sample</span><span class="p">[][][</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="c">// エラー</span>
</pre></div>
</div>
<p>配列リテラルを使って多次元配列を作ることもできます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">sample4</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="m">5</span><span class="o">,</span><span class="m">6</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="m">7</span><span class="o">,</span><span class="m">8</span><span class="p">]</span>
<span class="n">sample5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">,</span><span class="p">[</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="m">5</span><span class="o">,</span><span class="m">6</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="m">7</span><span class="o">,</span><span class="m">8</span><span class="p">]]</span>
</pre></div>
</div>
</section>
<section id="id10">
<h3>連想配列<a class="headerlink" href="#id10" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>hashtbl 連想配列変数                              // 連想配列を宣言
hashtbl 連想配列変数 = HASH_CASECARE              // キーの大文字小文字を区別
hashtbl 連想配列変数 = HASH_SORT                  // キーでソート(※1)
hashtbl 連想配列変数 = HASH_CASECARE or HASH_SORT // 大小文字区別かつソート

連想配列変数[キー] = 値                  // 任意のキー名で値を代入、数値のキーは文字列に変換される
値 = 連想配列変数[キー]                  // キー名で値を読み出す、キーがない場合はEMPTY
真偽値 = 連想配列変数[キー, HASH_EXISTS] // キーが存在するかどうか ※2
真偽値 = 連想配列変数[キー, HASH_REMOVE] // キーを削除、成功時はTRUE
キー = 連想配列変数[i, HASH_KEY]         // i番目の要素のキーを取得 ※3
値 = 連想配列変数[i, HASH_VAL]           // i番目の要素の値を取得 ※3

連想配列変数 = HASH_REMOVEALL  // 要素をすべて消す

// カンマ区切りで一括定義可能、オプションも指定できる
hashtbl 変数1, 変数2 = HASH_CASECARE, 変数3 = HASH_SORT
</pre></div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">※1</p>
<p><code class="docutils literal notranslate"><span class="pre">HASH_SORT</span></code> によるキーソート順はUWSCと異なる場合があります</p>
</div>
<div class="admonition- admonition">
<p class="admonition-title">※2</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">連想配列変数[キー,</span> <span class="pre">HASH_REMOVE]</span></code> は式であるためこれ単体では実行できません (解析時エラーとなる)</div>
<div class="line">有効な文の中に該当式を記述する必要があります (例: ダミー変数に代入)</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// エラーを回避してHASH_REMOVEする方法の例</span>

<span class="c">// 変数に代入</span>
<span class="n">_dummy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="n">key</span><span class="o">,</span><span class="w"> </span><span class="n">HASH_REMOVE</span><span class="p">]</span>

<span class="c">// 即時関数内で実行</span>
<span class="o">|</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="n">key</span><span class="o">,</span><span class="w"> </span><span class="n">HASH_REMOVE</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">ただし、replモードであればコンソールに戻り値を表示するため式のみで実行できます</div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">uwscr&gt; hoge[key, HASH_REMOVE]</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">※3</p>
<p>iは0から</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">HASH_SORT</span></code> がない場合は代入した順序</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HASH_SORT</span></code> がある場合はキーによりソートされた順序</p></li>
</ul>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">hashtbl</span><span class="w"> </span><span class="n">hoge</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">]</span><span class="w"> </span><span class="c">// 100</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;FOO&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">]</span><span class="w"> </span><span class="c">// 200 大小文字区別がないため上書きされた</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">400</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;baz&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">hoge</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">HASH_KEY</span><span class="p">]</span><span class="w"> </span><span class="c">// foo, bar, baz の順で表示される</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">HASH_VAL</span><span class="p">]</span><span class="w"> </span><span class="c">// 200, 400, 600</span>
<span class="k">next</span>

<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">HASH_EXISTS</span><span class="p">]</span><span class="w"> </span><span class="c">// true</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="s">&quot;qux&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">HASH_EXISTS</span><span class="p">]</span><span class="w"> </span><span class="c">// false</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">HASH_REMOVE</span><span class="p">]</span><span class="w"> </span><span class="c">// 変数で受けなくてもOK</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">HASH_EXISTS</span><span class="p">]</span><span class="w"> </span><span class="c">// false</span>

<span class="kd">hashtbl</span><span class="w"> </span><span class="n">fuga</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HASH_CASECARE</span>
<span class="n">fuga</span><span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="n">fuga</span><span class="p">[</span><span class="s">&quot;Foo&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="n">fuga</span><span class="p">[</span><span class="s">&quot;FOO&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>
<span class="k">print</span><span class="w"> </span><span class="n">fuga</span><span class="w"> </span><span class="c">// {&quot;foo&quot;: 1, &quot;Foo&quot;: 2, &quot;FOO&quot;: 3}</span>

<span class="kd">hashtbl</span><span class="w"> </span><span class="n">piyo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HASH_SORT</span>
<span class="n">piyo</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">piyo</span><span class="p">[</span><span class="s">&quot;z&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">piyo</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="k">print</span><span class="w"> </span><span class="n">piyo</span><span class="w"> </span><span class="c">// {&quot;A&quot;: , &quot;B&quot;: , &quot;Z&quot;: }</span>
</pre></div>
</div>
<section id="id11">
<h4>連想配列一括定義<a class="headerlink" href="#id11" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">hash-endhash</span></code> で連想配列を一括定義できます</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">hash</span> <span class="p">[</span><span class="n">public</span><span class="p">]</span> <span class="n">変数名</span> <span class="p">[</span><span class="o">=</span><span class="n">オプション</span><span class="p">]</span>
    <span class="p">[</span><span class="n">キー</span> <span class="o">=</span> <span class="n">値</span><span class="p">]</span>
<span class="n">endhash</span>
</pre></div>
</div>
<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">public</span> <span class="pre">(省略可)</span></span></dt>
<dd><p>指定するとグローバル変数、省略時はローカル変数になる</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">オプション</span> <span class="pre">(省略可)</span></span></dt>
<dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">HASH_SORT</span></code> と <code class="docutils literal notranslate"><span class="pre">HASH_CASECARE</span></code> を指定可能</div>
<div class="line">省略時はオプションなし</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">キー</span> <span class="pre">=</span> <span class="pre">値</span></span></dt>
<dd><div class="line-block">
<div class="line">キーと値の組み合わせを指定する</div>
<div class="line">複数指定可</div>
<div class="line">キーは文字列だが <cite>''</cite> や <cite>&quot;&quot;</cite> は省略可能</div>
<div class="line">一つも指定しない場合空の連想配列ができる</div>
</div>
</dd></dl>

<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 一括定義</span>
<span class="kd">hash</span><span class="w"> </span><span class="n">foobar</span>
<span class="w">    </span><span class="s">&#39;foo&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// キー = 値形式で記述</span>
<span class="w">    </span><span class="n">bar</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// キーは文字列でなくても良い</span>
<span class="kd">endhash</span>
<span class="c">// 以下と同じ</span>
<span class="c">// hashtbl foobar</span>
<span class="c">// foobar[&#39;foo&#39;] = 1</span>
<span class="c">// foobar[&#39;bar&#39;] = 2</span>

<span class="c">// グローバル変数にする</span>
<span class="kd">hash</span><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="n">pub</span>
<span class="kd">endhash</span>
<span class="c">// 以下と同じ</span>
<span class="c">// public hashtbl pub</span>

<span class="c">// オプション指定</span>
<span class="kd">hash</span><span class="w"> </span><span class="n">with_option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HASH_CASECARE</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">HASH_SORT</span>
<span class="kd">endhash</span>
<span class="c">// 以下と同じ</span>
<span class="c">// hashtbl with_option = HASH_CASECARE or HASH_SORT</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="enum">
<h2>enum<a class="headerlink" href="#enum" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">列挙体を定義します</div>
<div class="line">グローバルスコープの定数として定義されます</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">定義</span>
<span class="n">enum</span> <span class="n">定数名</span>
    <span class="n">メンバ名</span>
    <span class="n">メンバ名</span> <span class="p">[</span> <span class="o">=</span> <span class="n">数値</span><span class="p">]</span>
<span class="n">endenum</span>

<span class="o">//</span> <span class="n">呼び出し</span>
<span class="n">定数名</span><span class="o">.</span><span class="n">メンバ名</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">メンバには上から順に数値が割り当てられます (0から)</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">メンバ名</span> <span class="pre">=</span> <span class="pre">数値</span></code> とすることで任意の値を割り当てられます</div>
<div class="line">ただし前のメンバより大きな値のみ有効です</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 0から順に割り当てられる</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">E</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="c">// 0</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="c">// 1</span>
<span class="w">    </span><span class="n">baz</span><span class="w"> </span><span class="c">// 2</span>
<span class="kd">endenum</span>

<span class="c">// 呼び出しは定数名.メンバ名</span>
<span class="k">print</span><span class="w"> </span><span class="n">E</span><span class="o">.</span><span class="n">foo</span><span class="w"> </span><span class="c">// 0</span>
<span class="k">print</span><span class="w"> </span><span class="n">E</span><span class="o">.</span><span class="n">bar</span><span class="w"> </span><span class="c">// 1</span>
<span class="k">print</span><span class="w"> </span><span class="n">E</span><span class="o">.</span><span class="n">baz</span><span class="w"> </span><span class="c">// 2</span>

<span class="c">// 数値を指定</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">E</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="c">// 10</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="c">// 20</span>
<span class="kd">endenum</span>

<span class="c">// 一箇所指定するとそれ以降はその値から加算されていく</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">E</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="c">// 10</span>
<span class="w">    </span><span class="n">bar</span><span class="w">      </span><span class="c">// 11 (上の10 に +1される)</span>
<span class="w">    </span><span class="n">baz</span><span class="w">      </span><span class="c">// 12</span>
<span class="kd">endenum</span>

<span class="c">// 途中も可</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">E</span>
<span class="w">    </span><span class="n">foo</span><span class="w">      </span><span class="c">// 0</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="c">// 10</span>
<span class="w">    </span><span class="n">baz</span><span class="w">      </span><span class="c">// 11</span>
<span class="kd">endenum</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">E</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="w">    </span><span class="c">// 100</span>
<span class="w">    </span><span class="n">bar</span><span class="w">          </span><span class="c">// 101</span>
<span class="w">    </span><span class="n">baz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="w">    </span><span class="c">// 200</span>
<span class="w">    </span><span class="n">qux</span><span class="w">          </span><span class="c">// 201</span>
<span class="kd">endenum</span>

<span class="c">// 以下はNG</span>

<span class="kd">enum</span><span class="w"> </span><span class="n">E</span>
<span class="w">    </span><span class="n">foo</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="c">// 同じ名前はダメ</span>
<span class="kd">endenum</span>

<span class="c">// 前の数値より大きくないとダメ</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">E</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="c">// 0</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="c">// 1</span>
<span class="w">    </span><span class="n">baz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// 2以上じゃないとダメ</span>
<span class="kd">endenum</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">E</span>
<span class="w">    </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// 51以上じゃないとダメ</span>
<span class="kd">endenum</span>
</pre></div>
</div>
</section>
<section id="id12">
<h2>関数定義<a class="headerlink" href="#id12" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">関数名には英数字、一部記号、全角文字列が使えます</div>
<div class="line">英字の大文字小文字は区別しません</div>
</div>
<section id="procedure">
<h3>procedure<a class="headerlink" href="#procedure" title="この見出しへのパーマリンク">#</a></h3>
</section>
<section id="function">
<h3>function<a class="headerlink" href="#function" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>procedure 関数名([引数, 引数, …])
    処理
fend

function 関数名([引数, 引数, …])
    [result = 戻り値]
fend
</pre></div>
</div>
<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">procedure</span></span></dt>
<dd><p>戻り値がありません</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">function</span></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">result</span></code> 変数の値が戻り値となります</p>
<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">result</span> <span class="pre">(省略可)</span></span></dt>
<dd><div class="line-block">
<div class="line">初期値は <code class="docutils literal notranslate"><span class="pre">EMPTY</span></code> です</div>
<div class="line">記述がない場合は <code class="docutils literal notranslate"><span class="pre">EMPTY</span></code> を返します</div>
</div>
</dd></dl>

</dd></dl>

<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">hoge</span><span class="p">(</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c">// 6</span>
<span class="k">print</span><span class="w"> </span><span class="n">fuga</span><span class="p">(</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c">// 6</span>

<span class="kd">procedure</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span>
<span class="kd">fend</span>
<span class="kd">function</span><span class="w"> </span><span class="n">fuga</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span>
<span class="kd">fend</span>
</pre></div>
</div>
<p>関数定義の入れ子はダメ</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// エラーになる</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">()</span>
<span class="w">    </span><span class="kd">procedure</span><span class="w"> </span><span class="n">q</span><span class="p">()</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">fend</span>
</pre></div>
</div>
<section id="id13">
<h4>特殊な引数<a class="headerlink" href="#id13" title="この見出しへのパーマリンク">#</a></h4>
<section id="id14">
<h5>参照渡し<a class="headerlink" href="#id14" title="この見出しへのパーマリンク">#</a></h5>
<div class="line-block">
<div class="line">引数の前に <code class="docutils literal notranslate"><span class="pre">var</span></code> または <code class="docutils literal notranslate"><span class="pre">ref</span></code> キーワードをつけることで参照渡しが可能な引数になります</div>
<div class="line">引数に変数を渡すとその変数に関数実行中の変更が反映されます</div>
<div class="line">変数以外の式を渡した場合は通常の引数と同様に振る舞います</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 2</span>
<span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 6</span>
<span class="n">q</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 16</span>

<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">r</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="m">3</span>
<span class="kd">fend</span>

<span class="kd">procedure</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m">10</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="id15">
<h5>配列表記<a class="headerlink" href="#id15" title="この見出しへのパーマリンク">#</a></h5>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">引数[]</span></code> 形式で記述します</div>
<div class="line">互換性のため表記自体はできますが、動作は通常の引数と同様です</div>
<div class="line">受けられる引数を配列や連想配列に限定したい場合は <a class="reference internal" href="#type-check"><span class="std std-ref">引数の型チェック</span></a> を使用してください</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 以下は同じ意味です</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="n">arr</span><span class="p">[])</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id16">
<h5>デフォルト値<a class="headerlink" href="#id16" title="この見出しへのパーマリンク">#</a></h5>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">引数</span> <span class="pre">=</span> <span class="pre">値</span></code> とすることで引数のデフォルト値を指定できます</div>
<div class="line">値を省略した場合は <code class="docutils literal notranslate"><span class="pre">EMPTY</span></code> がデフォルト値になります</div>
<div class="line">呼び出し時に引数を渡さなかった場合デフォルト値が適用されます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w">    </span><span class="c">// 0</span>
<span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c">// 6</span>

<span class="kd">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span>
<span class="kd">fend</span>

<span class="c">// デフォルト値を省略した場合はEMPTYが入る</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="n">arg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">arg</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="c">// True</span>
<span class="kd">fend</span>
</pre></div>
</div>
<p>デフォルト値を持つ引数のあとに別の種類の引数は指定できません</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c">// ok</span>
<span class="kd">fend</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">     </span><span class="c">// エラー</span>
<span class="kd">fend</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">     </span><span class="c">// 前ならok</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="id17">
<h5>可変長引数<a class="headerlink" href="#id17" title="この見出しへのパーマリンク">#</a></h5>
<div class="line-block">
<div class="line">引数の前に <code class="docutils literal notranslate"><span class="pre">args</span></code> または <code class="docutils literal notranslate"><span class="pre">prms</span></code> キーワードをつけることで可変長の引数を受けられるようになります</div>
<div class="line">関数内ではその引数が配列になります</div>
<div class="line">可変長引数は最後の引数でなくてはいけません</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w">         </span><span class="c">// 1</span>
<span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="o">,</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c">// 5</span>

<span class="kd">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="k">args</span><span class="w"> </span><span class="n">v</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="kd">fend</span>
</pre></div>
</div>
<p>可変長引数のあとに引数があるとエラーになります</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="k">prms</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w">    </span><span class="c">// エラー</span>
<span class="kd">fend</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="k">prms</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="c">// ok</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="id18">
<h5>特殊な引数の組み合わせ<a class="headerlink" href="#id18" title="この見出しへのパーマリンク">#</a></h5>
<div class="line-block">
<div class="line">原則として組み合わせられません</div>
<div class="line">配列表記の参照渡しのみOK</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">foo</span><span class="p">[])</span><span class="w"> </span><span class="c">// これはOK</span>

<span class="c">// こういうのはダメ</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c">// 参照 + デフォルト値</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="n">bar</span><span class="p">)</span><span class="w"> </span><span class="c">// 参照 + 可変長</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">(</span><span class="n">params</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c">// 可変長 + デフォルト値</span>
</pre></div>
</div>
</section>
</section>
<section id="type-check">
<span id="id19"></span><h4>引数の型チェック<a class="headerlink" href="#type-check" title="この見出しへのパーマリンク">#</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">関数名</span><span class="p">(</span><span class="n">引数名</span><span class="p">:</span> <span class="n">型</span><span class="p">,</span> <span class="n">var</span> <span class="n">引数名</span><span class="p">:</span> <span class="n">型</span><span class="p">,</span> <span class="n">引数名</span><span class="p">:</span> <span class="n">型</span> <span class="o">=</span> <span class="n">デフォルト値</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">通常の引数、参照渡し、デフォルト値を持つ引数であれば受ける型を指定できます</div>
<div class="line">関数呼び出し時に指定した型が渡されなかった場合は実行時エラーになります</div>
</div>
<div class="line-block">
<div class="line">指定可能な型</div>
</div>
<blockquote>
<div><dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">string</span></span></dt>
<dd><div class="line-block">
<div class="line">文字列</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">number</span></span></dt>
<dd><div class="line-block">
<div class="line">数値</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">bool</span></span></dt>
<dd><div class="line-block">
<div class="line">真偽値 (TRUE/FALSE)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">array</span></span></dt>
<dd><div class="line-block">
<div class="line">配列</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">hash</span></span></dt>
<dd><div class="line-block">
<div class="line">連想配列</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">func</span></span></dt>
<dd><div class="line-block">
<div class="line">関数 (ユーザー定義、無名関数)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">uobject</span></span></dt>
<dd><div class="line-block">
<div class="line">UObject</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">クラス名</span></span></dt>
<dd><div class="line-block">
<div class="line">クラスオブジェクトのインスタンス</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">列挙体名</span></span></dt>
<dd><div class="line-block">
<div class="line">列挙体(enum)メンバの値 (該当する数値でも良い)</div>
</div>
</dd></dl>

</div></blockquote>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">str</span><span class="o">:</span><span class="w"> </span><span class="n">string</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span>
<span class="kd">fend</span>

<span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="s">&quot;hoge&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// OK</span>
<span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">    </span><span class="c">// 数値なのでエラー</span>

<span class="c">// 列挙体名指定の場合</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">Hoge</span>
<span class="w">    </span><span class="n">foo</span>
<span class="w">    </span><span class="n">bar</span>
<span class="w">    </span><span class="n">baz</span>
<span class="kd">endenum</span>

<span class="kd">function</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">Hoge</span><span class="p">)</span>
<span class="w">    </span><span class="kd">select</span><span class="w"> </span><span class="n">n</span>
<span class="w">        </span><span class="kd">case</span><span class="w"> </span><span class="n">Hoge</span><span class="o">.</span><span class="n">foo</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;foo!&#39;</span>
<span class="w">        </span><span class="kd">case</span><span class="w"> </span><span class="n">Hoge</span><span class="o">.</span><span class="n">bar</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;bar!&#39;</span>
<span class="w">        </span><span class="kd">case</span><span class="w"> </span><span class="n">Hoge</span><span class="o">.</span><span class="n">baz</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;baz!&#39;</span>
<span class="w">    </span><span class="kd">selend</span>
<span class="kd">fend</span>

<span class="k">print</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="n">Hoge</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span><span class="w"> </span><span class="c">// OK</span>
<span class="k">print</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="s">&quot;Hoge&quot;</span><span class="p">)</span><span class="w">   </span><span class="c">// 文字列はエラー</span>
<span class="k">print</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w">        </span><span class="c">// OK ※Hoge.fooに一致するため</span>
<span class="k">print</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="m">100</span><span class="p">)</span><span class="w">      </span><span class="c">// Hogeに含まれない値なのでエラー</span>
</pre></div>
</div>
</section>
</section>
<section id="id20">
<h3>無名関数<a class="headerlink" href="#id20" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">名前を持たない関数です</div>
<div class="line">変数に代入して使えます</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">変数</span> <span class="o">=</span> <span class="n">function</span><span class="p">([</span><span class="n">引数</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
    <span class="p">[</span><span class="n">result</span> <span class="o">=</span> <span class="n">戻り値</span><span class="p">]</span>
<span class="n">fend</span>
<span class="n">変数</span> <span class="o">=</span> <span class="n">procedure</span><span class="p">([</span><span class="n">引数</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
<span class="n">fend</span>
</pre></div>
</div>
<p>変数に関数を代入できます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span>
<span class="kd">fend</span>

<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c">// 5</span>
</pre></div>
</div>
<p>無名関数の中でpublic/constを宣言した場合は実行時に初めて評価されます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="c">// エラー</span>

<span class="n">proc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">procedure</span><span class="p">()</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<span class="kd">fend</span>

<span class="k">print</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="c">// エラー</span>

<span class="n">proc</span><span class="p">()</span>

<span class="k">print</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="c">// 5</span>
</pre></div>
</div>
<p>通常の関数と同様に特殊な引数も定義できます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">[]</span><span class="o">,</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="kd">fend</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">procedure</span><span class="p">(</span><span class="k">args</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="id21">
<h3>簡易関数式<a class="headerlink" href="#id21" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">無名関数を単行の式で記述できます</div>
<div class="line">通常の無名関数と異なり処理部に文は書けません(式のみ)</div>
<div class="line">その代わりに即時関数として利用できます</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>関数 = | 引数 [, 引数, …] =&gt; 式 [; 式; …] |
</pre></div>
</div>
<div class="line-block">
<div class="line">引数は,区切りで複数指定可能</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">result</span></code> は省略可能です</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">|</span>
<span class="k">print</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c">// 3</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">式は <code class="docutils literal notranslate"><span class="pre">;</span></code> 区切りで複数書けます</div>
<div class="line">この場合一番最後の式が戻り値となります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">|</span>
<span class="k">print</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c">// 8</span>
</pre></div>
</div>
<section id="id22">
<h4>即時関数<a class="headerlink" href="#id22" title="この見出しへのパーマリンク">#</a></h4>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">|</span><span class="p">(</span><span class="m">7</span><span class="o">,</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="c">// 42</span>
<span class="c">// 値だけ返す</span>
<span class="k">print</span><span class="w"> </span><span class="o">|=&gt;</span><span class="w"> </span><span class="m">42</span><span class="o">|</span><span class="p">()</span><span class="w"> </span><span class="c">// 42</span>

<span class="c">// 関数の引数にする</span>
<span class="kd">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="s">&quot;world!&quot;</span><span class="p">)</span>
<span class="kd">fend</span>
<span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;hello &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">|</span><span class="p">)</span><span class="w"> </span><span class="c">// hello world!</span>
</pre></div>
</div>
<p>特殊な引数にも対応</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">args</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="p">(</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="o">,</span><span class="m">4</span><span class="o">,</span><span class="m">5</span><span class="o">,</span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="c">// 6</span>
</pre></div>
</div>
</section>
</section>
<section id="id23">
<h3>関数の特殊な使用例<a class="headerlink" href="#id23" title="この見出しへのパーマリンク">#</a></h3>
<section id="id24">
<h4>高階関数<a class="headerlink" href="#id24" title="この見出しへのパーマリンク">#</a></h4>
<p>関数の引数に関数を指定できます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="n">Math</span><span class="p">(</span><span class="m">10</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="o">,</span><span class="w"> </span><span class="n">Add</span><span class="p">)</span><span class="w">      </span><span class="c">// 15</span>
<span class="k">print</span><span class="w"> </span><span class="n">Math</span><span class="p">(</span><span class="m">10</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="o">,</span><span class="w"> </span><span class="n">Multiply</span><span class="p">)</span><span class="w"> </span><span class="c">// 50</span>

<span class="n">subtract</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m</span>
<span class="kd">fend</span>

<span class="k">print</span><span class="w"> </span><span class="n">Math</span><span class="p">(</span><span class="m">10</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="o">,</span><span class="w"> </span><span class="n">subtract</span><span class="p">)</span><span class="w"> </span><span class="c">// 5</span>


<span class="kd">function</span><span class="w"> </span><span class="n">Math</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">func</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="kd">fend</span>

<span class="kd">function</span><span class="w"> </span><span class="n">Add</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span>
<span class="kd">fend</span>

<span class="kd">function</span><span class="w"> </span><span class="n">Multiply</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="id25">
<h4>クロージャ<a class="headerlink" href="#id25" title="この見出しへのパーマリンク">#</a></h4>
<p>関数の戻り値として関数(クロージャ)を返すことができます
クロージャは元の関数内での値を保持します</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c">// test関数内の変数nを5にする</span>
<span class="c">// 関数hogeはn=5を保持している</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="w">    </span><span class="c">// 8 (5+3が行われる)</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="m">7</span><span class="p">)</span><span class="w">    </span><span class="c">// 12 (5+7が行われる)</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="s">&quot;あ&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 5あ (5+&#39;あ&#39;が行われる)</span>

<span class="kd">function</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="id26">
<h4>エイリアス<a class="headerlink" href="#id26" title="この見出しへのパーマリンク">#</a></h4>
<p>関数を変数に代入することでその関数を別の名前で呼び出せるようになります</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="kd">fend</span>

<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hoge</span><span class="w"> </span><span class="c">// 変数hにhoge関数を代入</span>
<span class="k">print</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="s">&#39;hoge&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">// hoge</span>

<span class="c">// ビルトイン関数も代入できる</span>
<span class="n">mb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msgbox</span>
<span class="n">mb</span><span class="p">(</span><span class="s">&#39;ほげほげ&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="module">
<h3>module<a class="headerlink" href="#module" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">機能のモジュール化</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">モジュール名.メンバ名</span></code> で各機能を利用可能にします</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>module モジュール名
    const 定数名 = 式      // モジュール名.定数名 で外部からアクセス可
    public 変数名[ = 式]   // モジュール名.変数名 で外部からアクセス可
    dim 変数名[ = 式]      // 外部からアクセス不可
    procedure モジュール名 // コンストラクタ、module定義の評価直後に実行される
    procedure 関数名()     // モジュール名.関数名() で外部からアクセス可
    function 関数名()      // モジュール名.関数名() で外部からアクセス可
    textblock 定数名       // モジュール名.定数名 で外部からアクセス可
endmodule
</pre></div>
</div>
<section id="id27">
<h4>module関数内でのみ使える特殊な書式<a class="headerlink" href="#id27" title="この見出しへのパーマリンク">#</a></h4>
<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">this</span></span></dt>
<dd><p>自module内のメンバの呼び出しを明示する</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">global</span></span></dt>
<dd><p>グローバル変数および関数を呼び出す(ビルトイン含む)
(本家と異なり変数や定数も可)</p>
</dd></dl>

<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">module</span><span class="w"> </span><span class="n">sample</span>
<span class="w">    </span><span class="kd">dim</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>

<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="n">f1</span><span class="p">()</span>
<span class="w">        </span><span class="c">// 各メンバーには以下のようにアクセス可能</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">d</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">d</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">sample</span><span class="o">.</span><span class="n">d</span>

<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">p</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">p</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">sample</span><span class="o">.</span><span class="n">p</span>

<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">c</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">sample</span><span class="o">.</span><span class="n">c</span>

<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">f2</span><span class="p">()</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">f2</span><span class="p">()</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">sample</span><span class="o">.</span><span class="n">f2</span><span class="p">()</span>
<span class="w">    </span><span class="kd">fend</span>

<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="n">f2</span><span class="p">()</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>
<span class="w">    </span><span class="kd">fend</span>

<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="n">f3</span><span class="p">()</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">f4</span><span class="p">()</span><span class="w">   </span><span class="c">// in   メンバ関数が呼ばれる</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">global</span><span class="o">.</span><span class="n">f4</span><span class="p">()</span><span class="w"> </span><span class="c">// out  module外の関数が呼ばれる</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">f4</span><span class="p">()</span><span class="w">        </span><span class="c">// in   メンバ関数が呼ばれる</span>
<span class="w">    </span><span class="kd">fend</span>

<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="n">f4</span><span class="p">()</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;in&quot;</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">endmodule</span>

<span class="kd">function</span><span class="w"> </span><span class="n">f4</span><span class="p">()</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;out&quot;</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="id28">
<h4>プライベート関数<a class="headerlink" href="#id28" title="この見出しへのパーマリンク">#</a></h4>
<p>無名関数を用いたプライベート関数の実装例</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">Sample</span><span class="o">.</span><span class="n">Private</span><span class="p">()</span><span class="w"> </span><span class="c">// エラー</span>
<span class="n">Sample</span><span class="o">.</span><span class="n">Func</span><span class="p">()</span><span class="w">    </span><span class="c">// OK</span>

<span class="kd">module</span><span class="w"> </span><span class="n">Sample</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="n">Func</span><span class="p">()</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Private</span><span class="p">()</span>
<span class="w">    </span><span class="kd">fend</span>

<span class="w">    </span><span class="kd">dim</span><span class="w"> </span><span class="n">Private</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;OK&quot;</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">endmodule</span>
</pre></div>
</div>
</section>
</section>
<section id="class">
<h3>class<a class="headerlink" href="#class" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">classを定義します</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">class名()</span></code> を実行することによりインスタンスを作成します</div>
</div>
<div class="admonition caution">
<p class="admonition-title">注意</p>
<p>UWSCのclassとは互換性がありません</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">class名</span>
    <span class="n">procedure</span> <span class="n">class名</span><span class="p">()</span>    <span class="o">//</span> <span class="n">コンストラクタ</span> <span class="p">(</span><span class="n">必須</span><span class="p">)</span>
    <span class="n">procedure</span> <span class="n">_class名_</span><span class="p">()</span>  <span class="o">//</span> <span class="n">デストラクタ</span> <span class="p">(</span><span class="n">オプション</span><span class="p">)</span>
    <span class="n">const</span> <span class="n">定数名</span> <span class="o">=</span> <span class="n">式</span>      <span class="o">//</span> <span class="n">classインスタンス</span><span class="o">.</span><span class="n">定数名</span> <span class="n">で呼び出し可</span>
    <span class="n">public</span> <span class="n">変数名</span><span class="p">[</span> <span class="o">=</span> <span class="n">式</span><span class="p">]</span>   <span class="o">//</span> <span class="n">classインスタンス</span><span class="o">.</span><span class="n">変数名</span> <span class="n">で呼び出し可</span>
    <span class="n">dim</span> <span class="n">変数名</span><span class="p">[</span> <span class="o">=</span> <span class="n">式</span><span class="p">]</span>      <span class="o">//</span> <span class="n">class内からのみ呼び出し可</span>
    <span class="n">procedure</span> <span class="n">関数名</span><span class="p">()</span>     <span class="o">//</span> <span class="n">classインスタンス</span><span class="o">.</span><span class="n">関数名</span><span class="p">()</span> <span class="n">で呼び出し可</span>
    <span class="n">function</span> <span class="n">関数名</span><span class="p">()</span>      <span class="o">//</span> <span class="n">classインスタンス</span><span class="o">.</span><span class="n">関数名</span><span class="p">()</span> <span class="n">で呼び出し可</span>
    <span class="n">textblock</span> <span class="n">定数名</span>       <span class="o">//</span> <span class="n">classインスタンス</span><span class="o">.</span><span class="n">定数名</span> <span class="n">で呼び出し可</span>
<span class="n">endclass</span>
</pre></div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">h1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="m">3</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">h1</span><span class="o">.</span><span class="n">Total</span><span class="p">()</span><span class="w"> </span><span class="c">// 8</span>

<span class="n">h2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="m">8</span><span class="o">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">h2</span><span class="o">.</span><span class="n">Total</span><span class="p">()</span><span class="w"> </span><span class="c">// 18</span>

<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="m">11</span><span class="o">,</span><span class="w"> </span><span class="m">22</span><span class="p">)</span><span class="o">.</span><span class="n">Total</span><span class="p">()</span><span class="w"> </span><span class="c">// 33</span>

<span class="kd">class</span><span class="w"> </span><span class="n">hoge</span>
<span class="w">    </span><span class="kd">dim</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="w">    </span><span class="kd">procedure</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="n">Total</span><span class="p">()</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">b</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">endclass</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">注意</p>
<p>moduleと異なりclass名から直接メンバにアクセスすることはできません</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="o">.</span><span class="n">p</span><span class="p">()</span><span class="w"> </span><span class="c">// エラー</span>
</pre></div>
</div>
</div>
<section id="id29">
<h4>デストラクタ<a class="headerlink" href="#id29" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line">デストラクタはインスタンスへの参照がなくなった際に実行される関数です</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">_class名_()</span></code> で命名された関数がデストラクタとして定義されます</div>
<div class="line">デストラクタに引数は指定できません</div>
</div>
<p>デストラクタが実行されるタイミング</p>
<ul class="simple">
<li><p>すべての参照が失われたとき</p></li>
<li><dl class="simple">
<dt>いずれかのインスタンス変数に <code class="docutils literal notranslate"><span class="pre">NOTHING</span></code> を代入したとき (明示的に破棄する)</dt><dd><ul>
<li><p>インスタンス変数は <code class="docutils literal notranslate"><span class="pre">NOTHING</span></code> になります</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">with``に渡す式でインスタンスを作成した場合で</span> <span class="pre">``endwith</span></code> に到達したとき</p></li>
<li><p>関数スコープを抜ける際に削除されるこローカルスコープ変数だった場合</p></li>
<li><p>スクリプト終了時に削除されるローカル・グローバル定数だった場合</p></li>
</ul>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="n">Sample</span>
<span class="w">    </span><span class="kd">dim</span><span class="w"> </span><span class="n">msg</span>
<span class="w">    </span><span class="kd">procedure</span><span class="w"> </span><span class="n">Sample</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">msg</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="w">    </span><span class="kd">procedure</span><span class="w"> </span><span class="n">_Sample_</span><span class="p">()</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="n">msg</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">endclass</span>

<span class="n">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sample</span><span class="p">(</span><span class="s">&quot;すべての参照が失われた&quot;</span><span class="p">)</span>
<span class="n">obj2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj1</span>
<span class="n">obj3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj1</span>

<span class="n">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="n">obj2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="n">obj3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// すべての参照が失われた がprintされる</span>

<span class="n">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sample</span><span class="p">(</span><span class="s">&quot;NOTHINGが代入された&quot;</span><span class="p">)</span>
<span class="n">obj2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj1</span>
<span class="n">obj3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj1</span>

<span class="n">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NOTHING</span><span class="w"> </span><span class="c">// NOTHINGが代入された がprintされる</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj1</span><span class="w"> </span><span class="c">// NOTHING</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj2</span><span class="w"> </span><span class="c">// NOTHING</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj3</span><span class="w"> </span><span class="c">// NOTHING</span>

<span class="kd">with</span><span class="w"> </span><span class="n">Sample</span><span class="p">(</span><span class="s">&quot;withを抜けた&quot;</span><span class="p">)</span>
<span class="kd">endwith</span><span class="w"> </span><span class="c">// withを抜けた がprintされる</span>

<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">()</span>
<span class="w">    </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sample</span><span class="p">(</span><span class="s">&quot;関数スコープを抜けた&quot;</span><span class="p">)</span>
<span class="kd">fend</span>

<span class="n">p</span><span class="p">()</span><span class="w"> </span><span class="c">// 関数スコープを抜けた がprintされる</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="uobject">
<span id="id30"></span><h2>UObject<a class="headerlink" href="#uobject" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">json互換のオブジェクト</div>
</div>
<section id="id31">
<h3>オブジェクトの作成<a class="headerlink" href="#id31" title="この見出しへのパーマリンク">#</a></h3>
<ol class="arabic simple">
<li><p>UObjectリテラル: jsonを <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> で括る</p></li>
<li><p><a class="reference internal" href="../builtins/text.html#FromJson" title="FromJson"><code class="xref any py py-func docutils literal notranslate"><span class="pre">FromJson</span></code></a> 関数</p></li>
</ol>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span>
<span class="w">    </span><span class="s">&quot;foo&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;fooooo&quot;</span><span class="o">,</span>
<span class="w">    </span><span class="s">&quot;bar&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s">&quot;baz&quot;</span><span class="o">:</span><span class="w"> </span><span class="n">true</span>
<span class="w">    </span><span class="p">}</span><span class="o">,</span>
<span class="w">    </span><span class="s">&quot;qux&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="s">&quot;quux&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="p">}</span><span class="o">,</span>
<span class="w">        </span><span class="p">{</span><span class="s">&quot;quux&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="p">}</span><span class="o">,</span>
<span class="w">        </span><span class="p">{</span><span class="s">&quot;quux&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}@</span>

<span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@[</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="p">]@</span>
</pre></div>
</div>
<p>有効な値は</p>
<ul class="simple">
<li><p>数値</p></li>
<li><p>文字列</p></li>
<li><p>真偽値</p></li>
<li><p>NULL</p></li>
<li><p>配列</p></li>
<li><p>オブジェクト</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>UObjectリテラル内での変数展開について</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">&#64;</span></code> で括られたjson部分は文字列として扱われます</div>
<div class="line">これは展開可能文字列であるため <code class="docutils literal notranslate"><span class="pre">&quot;&lt;#変数名&gt;&quot;</span></code> が利用可能です</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;文字列を展開&#39;</span>
<span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">123</span>
<span class="k">textblock</span><span class="w"> </span><span class="n">baz</span>
<span class="s">,</span>
<span class="s">&quot;baz&quot;:{</span>
<span class="s">    &quot;qux&quot;: &quot;jsonの一部を一気に書き込むことも可能&quot;</span>
<span class="s">}</span>
<span class="k">endtextblock</span>

<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span>
<span class="w">    </span><span class="s">&quot;foo&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&lt;#foo&gt;&quot;</span><span class="o">,</span>
<span class="w">    </span><span class="s">&quot;bar&quot;</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;#</span><span class="n">bar</span><span class="o">&gt;</span>
<span class="w">    </span><span class="o">&lt;#</span><span class="n">baz</span><span class="o">&gt;</span>
<span class="p">}@</span>

<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span><span class="w">     </span><span class="c">// 文字列を展開</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">bar</span><span class="w">     </span><span class="c">// 123</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">baz</span><span class="o">.</span><span class="n">qux</span><span class="w"> </span><span class="c">// jsonの一部を一気に書き込むことも可能</span>
</pre></div>
</div>
</div>
</section>
<section id="id32">
<h3>値の呼び出し、変更<a class="headerlink" href="#id32" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span><span class="w"> </span><span class="c">// fooooo</span>
<span class="n">obj</span><span class="o">.</span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;FOOOOO&quot;</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span><span class="w"> </span><span class="c">// FOOOOO</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">]</span><span class="w"> </span><span class="c">// 配列の添字にしてもOK</span>

<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">baz</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;baz is true!&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;baz is fasle!&quot;</span><span class="w"> </span><span class="c">// baz is true!</span>

<span class="n">obj</span><span class="o">.</span><span class="n">qux</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">quux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">qux</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">quux</span><span class="w"> </span><span class="c">// 5</span>

<span class="n">obj</span><span class="o">.</span><span class="n">qux</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;overwrite!&quot;</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">qux</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="c">// overwrite!</span>

<span class="n">obj</span><span class="o">.</span><span class="n">corge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// エラー、追加はできない</span>

<span class="c">// オブジェクトを作って代入ならOK</span>
<span class="n">obj</span><span class="o">.</span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fromjson</span><span class="p">(</span><span class="s">&#39;{&quot;hoge&quot;: 1, &quot;fuga&quot;: 2}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span>
</pre></div>
</div>
</section>
<section id="id33">
<h3>UObjectメソッド<a class="headerlink" href="#id33" title="この見出しへのパーマリンク">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#keys" title="この定義へのパーマリンク">#</a></dt>
<dd><div class="line-block">
<div class="line">オブジェクト配下のキー名の一覧を取得します</div>
<div class="line">UObjectがオブジェクトではない場合(配列等)は空の配列を返します</div>
<div class="line">配列内の順序は元のjsonの順序と一致するとは限りません</div>
</div>
<p>parameter
:rtype: 配列(文字列)
:return: キー名の一覧</p>
<div class="admonition- admonition">
<p class="admonition-title">サンプルコード</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s">&quot;foo&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;baz&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="p">}@</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="w"> </span><span class="c">// [bar, baz, foo]</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#values" title="この定義へのパーマリンク">#</a></dt>
<dd><div class="line-block">
<div class="line">オブジェクト配下のキーが持つ値の一覧を取得します</div>
<div class="line">UObjectがオブジェクトではない場合(配列等)は空の配列を返します</div>
<div class="line">配列内の順序は元のjsonの順序と一致するとは限りませんが、インデックスはkeys()に対応します</div>
</div>
<p>parameter
:rtype: 配列(値)
:return: キーが持つ値一覧</p>
<div class="admonition- admonition">
<p class="admonition-title">サンプルコード</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s">&quot;foo&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;baz&quot;</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="p">}@</span>
<span class="k">print</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="w"> </span><span class="c">// [2, 3, 1]</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
</section>
<section id="id34">
<h2>評価の順序<a class="headerlink" href="#id34" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">グローバル変数や定数、関数定義は実行より先に評価されます</div>
</div>
<ol class="arabic simple">
<li><p>public, const, textblockを記述順に評価</p></li>
<li><dl class="simple">
<dt>function, procedure, moduleを記述順に評価</dt><dd><ul class="simple">
<li><p>関数内で宣言されているpublicやconstも評価</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>残りの構文を評価/実行する</p></li>
</ol>
</section>
<section id="id35">
<h2>スコープ<a class="headerlink" href="#id35" title="この見出しへのパーマリンク">#</a></h2>
<p>スコープは大まかに分けると</p>
<ul class="simple">
<li><p>スクリプト本文</p></li>
<li><p>関数内</p></li>
</ul>
<div class="line-block">
<div class="line">という区分になっています</div>
<div class="line">変数にはローカルとグローバルという区分があり、</div>
</div>
<ul class="simple">
<li><p>スクリプト本文のローカル変数はスクリプト本文内でしかアクセスできない</p></li>
<li><p>関数のローカル変数は関数内でしかアクセスできない</p></li>
<li><p>グローバル変数はいずれからでもアクセスできる</p></li>
</ul>
<p>という特徴があります</p>
<ul class="simple">
<li><dl class="simple">
<dt>ローカル</dt><dd><ul>
<li><dl class="simple">
<dt>dim宣言した変数</dt><dd><ul>
<li><p>宣言省略した変数も含む</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>hashtbl宣言した連想配列</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>グローバル</dt><dd><ul>
<li><dl class="simple">
<dt>public宣言した変数</dt><dd><ul>
<li><p>public hashtbl</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>const宣言した定数</p></li>
<li><p>定義した関数 (変数ではないが扱いはグローバル)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="n">global1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;グローバル変数1&quot;</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;本文ローカル&quot;</span>

<span class="k">print</span><span class="w"> </span><span class="n">global1</span><span class="w"> </span><span class="c">// ok</span>
<span class="k">print</span><span class="w"> </span><span class="n">global2</span><span class="w"> </span><span class="c">// ok</span>
<span class="k">print</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="c">// ok</span>
<span class="k">print</span><span class="w"> </span><span class="n">proc_local</span><span class="w"> </span><span class="c">// ng</span>
<span class="k">print</span><span class="w"> </span><span class="n">func</span><span class="p">()</span><span class="w"> </span><span class="c">// ok</span>

<span class="kd">procedure</span><span class="w"> </span><span class="n">proc</span><span class="p">()</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">global2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;グローバル変数2&quot;</span>
<span class="w">    </span><span class="kd">dim</span><span class="w"> </span><span class="n">proc_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;関数ローカル&quot;</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">global1</span><span class="w"> </span><span class="c">// ok</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">global2</span><span class="w"> </span><span class="c">// ok</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="c">// ng</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">proc_local</span><span class="w"> </span><span class="c">// ok</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">func</span><span class="p">()</span><span class="w"> </span><span class="c">// ok</span>
<span class="kd">fend</span>

<span class="kd">function</span><span class="w"> </span><span class="n">func</span><span class="p">()</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;関数&quot;</span>
<span class="kd">fend</span>
</pre></div>
</div>
<section id="id36">
<h3>無名関数のスコープ<a class="headerlink" href="#id36" title="この見出しへのパーマリンク">#</a></h3>
<p>無名関数の中はスコープが分かれていません
ローカル変数がそのまま使えます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="kd">fend</span>

<span class="k">print</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c">// 2</span>
</pre></div>
</div>
</section>
<section id="id37">
<h3>moduleのスコープ<a class="headerlink" href="#id37" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">moduleメンバに関しては独自のスコープを持ちます</div>
<div class="line">module関数内で定義したpublic, const, function/procedureはグローバル空間には置かれず、</div>
<div class="line">moduleメンバのみがアクセスできるmoduleローカル空間に配置されます</div>
</div>
<p>これらは <code class="docutils literal notranslate"><span class="pre">module名.メンバ名</span></code> でアクセスできます</p>
</section>
</section>
<section id="id38">
<h2>数値<a class="headerlink" href="#id38" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">UWSCRにおける数値は倍精度浮動小数点数として扱われます</div>
<div class="line">そのため、小数の演算が期待と異なる結果になる場合があります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="m">0</span><span class="o">.</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0</span><span class="o">.</span><span class="m">2</span><span class="w"> </span><span class="c">// 0.30000000000000004</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">また、UWSCとは異なり負のゼロが存在します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="o">-</span><span class="m">0</span><span class="w">      </span><span class="c">// -0</span>
<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="m">0</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;&lt;#a&gt;&quot;</span><span class="w">  </span><span class="c">// -0</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0</span><span class="w">   </span><span class="c">// 0</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="m">0</span><span class="w"> </span><span class="c">// True</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w">  </span><span class="c">// True</span>
</pre></div>
</div>
</section>
<section id="id39">
<h2>文字列<a class="headerlink" href="#id39" title="この見出しへのパーマリンク">#</a></h2>
<p>文字列リテラルは <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> または <code class="docutils literal notranslate"><span class="pre">''</span></code> で括ります
<code class="docutils literal notranslate"><span class="pre">&quot;</span></code> で括った文字列では特殊文字が展開されます
<code class="docutils literal notranslate"><span class="pre">'</span></code> で括った文字列では特殊文字が展開されません</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;文字列&quot;</span>
<span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;文字列&#39;</span>
</pre></div>
</div>
<p>文字列の結合は <code class="docutils literal notranslate"><span class="pre">+</span></code> 演算子を使います</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;文字列&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;の&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;結合&quot;</span>
<span class="k">print</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="c">// 文字列の結合</span>
</pre></div>
</div>
<section id="id40">
<h3>特殊文字の展開<a class="headerlink" href="#id40" title="この見出しへのパーマリンク">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> で括った文字列中にある以下の特殊文字は、それぞれ該当する別の文字に変換されます</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;#CR&gt;</span></code>: 改行 (CRLF)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;#TAB&gt;</span></code>: タブ文字</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;#DBL&gt;</span></code>: ダブルクォーテーション (<code class="docutils literal notranslate"><span class="pre">&quot;</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;#NULL&gt;</span></code>: NULL文字 (<code class="docutils literal notranslate"><span class="pre">chr(0)</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;#変数名&gt;</span></code>: 変数が存在する場合、その値</p></li>
</ul>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="s">&quot;hoge&lt;#CR&gt;fuga&lt;#CR&gt;piyo&quot;</span>
<span class="c">// hoge</span>
<span class="c">// fuga</span>
<span class="c">// piyo</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;hoge&lt;#TAB&gt;fuga&lt;#TAB&gt;piyo&quot;</span>
<span class="c">// hoge    fuga    piyo</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;&lt;#DBL&gt;hoge&lt;#DBL&gt;&quot;</span>
<span class="c">// &quot;hoge&quot;</span>

<span class="kd">dim</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">123</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;a is &lt;#a&gt;&quot;</span>
<span class="c">// a is 123</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;b is &lt;#b&gt;&quot;</span><span class="w"> </span><span class="c">// 変数が存在しない場合は展開されない</span>
<span class="c">// b is &lt;#b&gt;</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;length of a is &lt;#length(a)&gt;&quot;</span><span class="w"> </span><span class="c">// 式はダメ、変数のみ展開される</span>
<span class="c">// length of a is &lt;#length(a)&gt;</span>

<span class="k">print</span><span class="w"> </span><span class="s">&#39;a is &lt;#a&gt;&#39;</span><span class="w"> </span><span class="c">// シングルクォーテーション文字列は展開しない</span>
<span class="c">// a is &lt;#a&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="id41">
<h2>ホワイトスペース<a class="headerlink" href="#id41" title="この見出しへのパーマリンク">#</a></h2>
<ul class="simple">
<li><p>半角スペース</p></li>
<li><p>タブ文字</p></li>
<li><p>全角スペース</p></li>
</ul>
<div class="line-block">
<div class="line">はホワイトスペース扱いです</div>
<div class="line">式と式の区切りとして機能します</div>
<div class="line">改行(CRLF、CR、LF)は行末扱いです</div>
</div>
</section>
<section id="id42">
<h2>演算子<a class="headerlink" href="#id42" title="この見出しへのパーマリンク">#</a></h2>
<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">+</span></span></dt>
<dd><p>数値の加算、文字列の結合、配列要素の追加</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">+=</span></span></dt>
<dd><p>数値の加算、文字列の結合、配列要素の追加をして代入</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">-</span></span></dt>
<dd><p>数値の減算</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">-=</span></span></dt>
<dd><p>減算して代入</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">*</span></span></dt>
<dd><p>数値の乗算、文字列の繰り返し</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">*=</span></span></dt>
<dd><p>乗算して代入</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">/</span></span></dt>
<dd><p>数値の除算  ※ 0で割ると0を返す</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">/=</span></span></dt>
<dd><p>除算して代入</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">mod</span></span></dt>
<dd><p>数値の剰余演算 (割った余りを返す)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">!</span></span></dt>
<dd><p>論理否定</p>
<div class="note admonition">
<p class="admonition-title">真偽値以外の値について</p>
<div class="line-block">
<div class="line">真偽値以外に対して <code class="docutils literal notranslate"><span class="pre">!</span></code> 演算子を用いた場合、右辺に対して <a class="reference internal" href="#tf-cond"><span class="std std-ref">条件式の判定</span></a> が行われます</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">OPTION</span> <span class="pre">FORCEBOOL</span></code> や <code class="docutils literal notranslate"><span class="pre">OPTION</span> <span class="pre">CONDUWSC</span></code> の有無により異なる結果を返します</div>
</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">?</span> <span class="pre">:</span></span></dt>
<dd><p>三項演算子 b ? t : f</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">:=</span></span></dt>
<dd><p>代入 (代入した値を返す)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">=</span></span></dt>
<dd><p>代入、等価演算</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">==</span></span></dt>
<dd><p>等価演算</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">&lt;&gt;</span></span></dt>
<dd></dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">!=</span></span></dt>
<dd><p>不等価演算</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">and</span></span></dt>
<dd><p>数値のAND演算(ビット演算)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">or</span></span></dt>
<dd><p>数値のOR演算(ビット演算)、真偽値の論理演算</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">xor</span></span></dt>
<dd><p>数値のXOR演算(ビット演算)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">andL</span></span></dt>
<dd><p>論理演算 (両辺の真偽性評価を行う)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">orL</span></span></dt>
<dd><p>論理演算 (両辺の真偽性評価を行う)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">xorL</span></span></dt>
<dd><p>論理演算 (両辺の真偽性評価を行う)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">andB</span></span></dt>
<dd><p>ビット演算 (両辺を数値とみなし評価を行う)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">orB</span></span></dt>
<dd><p>ビット演算 (両辺を数値とみなし評価を行う)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">xorB</span></span></dt>
<dd><p>ビット演算 (両辺を数値とみなし評価を行う)</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">&lt;</span></span></dt>
<dd><p>小なり</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">&lt;=</span></span></dt>
<dd><p>小なりイコール</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">&gt;</span></span></dt>
<dd><p>大なり</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">&gt;=</span></span></dt>
<dd><p>大なりイコール</p>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">.</span></span></dt>
<dd><p>moduleやオブジェクトのメンバへのアクセス</p>
</dd></dl>

<section id="id43">
<h3>演算式の優先順位<a class="headerlink" href="#id43" title="この見出しへのパーマリンク">#</a></h3>
<p>優先順位の高いものから先に演算を行います</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">)</span></code> 内の式</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>, <code class="docutils literal notranslate"><span class="pre">mod</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=</span></code> (等価比較), <code class="docutils literal notranslate"><span class="pre">==</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">!=</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">and</span></code> (L,Bを含む)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">or</span></code> (L,Bを含む), <code class="docutils literal notranslate"><span class="pre">xor</span></code> (L,Bを含む)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">?</span> <span class="pre">:</span></code> (三項演算子)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">:=</span></code></p></li>
</ol>
<p>代入系の演算子は順位判定とは別に代入処理判定を行っています</p>
<ul class="simple">
<li><dl class="simple">
<dt>代入演算子</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">=</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>複合代入演算子</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">+=</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-=</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*=</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/=</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 2つ目の = は代入ではなく比較になるので a にはboolが入る</span>
<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span>

<span class="c">// こういうのはダメ、演算中に代入はしない</span>
<span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">d</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">例外として <code class="docutils literal notranslate"><span class="pre">:=</span></code> による代入があります</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">:=</span></code> による代入は式であり、変数に代入された値を返します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="m">1</span><span class="w">               </span><span class="c">// 1 (代入した値が返る)</span>
<span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w">                    </span><span class="c">// 1</span>
<span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="c">// 10 (代入した値が返り、その値で計算が行われる)</span>
<span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w">                    </span><span class="c">// 3</span>

<span class="c">// 一度に複数の変数に値を代入することもできる</span>
<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="m">10</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 10</span>
<span class="k">print</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="c">// 10</span>
<span class="k">print</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="c">// 10</span>
<span class="c">// a := b := c := 10 でも可</span>
</pre></div>
</div>
</section>
<section id="id44">
<h3>特殊な演算<a class="headerlink" href="#id44" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">数値以外を含む演算には一部特殊な仕様があります</div>
<div class="line">型に対して不適切な演算子が用いられた場合はエラーになります</div>
</div>
<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">数値</span> <span class="pre">+</span> <span class="pre">文字列</span></span></dt>
<dd><div class="line-block">
<div class="line">右辺の文字列が数値変換可能な場合は数値にします</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#39;2&#39;</span><span class="w"> </span><span class="c">// 3</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">右辺の文字列が数値変換できない場合は左辺の数値を文字列にします</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#39;a&#39;</span><span class="w"> </span><span class="c">// 1a</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">数値とEMPTYの演算</span></span></dt>
<dd><div class="line-block">
<div class="line">EMPTYは0として扱われます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="c">// 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">数値と真偽値の演算</span></span></dt>
<dd><div class="line-block">
<div class="line">TRUEは1、FALSEは0として扱われます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">TRUE</span><span class="w"> </span><span class="c">// 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">文字列</span> <span class="pre">+</span> <span class="pre">数値</span></span></dt>
<dd><div class="line-block">
<div class="line">右辺の数値を文字列にします</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="s">&#39;a&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// a3</span>
<span class="k">print</span><span class="w"> </span><span class="s">&#39;1&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// 12</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">文字列</span> <span class="pre">*</span> <span class="pre">数値</span></span></dt>
<dd><div class="line-block">
<div class="line">左辺の文字列が数値変換可能な場合数値にします</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="s">&#39;2&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// 6</span>
<span class="k">print</span><span class="w"> </span><span class="s">&#39;123&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// 246</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">左辺の文字列が数値に変換できない場合、文字列を数値分繰り返します</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="s">&#39;a&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// aaa</span>
<span class="k">print</span><span class="w"> </span><span class="s">&#39;xyz&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// xyzxyzxyz</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">文字列と数値の演算</span> <span class="pre">(+,</span> <span class="pre">*</span> <span class="pre">以外)</span></span></dt>
<dd><div class="line-block">
<div class="line">左辺の文字列が数値変換可能な場合は数値にします</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="s">&#39;15&#39;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// 5</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">左辺の文字列が数値変換できない場合はエラーになります</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="s">&#39;a&#39;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// エラー</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">文字列</span> <span class="pre">+</span> <span class="pre">NULL</span></span></dt>
<dd><div class="line-block">
<div class="line">null文字(chr(0))を付け加えます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;HOGE&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">NULL</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="w">         </span><span class="c">// HOGE</span>
<span class="k">print</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">hoge</span><span class="p">)</span><span class="w"> </span><span class="c">// 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">文字列</span> <span class="pre">+</span> <span class="pre">その他の値</span></span></dt>
<dd><div class="line-block">
<div class="line">上記例以外の値型はすべて文字列として扱われます</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="s">&#39;a&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">TRUE</span><span class="w"> </span><span class="c">// aTrue</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">配列</span> <span class="pre">+</span> <span class="pre">値</span></span></dt>
<dd><div class="line-block">
<div class="line">配列の末尾に値を追加します</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="c">// [1,2,3,4]</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">NULL</span> <span class="pre">*</span> <span class="pre">数値</span></span></dt>
<dd><div class="line-block">
<div class="line">数値分連続したnull文字を返します</div>
</div>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">5</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="w">         </span><span class="c">// (なにも表示されない)</span>
<span class="k">print</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">hoge</span><span class="p">)</span><span class="w"> </span><span class="c">// 5</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">空文字</span> <span class="pre">==</span> <span class="pre">EMPTY</span></span></dt>
<dd><div class="line-block">
<div class="line">空文字とEMPTYの等価比較は常にFALSEです</div>
</div>
<div class="caution admonition">
<p class="admonition-title">UWSCとの挙動の差異について</p>
<div class="line-block">
<div class="line">UWSCでは以下のような挙動でした</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EMPTY</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w">     </span><span class="c">// True</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="c">// False</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">空文字に対して <code class="docutils literal notranslate"><span class="pre">EMPTY</span></code> である変数は等価になりますが、リテラルでは非等価になっていました</div>
<div class="line">同一であるべき式が異なる結果を返すのは不正なのでUWSCRではいずれもFALSEを返します</div>
</div>
</div>
</dd></dl>

</section>
<section id="id45">
<h3>三項演算子<a class="headerlink" href="#id45" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>条件式 ? 真で返す式 : 偽で返す式
</pre></div>
</div>
<div class="line-block">
<div class="line">式を評価しその真偽により値を返します</div>
<div class="line">単行のIF文に似ていますが、三項演算子は値を返します</div>
<div class="line">また、IF文とは異なり文を書くことができません</div>
</div>
<div class="tip admonition">
<p class="admonition-title">条件式について</p>
<div class="line-block">
<div class="line">三項演算子の条件式はオプションにより異なる判定を行います</div>
<div class="line">詳しくは <a class="reference internal" href="#tf-cond"><span class="std std-ref">条件式の判定</span></a> を参照してください</div>
</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;a is TRUE&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;a is FALSE&quot;</span><span class="w"> </span><span class="c">// a is FALSE</span>

<span class="c">// 入れ子もできる</span>

<span class="c">// fizzbuzz</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">100</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">mod</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">mod</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">mod</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;fizz&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;buzz&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;fizzbuzz&quot;</span>
<span class="k">next</span>

<span class="c">// 三項演算子では中に式しか書けない</span>
<span class="c">// 例: print文を書いた場合</span>
<span class="n">hoge</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;hoge is truthy&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;hoge is falsy&quot;</span><span class="w"> </span><span class="c">// エラー</span>
</pre></div>
</div>
</section>
<section id="id46">
<h3>ビット演算子、論理演算子<a class="headerlink" href="#id46" title="この見出しへのパーマリンク">#</a></h3>
<p>AND、OR、XORは両辺の値型により論理演算またはビット演算のいずれかを行っていました
UWSCRでは演算子が追加され論理演算およびビット演算を明示的に行うことができます</p>
<section id="id47">
<h4>論理演算子<a class="headerlink" href="#id47" title="この見出しへのパーマリンク">#</a></h4>
<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">AndL,</span> <span class="pre">OrL,</span> <span class="pre">XorL</span></span></dt>
<dd><div class="line-block">
<div class="line">真偽値を返します</div>
<div class="line">両辺に不適切な値型が含まれる場合はエラーになります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 両辺の真偽性を評価してから演算を行う</span>
<span class="k">print</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="n">andl</span><span class="w"> </span><span class="n">false</span><span class="w"> </span><span class="c">// false</span>
<span class="k">print</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="n">andl</span><span class="w"> </span><span class="n">NOTHING</span><span class="w"> </span><span class="c">// false</span>
<span class="k">print</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">andl</span><span class="w"> </span><span class="s">&#39;a&#39;</span><span class="w"> </span><span class="c">// true</span>
<span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">xorl</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="c">// false</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="id48">
<h4>ビット演算子<a class="headerlink" href="#id48" title="この見出しへのパーマリンク">#</a></h4>
<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">AndB,</span> <span class="pre">OrB,</span> <span class="pre">XorB</span></span></dt>
<dd><div class="line-block">
<div class="line">数値を返します</div>
<div class="line">両辺に不適切な値型が含まれる場合はエラーになります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 両辺を数値として評価してから演算を行う</span>
<span class="k">print</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">andb</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="c">// 1</span>
<span class="k">print</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">orb</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="c">// 7</span>
<span class="k">print</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">xorb</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="c">// 6</span>
<span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">andb</span><span class="w"> </span><span class="s">&#39;1&#39;</span><span class="w"> </span><span class="c">// 1</span>
<span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">andb</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="c">// 1</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
</section>
<section id="tf-cond">
<span id="id49"></span><h2>条件式の判定<a class="headerlink" href="#tf-cond" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">以下の式で条件判定が行われます</div>
</div>
<ul class="simple">
<li><p>if文における <code class="docutils literal notranslate"><span class="pre">if</span></code> 及び <code class="docutils literal notranslate"><span class="pre">elseif</span></code> の式</p></li>
<li><p>while-wend文における <code class="docutils literal notranslate"><span class="pre">while</span></code> の式</p></li>
<li><p>repeat-until文における <code class="docutils literal notranslate"><span class="pre">until</span></code> の式</p></li>
<li><p>三項演算子における <code class="docutils literal notranslate"><span class="pre">?</span></code> の左辺の式</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!</span></code> 演算子の右辺の式</p></li>
</ul>
<div class="line-block">
<div class="line">条件判定はオプションにより以下の三種類の方法で行われます</div>
</div>
<section id="id50">
<h3>真偽性判定 (デフォルト)<a class="headerlink" href="#id50" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">デフォルトでは条件式において単に真偽値(<code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)であることだけではなく、式の真偽性が評価されます</div>
</div>
<div class="line-block">
<div class="line">式の評価結果が以下となる場合は <strong>偽</strong> と判定されます</div>
</div>
<ul class="simple">
<li><p>FALSE</p></li>
<li><p>EMPTY</p></li>
<li><p>0</p></li>
<li><p>NOTHING</p></li>
<li><p>長さ0の文字列</p></li>
<li><p>長さ0の配列</p></li>
</ul>
<div class="line-block">
<div class="line">これら以外の値を取る場合は <strong>真</strong> となります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="n">NOTHING</span><span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 偽</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">                 </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 偽</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;空ではない文字列&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 真</span>
<span class="k">print</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="p">]</span><span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 真</span>
<span class="k">print</span><span class="w"> </span><span class="p">[]</span><span class="w">                 </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 偽</span>
</pre></div>
</div>
<div class="caution admonition">
<p class="admonition-title">UWSCとの差異による注意点</p>
<div class="line-block">
<div class="line">UWSCでは条件式において、式の評価結果が文字列であった場合にそれを数値(<code class="docutils literal notranslate"><span class="pre">VAR_DOUBLE</span></code> 相当)へと変換し、変換成功時は0または0以外による判定を行っていました</div>
<div class="line">そのため、以下のような記述をした場合にUWSCとUWSCRで異なる結果となります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;UWSCRでは長さ1以上の文字列であるため真と判定される&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;UWSCでは数値の0に変換され偽と判定される&quot;</span>
<span class="k">endif</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">このような場合は <code class="docutils literal notranslate"><span class="pre">val</span></code> 関数を使ってください</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="n">val</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;未到達&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;0なので偽と判定される&quot;</span>
<span class="k">endif</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">あるいは後述する <code class="docutils literal notranslate"><span class="pre">CONDUWSC</span></code> オプションをご利用ください</div>
</div>
</div>
</section>
<section id="id51">
<h3>真偽値のみ<a class="headerlink" href="#id51" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">OPTION</span> <span class="pre">FORCEBOOL</span></code> が指定されている場合は真偽値(<code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>)を返す式のみが有効となります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">FORCEBOOL</span>

<span class="c">// 真偽値を返す式のみ有効となる</span>
<span class="k">print</span><span class="w"> </span><span class="n">TRUE</span><span class="w">   </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 真</span>
<span class="k">print</span><span class="w"> </span><span class="n">FALSE</span><span class="w">  </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 偽</span>
<span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 真</span>
<span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">2</span><span class="w">  </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 偽</span>

<span class="c">// 以下は真偽値を返す式ではないためエラーとなる</span>
<span class="k">print</span><span class="w"> </span><span class="n">NOTHING</span><span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// エラー</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">                 </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// エラー</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;空ではない文字列&quot;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// エラー</span>
<span class="k">print</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="p">]</span><span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// エラー</span>
<span class="k">print</span><span class="w"> </span><span class="p">[]</span><span class="w">                 </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// エラー</span>
</pre></div>
</div>
</section>
<section id="uwsc">
<h3>UWSC方式<a class="headerlink" href="#uwsc" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">OPTION</span> <span class="pre">CONDUWSC</span></code> が指定されている場合はUWSCと同等の判定を行います</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">FORCEBOOL</span></code> との併用はできず、 いずれも有効の場合 <code class="docutils literal notranslate"><span class="pre">FORCEBOOL</span></code> が優先されます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">CONDUWSC</span>

<span class="k">print</span><span class="w"> </span><span class="n">NOTHING</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 真</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">      </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// エラー</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;123&quot;</span><span class="w">   </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 真</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w">     </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// 偽</span>
<span class="k">print</span><span class="w"> </span><span class="s">&quot;hoge&quot;</span><span class="w">  </span><span class="o">?</span><span class="w"> </span><span class="s">&#39;真&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&#39;偽&#39;</span><span class="w"> </span><span class="c">// エラー</span>
</pre></div>
</div>
</section>
</section>
<section id="id52">
<h2>コメント<a class="headerlink" href="#id52" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">//</span></code> 以降は行末までコメントです (構文解析されない)</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">//</span></code> があった時点で行末扱いになります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="c">// a = a + 1</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 1 が出力される</span>
</pre></div>
</div>
<section id="id53">
<h3>ダミーコメント<a class="headerlink" href="#id53" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">//-</span></code> を記述することでUWSCでは以降をコメント扱いにしますが、UWSCRではこの部分は無視されます</div>
<div class="line">これによりUWSCと併用するスクリプトでUWSCRのみで使える構文や関数を記述することが可能となります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="m">1</span>
<span class="c">//-</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="m">2</span>
<span class="k">print</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">//-</span><span class="w"> </span><span class="o">+</span><span class="m">5</span>
<span class="c">// print 4</span>
</pre></div>
</div>
<p>結果</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># UWSC</span>
<span class="n">1</span>
<span class="n">3</span>
</pre></div>
</div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># UWSCR</span>
<span class="n">1</span>
<span class="n">2</span>
<span class="n">8</span>
</pre></div>
</div>
</section>
</section>
<section id="id54">
<h2>行結合<a class="headerlink" href="#id54" title="この見出しへのパーマリンク">#</a></h2>
<p>行末に <code class="docutils literal notranslate"><span class="pre">_</span></code> を記述することで次の行と結合させます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_</span>
<span class="m">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">4</span>

<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 10</span>
</pre></div>
</div>
</section>
<section id="id55">
<h2>マルチステートメント<a class="headerlink" href="#id55" title="この見出しへのパーマリンク">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">;</span></code> をつけることで複数の文を1行に記述できます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 2</span>

<span class="c">// UWSCでは IF行のマルチ宣言はNG エラー</span>
<span class="k">if</span><span class="w"> </span><span class="m">123</span><span class="w"> </span><span class="k">then</span><span class="p">;</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;condition is truthy&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="p">;</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;condition is falsy&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="id56">
<h2>組み込み定数<a class="headerlink" href="#id56" title="この見出しへのパーマリンク">#</a></h2>
<div class="table-wrapper docutils container">
<table class="docutils align-left">
<tbody>
<tr class="row-odd"><td><p><cite>TRUE</cite></p></td>
<td><p>true または 1</p></td>
</tr>
<tr class="row-even"><td><p><cite>FALSE</cite></p></td>
<td><p>false または 0</p></td>
</tr>
<tr class="row-odd"><td><p><cite>NULL</cite></p></td>
<td><p>振る舞い未実装</p></td>
</tr>
<tr class="row-even"><td><p><cite>EMPTY</cite></p></td>
<td><p>空文字</p></td>
</tr>
<tr class="row-odd"><td><p><cite>NOTHING</cite></p></td>
<td><p>オブジェクトがない状態</p></td>
</tr>
<tr class="row-even"><td><p><cite>NaN</cite></p></td>
<td><p>Not a number</p></td>
</tr>
</tbody>
</table>
</div>
<section id="nan">
<h3>NaNについて<a class="headerlink" href="#nan" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">NaN</span></code> は <code class="docutils literal notranslate"><span class="pre">NaN</span></code> 自身を含めあらゆる値と等価ではありません</div>
<div class="line">また <code class="docutils literal notranslate"><span class="pre">NaN</span></code> との大小の比較結果も必ず偽です</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="c">// False</span>
<span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w">   </span><span class="o">==</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="c">// False (nは何かしらの値)</span>
<span class="k">print</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="c">// True</span>
<span class="k">print</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="o">&lt;</span><span class="w">  </span><span class="n">n</span><span class="w">   </span><span class="c">// False</span>
<span class="k">print</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="w">   </span><span class="c">// False</span>
<span class="k">print</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="o">&gt;</span><span class="w">  </span><span class="n">n</span><span class="w">   </span><span class="c">// False</span>
<span class="k">print</span><span class="w"> </span><span class="m">NaN</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">n</span><span class="w">   </span><span class="c">// False</span>
</pre></div>
</div>
</section>
</section>
<section id="id57">
<h2>16進数<a class="headerlink" href="#id57" title="この見出しへのパーマリンク">#</a></h2>
<p>16進数リテラル表記は <code class="docutils literal notranslate"><span class="pre">$</span></code> を使います</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="w"> </span><span class="m">$FF</span><span class="w"> </span><span class="c">// 255</span>
</pre></div>
</div>
</section>
<section id="id58">
<h2>起動時パラメータ<a class="headerlink" href="#id58" title="この見出しへのパーマリンク">#</a></h2>
<p>スクリプトにパラメータを付与した場合にそれらが <code class="docutils literal notranslate"><span class="pre">PARAM_STR[]</span></code> に格納されます</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>uwscr hoge.uws foo bar baz
</pre></div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// hoge.uws</span>
<span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">PARAM_STR</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">p</span>
<span class="k">next</span>
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># 結果</span>
foo
bar
baz
</pre></div>
</div>
</section>
<section id="option">
<h2>OPTION<a class="headerlink" href="#option" title="この見出しへのパーマリンク">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span> <span class="n">設定名</span><span class="p">[</span><span class="o">=</span><span class="n">値</span><span class="p">]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">値が真偽値指定の場合は省略可能で、省略時はtrueになります</div>
<div class="line">各OPTIONのデフォルト値は設定ファイルからも変更可能です</div>
<div class="line">設定ファイルについては <a class="reference internal" href="../usage/settings.html#setting-file"><span class="std std-ref">設定ファイルの構成</span></a> を参照してください</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">EXPLICIT</span><span class="w"> </span><span class="c">// explicit設定をtrueにする</span>
</pre></div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">SHORTCIRCUIT</span><span class="o">=</span><span class="n">FALSE</span><span class="w"> </span><span class="c">// デフォルトtrueなのでfalseにする</span>
</pre></div>
</div>
<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">EXPLICIT[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">trueの場合未宣言の変数への代入を許可しない (初期値:false)</div>
<div class="line">未宣言の変数への代入および複合代入が行われる場合に解析エラーとなります</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">SAMESTR[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">文字列の比較等で大文字小文字を区別するかどうか (初期値:false)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">OPTPUBLIC[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">public変数の重複宣言を禁止するかどうか (初期値:false)</div>
<div class="line">以下の場合に解析エラーとなります</div>
</div>
<ul>
<li><p>同名のグローバル変数宣言を行ったとき</p>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">OPTPUBLIC</span>
<span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w">     </span><span class="c">// エラー</span>
<span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">procedure</span><span class="p">()</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// エラー</span>
<span class="kd">fend</span>
<span class="kd">procedure</span><span class="w"> </span><span class="n">p</span><span class="p">()</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="c">//エラー</span>
<span class="kd">fend</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>同一モジュール内で同名のpublic変数を宣言したとき</p>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">OPTPUBLIC</span>
<span class="kd">module</span><span class="w"> </span><span class="n">m</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w">     </span><span class="c">// エラー</span>
<span class="w">    </span><span class="kd">procedure</span><span class="w"> </span><span class="n">m</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// エラー</span>
<span class="w">    </span><span class="kd">fend</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">procedure</span><span class="p">()</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="c">// エラー</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">endmodule</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">OPTFINALLY[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">tryで強制終了時にfinally部を実行するかどうか (初期値:false)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">SPECIALCHAR[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">trueで特殊文字(&lt;#CR&gt;など)や変数展開が行われなくなる (初期値: false)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">SHORTCIRCUIT[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">論理演算で短絡評価を行うかどうか (初期値:true)</div>
</div>
<div class="caution admonition">
<p class="admonition-title">このOPTIONはデフォルト有効です</p>
<div class="line-block">
<div class="line">UWSCとは違いデフォルトで <code class="docutils literal notranslate"><span class="pre">OPTION</span> <span class="pre">SHORTCIRCUIT</span></code> が有効になっています。</div>
<div class="line">無効にするには以下を実行してください</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">SHORTCIRCUIT</span><span class="o">=</span><span class="n">FALSE</span>
</pre></div>
</div>
</div>
<div class="hint admonition">
<p class="admonition-title">短絡評価とは</p>
<div class="line-block">
<div class="line">論理演算において左辺の評価のみで結果が確定する場合に右辺の評価を行いません</div>
</div>
<ul class="simple">
<li><p>論理和(OR)の場合、左辺が真なら右辺によらず真なので右辺を評価しない</p></li>
<li><p>論理積(AND)の場合、左辺が偽なら右辺によらず偽なので右辺を評価しない</p></li>
</ul>
<div class="line-block">
<div class="line">短絡評価が行われるのは以下の状況です</div>
<div class="line">サンプルコード内では事前に以下が実行されているものとします</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span>
<span class="kd">fend</span>
<span class="kd">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">false</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span>
<span class="kd">fend</span>
</pre></div>
</div>
<ul>
<li><p>AndL演算子の左辺が偽となる値を取る場合</p>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// t(2) は評価されない</span>
<span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="n">AndL</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
<span class="c">// 1: False</span>
<span class="c">// False</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>OrL演算子の左辺が真となる値を取る場合</p>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// f(2) は評価されない</span>
<span class="k">print</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="n">OrL</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
<span class="c">// 1: True</span>
<span class="c">// True</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>ifなどの条件式にて、AndまたはAndL演算子の左辺が偽となる値を取る場合</p>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// t(2) は評価されない</span>
<span class="k">print</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">false</span>
<span class="c">// 1: False</span>
<span class="c">// False</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>ifなどの条件式にて、OrまたはOrL演算子の左辺が真となる値を取る場合</p>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// f(2) は評価されない</span>
<span class="k">print</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">true</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">false</span>
<span class="c">// 1: True</span>
<span class="c">// True</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="caution admonition">
<p class="admonition-title">短絡評価におけるUWSCとの差異</p>
<div class="line-block">
<div class="line">ANDとORの複合条件でUWSCでは短絡評価が行われないケースがありましたが、UWSCRでは適切に短絡評価を行います</div>
<div class="line">評価結果に影響はありません</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// UWSCで短絡評価が行われない例</span>
<span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">true</span>
<span class="k">else</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">false</span>
<span class="k">endif</span>
<span class="c">// UWSCR</span>
<span class="c">// 1: False … f(1) and t(2) で短絡評価されfalse</span>
<span class="c">// 3: True  … false or t(3) は短絡評価されないのでt(3)も評価される</span>
<span class="c">// True</span>

<span class="c">// UWSC</span>
<span class="c">// 1: False</span>
<span class="c">// 2: True … 評価されてしまう</span>
<span class="c">// 3: True</span>
<span class="c">// True</span>
</pre></div>
</div>
</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">NOSTOPHOTKEY[=bool]</span></span></dt>
<dd><div class="admonition attention">
<p class="admonition-title">注意</p>
<p>この設定は無効です</p>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">TOPSTOPFORM[=bool]</span></span></dt>
<dd><div class="admonition attention">
<p class="admonition-title">注意</p>
<p>この設定は無効です</p>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">FIXBALLOON[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">吹き出しを仮想デスクトップを跨いで表示するかどうか (初期値:false)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">DEFAULTFONT=&quot;name,n&quot;</span></span></dt>
<dd><div class="line-block">
<div class="line">ダイアログ等のフォント指定  (初期値:&quot;Yu Gothic UI,20&quot;)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">POSITION=x,y</span></span></dt>
<dd><div class="admonition caution">
<p class="admonition-title">注意</p>
<p>この設定は無効です</p>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">LOGPATH=&quot;path&quot;</span></span></dt>
<dd><div class="line-block">
<div class="line">ログ保存フォルダを指定 (初期値:スクリプトのあるフォルダ)</div>
<div class="line">存在するディレクトリを指定するとそこに <code class="docutils literal notranslate"><span class="pre">uwscr.log</span></code> を出力します</div>
<div class="line">それ以外はログファイルのパスとして扱われます</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">LOGLINES=n</span></span></dt>
<dd><div class="line-block">
<div class="line">ログファイルの最大行数を指定 (初期値:400)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">LOGFILE=n</span></span></dt>
<dd><div class="line-block">
<div class="line">ログファイルの出力方法 (初期値:1)</div>
</div>
<ul class="simple">
<li><p>0: 通常のログ出力</p></li>
<li><p>1: ログ出力なし</p></li>
<li><p>2: 日時出力なし</p></li>
<li><p>3: 通常のログ出力 (標準で秒を含むため0と同じ)</p></li>
<li><p>4: 以前のログを破棄</p></li>
<li><p>それ以外: ログ出力なし</p></li>
</ul>
<div class="hint admonition">
<p class="admonition-title">UWSCRのログ出力について</p>
<div class="line-block">
<div class="line">UWSCRはデフォルトではログを出力しません</div>
<div class="line">ログを出力するには0, 2, 3, 4のいずれかを指定してください</div>
</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">DLGTITLE=&quot;title&quot;</span></span></dt>
<dd><div class="line-block">
<div class="line">ダイアログのタイトルを指定します (初期値:&quot;UWSCR - スクリプト名&quot;)</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">GUIPRINT[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">TRUEにした場合print文実行時にコンソールではなくGUIに出力します</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">uwscr</span> <span class="pre">--window</span></code> で実行されている場合はこの設定が強制的にtrueになります</div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">FORCEBOOL[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">TRUEにした場合if文やwhile, repeatの条件式がTRUEまたはFALSEしか受け付けなくなります</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">CONDUWSC</span></code> と競合した場合はこちらが優先されます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">OPTION</span><span class="w"> </span><span class="n">FORCEBOOL</span>

<span class="k">if</span><span class="w"> </span><span class="n">TRUE</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;OK&quot;</span>
<span class="k">endif</span>

<span class="k">if</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;↑はエラーになります&quot;</span>
<span class="k">endif</span>
</pre></div>
</div>
</dd></dl>

<dl class="object">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">OPTION</span> <span class="pre">CONDUWSC[=bool]</span></span></dt>
<dd><div class="line-block">
<div class="line">TRUEにした場合if文やwhile, repeatの条件式の判定方法がUWSCと同等になります</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">FORCEBOOL</span></code> が有効な場合は無視されます</div>
</div>
</dd></dl>

</section>
<section id="def-dll">
<h2>def_dll<a class="headerlink" href="#def-dll" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">DLL関数 (Win32 APIなど) を呼び出せるようにします</div>
<div class="line">32bit版UWSCRでは32bitのDLL、64bit版では64bitのDLLに対応します</div>
<div class="line">呼び出す関数の名前、引数の型、戻り値の型、dllのパスを指定します</div>
<div class="line">dllパスは拡張子(.dll)を省略できます</div>
<div class="line">別名を指定して本来の関数名ではなく別名で呼び出せるようにもできます</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">def_dll</span> <span class="n">関数名</span><span class="p">(</span><span class="n">型名</span><span class="p">,</span> <span class="n">型名</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span><span class="n">型名</span><span class="p">:</span><span class="n">DLLパス</span>
<span class="o">//</span> <span class="n">戻り値がvoidの場合省略できる</span>
<span class="n">def_dll</span> <span class="n">関数名</span><span class="p">(</span><span class="n">型名</span><span class="p">,</span> <span class="n">型名</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span><span class="n">DLLパス</span>

<span class="o">//</span> <span class="n">配列引数指定</span>
<span class="n">def_dll</span> <span class="n">関数名</span><span class="p">(</span> <span class="n">型名</span><span class="p">[]</span> <span class="p">):</span><span class="n">型名</span><span class="p">:</span><span class="n">DLLパス</span>
<span class="o">//</span> <span class="n">配列サイズ指定</span>
<span class="n">def_dll</span> <span class="n">関数名</span><span class="p">(</span> <span class="n">型名</span><span class="p">[</span><span class="n">サイズ</span><span class="p">]</span> <span class="p">):</span><span class="n">型名</span><span class="p">:</span><span class="n">DLLパス</span>

<span class="o">//</span> <span class="n">参照渡し</span>
<span class="n">def_dll</span> <span class="n">関数名</span><span class="p">(</span> <span class="n">var</span> <span class="n">型名</span> <span class="p">):</span><span class="n">型名</span><span class="p">:</span><span class="n">DLLパス</span>
<span class="n">def_dll</span> <span class="n">関数名</span><span class="p">(</span> <span class="n">ref</span> <span class="n">型名</span> <span class="p">):</span><span class="n">型名</span><span class="p">:</span><span class="n">DLLパス</span>

<span class="o">//</span> <span class="n">構造体</span>
<span class="n">def_dll</span> <span class="n">関数名</span><span class="p">(</span> <span class="p">{</span><span class="n">型名</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span> <span class="p">):</span><span class="n">型名</span><span class="p">:</span><span class="n">DLLパス</span>

<span class="o">//</span> <span class="n">関数名エイリアス</span>
<span class="o">//</span> <span class="n">dll関数に呼び出すための別の名前をつける</span>
<span class="n">def_dll</span> <span class="n">別名</span><span class="p">:</span><span class="n">関数名</span><span class="p">(</span><span class="n">型名</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span><span class="n">型名</span><span class="p">:</span><span class="n">DLLパス</span>
</pre></div>
</div>
<section id="id59">
<h3>使用可能な型名<a class="headerlink" href="#id59" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">以下の型を指定できます</div>
<div class="line">一部の型はx86/x64でサイズが変わります</div>
<div class="line">一部の型は引数定義、または戻り値定義でのみ指定可能です</div>
<div class="line">文字列型に <code class="docutils literal notranslate"><span class="pre">EMPTY</span></code>, <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, <code class="docutils literal notranslate"><span class="pre">NOTHING</span></code> を渡した場合はNULL文字として扱われます</div>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>型名</p></th>
<th class="head"><p>サイズ</p></th>
<th class="head"><p>詳細</p></th>
<th class="head"><p>対応する値型</p></th>
<th class="head"><p>引数</p></th>
<th class="head"><p>戻り型</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>int, long</p></td>
<td><p>4</p></td>
<td><p>符号あり32ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>bool</p></td>
<td><p>4</p></td>
<td><p>符号あり32ビット整数</p></td>
<td><p>真偽値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>uint, dword</p></td>
<td><p>4</p></td>
<td><p>符号なし32ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>float</p></td>
<td><p>4</p></td>
<td><p>単精度浮動小数点数</p></td>
<td><p>数値(小数)</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>double</p></td>
<td><p>8</p></td>
<td><p>倍精度浮動小数点数</p></td>
<td><p>数値(小数)</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>word</p></td>
<td><p>2</p></td>
<td><p>符号なし16ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>wchar</p></td>
<td><p>2</p></td>
<td><p>符号なし16ビット整数</p></td>
<td><p><a class="reference internal" href="#about-dll-string-param"><span class="std std-ref">文字(列)</span></a></p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>byte</p></td>
<td><p>1</p></td>
<td><p>符号なし8ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>char</p></td>
<td><p>1</p></td>
<td><p>符号なし8ビット整数</p></td>
<td><p><a class="reference internal" href="#about-dll-string-param"><span class="std std-ref">文字(列)</span></a></p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>boolean</p></td>
<td><p>1</p></td>
<td><p>符号なし8ビット整数</p></td>
<td><p>真偽値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>longlong</p></td>
<td><p>8</p></td>
<td><p>符号あり64ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>string</p></td>
<td><p>可変</p></td>
<td><p>ANSI文字列のポインタ</p></td>
<td><p><a class="reference internal" href="#about-dll-string-param"><span class="std std-ref">文字列</span></a></p></td>
<td><p>可</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>pchar</p></td>
<td><p>可変</p></td>
<td><p>ANSI文字列のポインタ</p></td>
<td><p><a class="reference internal" href="#about-dll-string-param"><span class="std std-ref">文字列</span></a></p></td>
<td><p>可</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>wstring</p></td>
<td><p>可変</p></td>
<td><p>ワイド文字列のポインタ</p></td>
<td><p><a class="reference internal" href="#about-dll-string-param"><span class="std std-ref">文字列</span></a></p></td>
<td><p>可</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>pwchar</p></td>
<td><p>可変</p></td>
<td><p>ワイド文字列のポインタ</p></td>
<td><p><a class="reference internal" href="#about-dll-string-param"><span class="std std-ref">文字列</span></a></p></td>
<td><p>可</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>hwnd</p></td>
<td><p>可変</p></td>
<td><p>ウィンドウハンドル</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>handle</p></td>
<td><p>可変</p></td>
<td><p>各種ハンドル</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>pointer</p></td>
<td><p>可変</p></td>
<td><p>ポインタを示す数値(符号なし)</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>struct</p></td>
<td><p>可変</p></td>
<td><p>ユーザー定義構造体のポインタ</p></td>
<td><p>構造体</p></td>
<td><p>可</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>callback</p></td>
<td><p>可変</p></td>
<td><p>コールバック関数のポインタ</p></td>
<td><p>ユーザー定義関数</p></td>
<td><p>可</p></td>
<td></td>
<td><p><a class="reference internal" href="#about-callback"><span class="std std-ref">コールバック関数の型定義</span></a> を行う</p></td>
</tr>
<tr class="row-even"><td><p>safearray</p></td>
<td><p>可変</p></td>
<td><p>SAFEARRAYのポインタ</p></td>
<td><p>配列</p></td>
<td><p>可</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>void</p></td>
<td><p>1</p></td>
<td><p>型がないことを示す</p></td>
<td></td>
<td></td>
<td><p>可</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="note admonition">
<p class="admonition-title">可変サイズについて</p>
<div class="line-block">
<div class="line">一部の数値型はOSのアーキテクチャによりそのサイズが変わります</div>
</div>
<ul class="simple">
<li><p>x86: 4</p></li>
<li><p>x64: 8</p></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">hwnd</span></code>, <code class="docutils literal notranslate"><span class="pre">handle</span></code>, <code class="docutils literal notranslate"><span class="pre">pointer</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code> にデータ上の区別はありません</div>
</div>
</div>
</section>
<section id="id60">
<h3>配列引数<a class="headerlink" href="#id60" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">型名[]</span></code> と記述することでその型に該当する値型の配列を渡せるようになります</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">型名[サイズ]</span></code> のように配列サイズを数値または定数でしていすることで、そのサイズの配列を受けることを明示します</div>
<div class="line">サイズ指定時は異なるサイズの配列を渡した場合エラーになります</div>
<div class="line">サイズ未指定時は渡す配列のサイズは可変ですが、十分なサイズを確保してください</div>
</div>
</section>
<section id="id61">
<h3>参照渡し<a class="headerlink" href="#id61" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">型名</span></code> または <code class="docutils literal notranslate"><span class="pre">ref</span> <span class="pre">型名</span></code> で参照渡しになります</div>
<div class="line">引数として変数を渡した場合、関数実行後にその変数の値が更新されます</div>
<div class="line">配列引数も参照渡しできます</div>
</div>
</section>
<section id="id62">
<h3>構造体<a class="headerlink" href="#id62" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">引数として構造体のポインタを受ける場合に <code class="docutils literal notranslate"><span class="pre">{型名,</span> <span class="pre">型名,</span> <span class="pre">...}</span></code> と記述することでその構造体として値の受け渡しができるようになります</div>
<div class="line">関数呼び出し時に型名に該当する値を渡す必要があります</div>
<div class="line">構造体の場合は参照渡しにしなくても変数に値が返ります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">def_dll</span><span class="w"> </span><span class="n">GetCursorPos</span><span class="p">({</span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="p">})</span><span class="o">:</span><span class="n">bool</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span>
<span class="c">// 呼び出し時は{}内に書いた型名の分引数を渡す必要がある</span>
<span class="n">GetCursorPos</span><span class="p">(</span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="c">// 参照渡しとして記述しなくても引数が更新される</span>
<span class="k">print</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span>
</pre></div>
</div>
<section id="id63">
<h4>ポインタではない構造体<a class="headerlink" href="#id63" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line">構造体のポインタではなく構造体そのものを受ける関数の場合は <code class="docutils literal notranslate"><span class="pre">{}</span></code> 表記が使えません</div>
<div class="line">その場合は <code class="docutils literal notranslate"><span class="pre">{}</span></code> を使わずメンバーの方を引数として直接記述します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// MonitorFromPointは引数としてPOINT構造体とDWORDを受けます</span>
<span class="c">// POINT構造体は2つのLONGで構成されているため、以下のように記述できます</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">MonitorFromPoint</span><span class="p">(</span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">dword</span><span class="p">)</span><span class="o">:</span><span class="n">dword</span><span class="o">:</span><span class="n">user32</span>
</pre></div>
</div>
</section>
<section id="id64">
<h4>ネストした構造体<a class="headerlink" href="#id64" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line">メンバが構造体のポインタである場合は <code class="docutils literal notranslate"><span class="pre">{型名,</span> <span class="pre">型名,</span> <span class="pre">{型名,</span> <span class="pre">...},</span> <span class="pre">...}</span></code> のようにネスト構造で表記します</div>
<div class="line">メンバが構造体そのものである場合は子構造体メンバの型名を展開して記述します</div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">tagWINDOWPLACEMENT</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">UINT</span><span class="w">  </span><span class="n">length</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">UINT</span><span class="w">  </span><span class="n">flags</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">UINT</span><span class="w">  </span><span class="n">showCmd</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">POINT</span><span class="w"> </span><span class="n">ptMinPosition</span><span class="p">;</span><span class="w">    </span><span class="c1">// POINT構造体は long, long</span>
<span class="w">  </span><span class="n">POINT</span><span class="w"> </span><span class="n">ptMaxPosition</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">RECT</span><span class="w">  </span><span class="n">rcNormalPosition</span><span class="p">;</span><span class="w"> </span><span class="c1">// RECT構造体は long, long, long, long</span>
<span class="p">}</span><span class="w"> </span><span class="n">WINDOWPLACEMENT</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">def_dll</span><span class="w"> </span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">hwnd</span><span class="o">,</span><span class="w"> </span><span class="p">{</span><span class="n">uint</span><span class="o">,</span><span class="w"> </span><span class="n">uint</span><span class="o">,</span><span class="w"> </span><span class="n">uint</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="p">})</span><span class="o">:</span><span class="n">bool</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">len</span><span class="o">,</span><span class="w"> </span><span class="n">flags</span><span class="o">,</span><span class="w"> </span><span class="n">cmd</span><span class="o">,</span><span class="w"> </span><span class="n">minx</span><span class="o">,</span><span class="w"> </span><span class="n">miny</span><span class="o">,</span><span class="w"> </span><span class="n">maxx</span><span class="o">,</span><span class="w"> </span><span class="n">maxy</span><span class="o">,</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">top</span><span class="o">,</span><span class="w"> </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">bottom</span>
<span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">44</span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hndtoid</span><span class="p">(</span><span class="n">getid</span><span class="p">(</span><span class="s">&quot;hoge&quot;</span><span class="p">))</span>
<span class="k">print</span><span class="w"> </span><span class="n">GetWindowPlacement</span><span class="p">(</span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="n">len</span><span class="o">,</span><span class="w"> </span><span class="n">flags</span><span class="o">,</span><span class="w"> </span><span class="n">cmd</span><span class="o">,</span><span class="w"> </span><span class="n">minx</span><span class="o">,</span><span class="w"> </span><span class="n">miny</span><span class="o">,</span><span class="w"> </span><span class="n">maxx</span><span class="o">,</span><span class="w"> </span><span class="n">maxy</span><span class="o">,</span><span class="w"> </span><span class="n">left</span><span class="o">,</span><span class="w"> </span><span class="n">top</span><span class="o">,</span><span class="w"> </span><span class="n">right</span><span class="o">,</span><span class="w"> </span><span class="n">bottom</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="about-callback">
<span id="id65"></span><h3>コールバック<a class="headerlink" href="#about-callback" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">以下の書式でコールバック関数の引数と戻り値の型を定義します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// callback(型名, 型名, ...):型名</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span><span class="w"> </span><span class="n">callback</span><span class="p">(</span><span class="n">dword</span><span class="o">,</span><span class="w"> </span><span class="n">dword</span><span class="p">)</span><span class="o">:</span><span class="n">bool</span><span class="w"> </span><span class="p">)</span><span class="o">:</span><span class="n">hoge</span><span class="o">.</span><span class="n">dll</span>
<span class="c">// 戻り値型は省略可能</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">fuga</span><span class="p">(</span><span class="w"> </span><span class="n">callback</span><span class="p">(</span><span class="n">int</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">:</span><span class="n">fuga</span><span class="o">.</span><span class="n">dll</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">dll関数呼び出し時に対応したユーザー定義関数を渡します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="n">hoge_callback</span><span class="p">(</span><span class="n">foo</span><span class="o">,</span><span class="w"> </span><span class="n">bar</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bar</span>
<span class="kd">fend</span>

<span class="n">hoge</span><span class="p">(</span><span class="n">hoge_callback</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">コールバック定義に使える型は以下の通りです</div>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>型名</p></th>
<th class="head"><p>サイズ</p></th>
<th class="head"><p>詳細</p></th>
<th class="head"><p>対応する値型</p></th>
<th class="head"><p>引数</p></th>
<th class="head"><p>戻り型</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>int, long</p></td>
<td><p>4</p></td>
<td><p>符号あり32ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-odd"><td><p>bool</p></td>
<td><p>4</p></td>
<td><p>符号あり32ビット整数</p></td>
<td><p>真偽値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-even"><td><p>uint, dword</p></td>
<td><p>4</p></td>
<td><p>符号なし32ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-odd"><td><p>float</p></td>
<td><p>4</p></td>
<td><p>単精度浮動小数点数</p></td>
<td><p>数値(小数)</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-even"><td><p>double</p></td>
<td><p>8</p></td>
<td><p>倍精度浮動小数点数</p></td>
<td><p>数値(小数)</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-odd"><td><p>word</p></td>
<td><p>2</p></td>
<td><p>符号なし16ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-even"><td><p>byte</p></td>
<td><p>1</p></td>
<td><p>符号なし8ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-odd"><td><p>boolean</p></td>
<td><p>1</p></td>
<td><p>符号なし8ビット整数</p></td>
<td><p>真偽値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-even"><td><p>longlong</p></td>
<td><p>8</p></td>
<td><p>符号あり64ビット整数</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-odd"><td><p>hwnd</p></td>
<td><p>可変</p></td>
<td><p>ウィンドウハンドル</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-even"><td><p>handle</p></td>
<td><p>可変</p></td>
<td><p>各種ハンドル</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-odd"><td><p>pointer</p></td>
<td><p>可変</p></td>
<td><p>ポインタを示す数値(符号なし)</p></td>
<td><p>数値</p></td>
<td><p>可</p></td>
<td><p>可</p></td>
</tr>
<tr class="row-even"><td><p>void</p></td>
<td><p>1</p></td>
<td><p>型がないことを示す</p></td>
<td></td>
<td></td>
<td><p>可</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition- admonition">
<p class="admonition-title">コールバック実行例</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 1: デバイスコンテキストハンドル</span>
<span class="c">// 2: RECT構造体のポインタ、今回は使わないのでstructではなくpointerを指定</span>
<span class="c">// 3: コールバック関数</span>
<span class="c">//     1. モニタハンドル</span>
<span class="c">//     2. デバイスコンテキストハンドル</span>
<span class="c">//     3. モニタのRECTのポインタ</span>
<span class="c">//     4. LPARAM</span>
<span class="c">// 4: LPARAM</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">EnumDisplayMonitors</span><span class="p">(</span><span class="n">handle</span><span class="o">,</span><span class="w"> </span><span class="n">pointer</span><span class="o">,</span><span class="w"> </span><span class="n">callback</span><span class="p">(</span><span class="n">handle</span><span class="o">,</span><span class="w"> </span><span class="n">handle</span><span class="o">,</span><span class="w"> </span><span class="n">pointer</span><span class="o">,</span><span class="w"> </span><span class="n">pointer</span><span class="p">)</span><span class="o">:</span><span class="n">bool</span><span class="o">,</span><span class="w"> </span><span class="n">pointer</span><span class="p">)</span><span class="o">:</span><span class="n">bool</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>

<span class="c">// lparamとして渡される構造体</span>
<span class="kd">struct</span><span class="w"> </span><span class="n">UserData</span>
<span class="w">    </span><span class="c">// モニタハンドルを入れる配列</span>
<span class="w">    </span><span class="n">handles</span><span class="o">:</span><span class="w"> </span><span class="n">handle</span><span class="p">[</span><span class="m">10</span><span class="p">]</span>
<span class="w">    </span><span class="c">// ハンドル数</span>
<span class="w">    </span><span class="n">count</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="n">uint</span>
<span class="kd">endstruct</span>

<span class="c">// UserData構造体を初期化</span>
<span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserData</span><span class="p">()</span>
<span class="c">// 構造体アドレスをLPARAMとして渡す</span>
<span class="n">lparam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">address</span><span class="p">()</span>

<span class="c">// callbackにはコールバック関数として呼ばれるユーザー定義関数を渡す</span>
<span class="n">EnumDisplayMonitors</span><span class="p">(</span><span class="n">null</span><span class="o">,</span><span class="w"> </span><span class="n">null</span><span class="o">,</span><span class="w"> </span><span class="n">MonitorEnumProc</span><span class="o">,</span><span class="w"> </span><span class="n">lparam</span><span class="p">)</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">handles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;モニタ&lt;#i&gt;: &lt;#handle&gt;&quot;</span>
<span class="k">next</span>

<span class="kd">function</span><span class="w"> </span><span class="n">MonitorEnumProc</span><span class="p">(</span><span class="n">hmonitor</span><span class="o">,</span><span class="w"> </span><span class="n">hdc</span><span class="o">,</span><span class="w"> </span><span class="n">prect</span><span class="o">,</span><span class="w"> </span><span class="n">lparam</span><span class="p">)</span>
<span class="w">    </span><span class="c">// lparamからUserData構造体を得る</span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserData</span><span class="p">(</span><span class="n">lparam</span><span class="p">)</span>
<span class="w">    </span><span class="c">// モニタハンドルを配列に入れる</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">handles</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hmonitor</span>
<span class="w">    </span><span class="c">// カウントを進める</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">handles</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="c">// 取得上限を超えたら終了する</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">false</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="c">// trueを返して次に進む</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true</span>
<span class="w">    </span><span class="k">endif</span>
<span class="kd">fend</span>
</pre></div>
</div>
</div>
</section>
<section id="about-dll-string-param">
<span id="id66"></span><h3>文字列型について<a class="headerlink" href="#about-dll-string-param" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">以下の型は引数として文字列を受けますが、それぞれ性質が異なります</div>
<div class="line">戻り値の場合、可能な限り文字列として返します</div>
<div class="line">ANSI文字列は日本語環境であれば主にCP932です</div>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>型名</p></th>
<th class="head"><p>型詳細</p></th>
<th class="head"><p>引数として渡された場合の処理</p></th>
<th class="head"><p>参照渡しの場合</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>char</p></td>
<td><p>ANSI文字を示す符号なし8ビット整数値</p></td>
<td rowspan="2"><p>数値に変換され渡される</p></td>
<td rowspan="2"><p>文字として返る</p></td>
</tr>
<tr class="row-odd"><td><p>wchar</p></td>
<td><p>Unicode文字を示す符号なし16ビット整数値</p></td>
</tr>
<tr class="row-even"><td><p>char[]</p></td>
<td><p>ANSI文字列を示す符号なし8ビット整数の配列</p></td>
<td rowspan="2"><p>数値配列に変換され渡される</p></td>
<td rowspan="2"><p>文字列として返る</p></td>
</tr>
<tr class="row-odd"><td><p>wchar[]</p></td>
<td><p>Unicode文字列を示す符号なし16ビット整数の配列</p></td>
</tr>
<tr class="row-even"><td><p>string</p></td>
<td><p>ANSI文字列を示す符号なし8ビット整数配列のポインタ</p></td>
<td rowspan="4"><p>別途数値配列を作成しそのポインタを渡す</p>
<p>作成された配列は関数実行後開放される</p>
</td>
<td rowspan="2"><p>最初のNULL文字までを文字列として返る</p></td>
</tr>
<tr class="row-odd"><td><p>wstring</p></td>
<td><p>Unicode文字列を示す符号なし16ビット整数配列のポインタ</p></td>
</tr>
<tr class="row-even"><td><p>pchar</p></td>
<td><p>ANSI文字列を示す符号なし8ビット整数配列のポインタ</p></td>
<td rowspan="2"><p>NULL文字も含めた文字列として返る</p></td>
</tr>
<tr class="row-odd"><td><p>pwchar</p></td>
<td><p>Unicode文字列を示す符号なし16ビット整数配列のポインタ</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="dll">
<h3>DLL関数定義およびその呼び出し方の例<a class="headerlink" href="#dll" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// Win32のA関数ではstringかpcharを使う</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">MessageBoxA</span><span class="p">(</span><span class="n">hwnd</span><span class="o">,</span><span class="w"> </span><span class="n">string</span><span class="o">,</span><span class="w"> </span><span class="n">pchar</span><span class="o">,</span><span class="w"> </span><span class="n">uint</span><span class="p">)</span><span class="o">:</span><span class="n">int</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>
<span class="c">// Win32のW関数ではwstringかpwcharを使う</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">MessageBoxW</span><span class="p">(</span><span class="n">hwnd</span><span class="o">,</span><span class="w"> </span><span class="n">wstring</span><span class="o">,</span><span class="w"> </span><span class="n">pwchar</span><span class="o">,</span><span class="w"> </span><span class="n">uint</span><span class="p">)</span><span class="o">:</span><span class="n">int</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>

<span class="c">// 呼び出す際は単に文字列を渡すだけで良い</span>
<span class="k">print</span><span class="w"> </span><span class="n">MessageBoxA</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="s">&#39;メッセージ&#39;</span><span class="o">,</span><span class="w"> </span><span class="s">&#39;タイトル&#39;</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">MessageBoxW</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="s">&#39;メッセージ&#39;</span><span class="o">,</span><span class="w"> </span><span class="s">&#39;タイトル&#39;</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>

<span class="c">// 構造体定義は{}</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">hwnd</span><span class="o">,</span><span class="w"> </span><span class="p">{</span><span class="n">uint</span><span class="o">,</span><span class="w"> </span><span class="n">uint</span><span class="o">,</span><span class="w"> </span><span class="n">uint</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="p">})</span><span class="o">:</span><span class="n">bool</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>
<span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getid</span><span class="p">(</span><span class="s">&quot;メモ帳&quot;</span><span class="p">)</span>
<span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idtohnd</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="c">// 構造体を渡すときは定義した型の数だけ値を並べる</span>
<span class="n">SetWindowPlacement</span><span class="p">(</span><span class="n">h</span><span class="o">,</span><span class="w"> </span><span class="m">44</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="m">200</span><span class="o">,</span><span class="w"> </span><span class="m">200</span><span class="o">,</span><span class="w"> </span><span class="m">600</span><span class="o">,</span><span class="w"> </span><span class="m">600</span><span class="p">)</span>

<span class="c">// 参照渡し</span>
<span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GET_CUR_DIR</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\test.ini&quot;</span>
<span class="n">writeini</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">path</span><span class="p">)</span>
<span class="n">writeini</span><span class="p">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">path</span><span class="p">)</span>
<span class="n">writeini</span><span class="p">(</span><span class="s">&quot;baz&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;baz&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;baz&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">path</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">path</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">GetPrivateProfileStringA</span><span class="p">(</span><span class="n">string</span><span class="o">,</span><span class="w"> </span><span class="n">string</span><span class="o">,</span><span class="w"> </span><span class="n">string</span><span class="o">,</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">pchar</span><span class="o">,</span><span class="w"> </span><span class="n">dword</span><span class="o">,</span><span class="w"> </span><span class="n">string</span><span class="p">)</span><span class="o">:</span><span class="n">dword</span><span class="o">:</span><span class="n">kernel32</span>
<span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span>
<span class="c">// bufferがpcharなのでNULLを含んだ文字列が返ってくる</span>
<span class="k">print</span><span class="w"> </span><span class="n">GetPrivateProfileStringA</span><span class="p">(</span><span class="n">NULL</span><span class="o">,</span><span class="w"> </span><span class="n">NULL</span><span class="o">,</span><span class="w"> </span><span class="n">NULL</span><span class="o">,</span><span class="w"> </span><span class="n">buffer</span><span class="o">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span><span class="o">,</span><span class="w"> </span><span class="n">path</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">buffer</span><span class="o">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">)</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">GetPrivateProfileStringA</span><span class="p">(</span><span class="n">string</span><span class="o">,</span><span class="w"> </span><span class="n">string</span><span class="o">,</span><span class="w"> </span><span class="n">string</span><span class="o">,</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">string</span><span class="o">,</span><span class="w"> </span><span class="n">dword</span><span class="o">,</span><span class="w"> </span><span class="n">string</span><span class="p">)</span><span class="o">:</span><span class="n">dword</span><span class="o">:</span><span class="n">kernel32</span>
<span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span>
<span class="c">// bufferをstringにすると最初のNULL以前の文字列のみ返ってくる</span>
<span class="k">print</span><span class="w"> </span><span class="n">GetPrivateProfileStringA</span><span class="p">(</span><span class="n">NULL</span><span class="o">,</span><span class="w"> </span><span class="n">NULL</span><span class="o">,</span><span class="w"> </span><span class="n">null</span><span class="o">,</span><span class="w"> </span><span class="n">buffer</span><span class="o">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span><span class="o">,</span><span class="w"> </span><span class="n">path</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">buffer</span>

<span class="c">// 構造体で値を受ける</span>
<span class="c">// varは不要</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">GetCursorPos</span><span class="p">({</span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="p">})</span><span class="o">:</span><span class="n">bool</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span>
<span class="k">print</span><span class="w"> </span><span class="n">GetCursorPos</span><span class="p">(</span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">]</span>

<span class="c">// 構造体はそのサイズに合う配列でも代用可能</span>
<span class="c">// varで渡す</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">GetCursorPos</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">long</span><span class="p">[])</span><span class="o">:</span><span class="n">bool</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="c">// long, long</span>
<span class="k">print</span><span class="w"> </span><span class="n">GetCursorPos</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">point</span>
<span class="c">// サイズを明示するとより安全</span>
<span class="c">// def_dll GetCursorPos(var long[2]):bool:user32.dll</span>
</pre></div>
</div>
</section>
<section id="id67">
<h3>別名による呼び出し例<a class="headerlink" href="#id67" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">本来のDLL関数名とは異なる名前でそのDLL関数を呼び出すことができます</div>
<div class="line">例: MessageBoxWをMessageBoxという名前で呼び出す</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">def_dll</span><span class="w"> </span><span class="n">MessageBox</span><span class="o">:</span><span class="n">MessageBoxW</span><span class="p">(</span><span class="n">hwnd</span><span class="o">,</span><span class="w"> </span><span class="n">wstring</span><span class="o">,</span><span class="w"> </span><span class="n">wstring</span><span class="o">,</span><span class="w"> </span><span class="n">uint</span><span class="p">)</span><span class="o">:</span><span class="n">int</span><span class="o">:</span><span class="n">user32</span><span class="o">.</span><span class="n">dll</span>

<span class="k">print</span><span class="w"> </span><span class="n">MessageBox</span><span class="p">(</span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;別名呼び出しサンプル&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;テスト&quot;</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Win32 APIの <code class="docutils literal notranslate"><span class="pre">GetKeyState</span></code> 関数を登録した場合、組み込み関数の <code class="docutils literal notranslate"><span class="pre">getkeystate</span></code> と競合してしまうという問題がありました</div>
<div class="line">この場合も別名を登録することで関数の使い分けが可能になります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// GetKeyStateWin32という別名でGetKeyState関数を登録</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">GetKeyStateWin32</span><span class="o">:</span><span class="n">GetKeyState</span><span class="p">(</span><span class="n">int</span><span class="p">)</span><span class="o">:</span><span class="n">word</span><span class="o">:</span><span class="n">user32</span>

<span class="k">print</span><span class="w"> </span><span class="n">GetKeyStateWin32</span><span class="w"> </span><span class="c">// GetKeyState(int):word:user32 as GetKeyStateWin32</span>
<span class="k">print</span><span class="w"> </span><span class="n">GetKeyStateWin32</span><span class="p">(</span><span class="n">VK_RETURN</span><span class="p">)</span><span class="w"> </span><span class="c">// Win32のGetKeyStateが呼ばれる</span>
<span class="k">print</span><span class="w"> </span><span class="n">getkeystate</span><span class="p">(</span><span class="n">VK_RETURN</span><span class="p">)</span><span class="w">      </span><span class="c">// 組み込み関数が呼ばれる</span>
</pre></div>
</div>
</section>
</section>
<section id="id68">
<h2>構造体<a class="headerlink" href="#id68" title="この見出しへのパーマリンク">#</a></h2>
<p>def_dllのstruct型に渡す構造体を定義します</p>
<section id="id69">
<h3>構造体定義<a class="headerlink" href="#id69" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>struct 構造体名
    メンバ名: 型名
    メンバ名: 型名[サイズ]
    メンバ名: var 型名
    ︙
endstruct
</pre></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">id:</span> <span class="pre">int</span></code> のようにメンバ名と型名を指定します</div>
<div class="line">メンバが配列の場合は <code class="docutils literal notranslate"><span class="pre">buffer:</span> <span class="pre">byte[260]</span></code> のようにメンバ名、型名に加えてサイズを示す数値または定数を <code class="docutils literal notranslate"><span class="pre">[]</span></code> 内に記述します</div>
<div class="line">型名の前に <code class="docutils literal notranslate"><span class="pre">var</span></code> または <code class="docutils literal notranslate"><span class="pre">ref</span></code> キーワードを記述した場合そのメンバは指定した型のポインタとなります</div>
<div class="line">型名には以下が利用可能です</div>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>型名</p></th>
<th class="head"><p>サイズ</p></th>
<th class="head"><p>詳細</p></th>
<th class="head"><p>対応する値型</p></th>
<th class="head"><p>サイズ指定時</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>int, long</p></td>
<td><p>4</p></td>
<td><p>符号あり32ビット整数</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>bool</p></td>
<td><p>4</p></td>
<td><p>符号あり32ビット整数</p></td>
<td><p>真偽値</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>uint, dword</p></td>
<td><p>4</p></td>
<td><p>符号なし32ビット整数</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>float</p></td>
<td><p>4</p></td>
<td><p>単精度浮動小数点数</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>double</p></td>
<td><p>8</p></td>
<td><p>倍精度浮動小数点数</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>word</p></td>
<td><p>2</p></td>
<td><p>符号なし16ビット整数</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>wchar</p></td>
<td><p>2</p></td>
<td><p>符号なし16ビット整数</p></td>
<td><p>文字</p></td>
<td><p>文字列</p></td>
</tr>
<tr class="row-odd"><td><p>byte</p></td>
<td><p>1</p></td>
<td><p>符号なし8ビット整数</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>char</p></td>
<td><p>1</p></td>
<td><p>符号なし8ビット整数</p></td>
<td><p>文字</p></td>
<td><p>文字列</p></td>
</tr>
<tr class="row-odd"><td><p>boolean</p></td>
<td><p>1</p></td>
<td><p>符号なし8ビット整数</p></td>
<td><p>真偽値</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>longlong</p></td>
<td><p>8</p></td>
<td><p>符号あり64ビット整数</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>string</p></td>
<td><p>可変</p></td>
<td><p>ANSI文字列(char配列)へのポインタ</p></td>
<td><p>文字列</p></td>
<td><p>文字列バッファのサイズ</p></td>
</tr>
<tr class="row-even"><td><p>pchar</p></td>
<td><p>可変</p></td>
<td><p>ANSI文字列(char配列)へのポインタ</p></td>
<td><p>文字列</p></td>
<td><p>文字列バッファのサイズ</p></td>
</tr>
<tr class="row-odd"><td><p>wstring</p></td>
<td><p>可変</p></td>
<td><p>ワイド文字列(wchar配列)へのポインタ</p></td>
<td><p>文字列</p></td>
<td><p>文字列バッファのサイズ</p></td>
</tr>
<tr class="row-even"><td><p>pwchar</p></td>
<td><p>可変</p></td>
<td><p>ワイド文字列(wchar配列)へのポインタ</p></td>
<td><p>文字列</p></td>
<td><p>文字列バッファのサイズ</p></td>
</tr>
<tr class="row-odd"><td><p>hwnd</p></td>
<td><p>可変</p></td>
<td><p>ウィンドウハンドル</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>handle</p></td>
<td><p>可変</p></td>
<td><p>各種ハンドル</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>pointer</p></td>
<td><p>可変</p></td>
<td><p>ポインタを示す数値(符号なし)</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>size</p></td>
<td><p>可変</p></td>
<td><p>サイズ可変の符号なし整数</p></td>
<td><p>数値</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">var 型名</div>
<div class="line">ref 型名</div>
</div>
</td>
<td><div class="line-block">
<div class="line">可変</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">型名のポインタ</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">型に対応する値型</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note admonition">
<p class="admonition-title">可変サイズについて</p>
<div class="line-block">
<div class="line">一部の数値型はOSのアーキテクチャによりそのサイズが変わります</div>
</div>
<ul class="simple">
<li><p>x86: 4</p></li>
<li><p>x64: 8</p></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">hwnd</span></code>, <code class="docutils literal notranslate"><span class="pre">handle</span></code>, <code class="docutils literal notranslate"><span class="pre">pointer</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code> にデータ上の区別はありません</div>
</div>
</div>
<div class="hint admonition">
<p class="admonition-title">文字列型について</p>
<div class="line-block">
<div class="line">string, wstring, pchar, pwcharはそれぞれの文字列を示す数値配列へのポインタとなります</div>
<div class="line">文字列型メンバに代入された文字列は内部で数値配列(バッファ)に変換され、そのポインタが構造体にセットされます</div>
<div class="line">構造体定義時にサイズを指定した場合はバッファサイズは固定となり、そのサイズを超える文字列の代入はできません</div>
<div class="line">サイズ指定がない場合のバッファサイズは代入した文字列により可変です</div>
<div class="line">実際のバッファサイズは <code class="docutils literal notranslate"><span class="pre">bufsize()</span></code> メソッドで取得できます</div>
<div class="line">文字列型メンバにNULLが代入された場合はバッファが削除され構造体にNULLポインタがセットされます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">struct</span><span class="w"> </span><span class="n">Hoge</span>
<span class="w">    </span><span class="n">fuga</span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span>
<span class="w">    </span><span class="n">piyo</span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span><span class="p">[</span><span class="m">260</span><span class="p">]</span>
<span class="kd">endstruct</span>

<span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hoge</span><span class="p">()</span>
<span class="c">// バッファサイズを確認する</span>
<span class="c">// 代入前は0が返る</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="o">.</span><span class="n">bufsize</span><span class="p">(</span><span class="s">&quot;fuga&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 0</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="o">.</span><span class="n">bufsize</span><span class="p">(</span><span class="s">&quot;piyo&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 0</span>

<span class="c">// 代入後はバッファサイズが得られる</span>
<span class="c">// サイズ未指定時は代入した文字列による</span>
<span class="c">// サイズ指定時はサイズ固定</span>
<span class="n">hoge</span><span class="o">.</span><span class="n">fuga</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;fugafuga&quot;</span>
<span class="n">hoge</span><span class="o">.</span><span class="n">piyo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;piyopiyo&quot;</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="o">.</span><span class="n">bufsize</span><span class="p">(</span><span class="s">&quot;fuga&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 9</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="o">.</span><span class="n">bufsize</span><span class="p">(</span><span class="s">&quot;piyo&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 260</span>

<span class="c">// サイズ指定時はサイズを越える文字列は代入不可</span>
<span class="c">// hoge.piyo = &quot;p&quot; * 500 // エラー</span>

<span class="c">// NULLを代入するとバッファが削除され、構造体にはNULLポインタがセットされる</span>
<span class="n">hoge</span><span class="o">.</span><span class="n">piyo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="o">.</span><span class="n">piyo</span><span class="w"> </span><span class="c">// EMPTY</span>
</pre></div>
</div>
</div>
<div class="hint admonition">
<p class="admonition-title">メンバが構造体の場合</p>
<ul>
<li><p>メンバが構造体のポインタである場合</p>
<blockquote>
<div><div class="line-block">
<div class="line">メンバの型名をpointerとしそのメンバに構造体のアドレスを代入するか、メンバの値から構造体を得ます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">def_dll</span><span class="w"> </span><span class="n">WNetGetUniversalNameW</span><span class="p">(</span><span class="n">wstring</span><span class="o">,</span><span class="w"> </span><span class="n">long</span><span class="o">,</span><span class="w"> </span><span class="kd">struct</span><span class="o">,</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">long</span><span class="p">)</span><span class="o">:</span><span class="n">long</span><span class="o">:</span><span class="n">mpr</span>
<span class="c">// WNetGetUniversalNameWに渡す構造体</span>
<span class="kd">struct</span><span class="w"> </span><span class="n">BufferStruct</span>
<span class="w">    </span><span class="n">puni</span><span class="o">:</span><span class="w"> </span><span class="n">pointer</span><span class="w">    </span><span class="c">// UNIVERSAL_NAME_INFOWのポインタが返る</span>
<span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">wchar</span><span class="p">[</span><span class="m">260</span><span class="p">]</span><span class="w"> </span><span class="c">// 文字列バッファ</span>
<span class="kd">endstruct</span>
<span class="kd">struct</span><span class="w"> </span><span class="n">UNIVERSAL_NAME_INFOW</span>
<span class="w">    </span><span class="n">lpUniversalName</span><span class="o">:</span><span class="w"> </span><span class="n">wchar</span><span class="p">[</span><span class="m">260</span><span class="p">]</span>
<span class="kd">endstruct</span>

<span class="c">// 関数に渡す構造体を初期化</span>
<span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BufferStruct</span><span class="p">()</span>

<span class="k">if</span><span class="w"> </span><span class="n">WNetGetUniversalNameW</span><span class="p">(</span><span class="s">&quot;Z:\hoge&quot;</span><span class="o">,</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="n">buf</span><span class="o">,</span><span class="w"> </span><span class="m">260</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="c">// 構造体で受けたポインタでUNIVERSAL_NAME_INFOWを得る</span>
<span class="w">    </span><span class="n">uni</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UNIVERSAL_NAME_INFOW</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">pUni</span><span class="p">)</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">uni</span><span class="o">.</span><span class="n">lpUniversalName</span>
<span class="k">endif</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>メンバが構造体そのものである場合</p>
<blockquote>
<div><div class="line-block">
<div class="line">メンバとなる構造体を定義し、型名として構造体名を記述します</div>
<div class="line">このようなネスト構造の場合は <code class="docutils literal notranslate"><span class="pre">parent.child.member</span></code> のように <code class="docutils literal notranslate"><span class="pre">.</span></code> を連結してメンバにアクセスできます</div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// POINTとRECTは構造体</span>
<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">tagWINDOWPLACEMENT</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">UINT</span><span class="w">  </span><span class="n">length</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">UINT</span><span class="w">  </span><span class="n">flags</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">UINT</span><span class="w">  </span><span class="n">showCmd</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">POINT</span><span class="w"> </span><span class="n">ptMinPosition</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">POINT</span><span class="w"> </span><span class="n">ptMaxPosition</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">RECT</span><span class="w">  </span><span class="n">rcNormalPosition</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">RECT</span><span class="w">  </span><span class="n">rcDevice</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">WINDOWPLACEMENT</span><span class="p">;</span><span class="w"></span>

<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">tagPOINT</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">LONG</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">LONG</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">POINT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">PPOINT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">NPPOINT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">LPPOINT</span><span class="p">;</span><span class="w"></span>

<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">tagRECT</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">LONG</span><span class="w"> </span><span class="n">left</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">LONG</span><span class="w"> </span><span class="n">top</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">LONG</span><span class="w"> </span><span class="n">right</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">LONG</span><span class="w"> </span><span class="n">bottom</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">RECT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">PRECT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">NPRECT</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">LPRECT</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">struct</span><span class="w"> </span><span class="n">POINT</span>
<span class="w">    </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">long</span>
<span class="w">    </span><span class="n">y</span><span class="o">:</span><span class="w"> </span><span class="n">long</span>
<span class="kd">endstruct</span>

<span class="kd">struct</span><span class="w"> </span><span class="n">RECT</span>
<span class="w">    </span><span class="n">left</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="n">long</span>
<span class="w">    </span><span class="n">top</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="n">long</span>
<span class="w">    </span><span class="n">right</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">long</span>
<span class="w">    </span><span class="n">bottom</span><span class="o">:</span><span class="w"> </span><span class="n">long</span>
<span class="kd">endstruct</span>

<span class="kd">struct</span><span class="w"> </span><span class="n">WINDOWPLACEMENT</span>
<span class="w">    </span><span class="n">length</span><span class="w">          </span><span class="o">:</span><span class="w"> </span><span class="n">uint</span>
<span class="w">    </span><span class="n">flags</span><span class="w">           </span><span class="o">:</span><span class="w"> </span><span class="n">uint</span>
<span class="w">    </span><span class="n">showCmd</span><span class="w">         </span><span class="o">:</span><span class="w"> </span><span class="n">uint</span>
<span class="w">    </span><span class="n">ptMinPosition</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="n">POINT</span>
<span class="w">    </span><span class="n">ptMaxPosition</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="n">POINT</span>
<span class="w">    </span><span class="n">rcNormalPosition</span><span class="o">:</span><span class="w"> </span><span class="n">RECT</span>
<span class="w">    </span><span class="n">rcDevice</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">RECT</span>
<span class="kd">endstruct</span>

<span class="n">wp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WINDOWPLACEMENT</span><span class="p">()</span>

<span class="n">wp</span><span class="o">.</span><span class="n">ptMinPosition</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span>
<span class="n">wp</span><span class="o">.</span><span class="n">ptMinPosition</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
</section>
<section id="id70">
<h3>構造体の利用方法<a class="headerlink" href="#id70" title="この見出しへのパーマリンク">#</a></h3>
<section id="id71">
<h4>構造体の初期化<a class="headerlink" href="#id71" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">構造体名()</span></code> で構造体を初期化します</div>
<div class="line">各メンバは0で初期化されます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">struct</span><span class="w"> </span><span class="n">Point</span>
<span class="w">    </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">long</span>
<span class="w">    </span><span class="n">y</span><span class="o">:</span><span class="w"> </span><span class="n">long</span>
<span class="kd">endstruct</span>

<span class="kd">dim</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Point</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id72">
<h4>構造体メンバへのアクセス<a class="headerlink" href="#id72" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">構造体.メンバ名</span></code> でメンバへアクセスします</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Point</span><span class="p">()</span>
<span class="k">print</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="c">// 0</span>
<span class="k">print</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="c">// 0</span>

<span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span>
<span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span>

<span class="k">print</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="c">// 100</span>
<span class="k">print</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="c">// 200</span>
</pre></div>
</div>
</section>
<section id="id73">
<h4>構造体のメソッド<a class="headerlink" href="#id73" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line">構造体は以下のメソッドを持ちます</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> : 構造体のサイズを得る</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code> : 構造体のアドレスを得る</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bufSize(メンバ名)</span></code> : 文字列型メンバのバッファサイズを得る、文字列型以外は0</p></li>
</ul>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">struct</span><span class="w"> </span><span class="n">Hoge</span>
<span class="w">    </span><span class="n">foo</span><span class="o">:</span><span class="w"> </span><span class="n">dword</span>
<span class="w">    </span><span class="n">bar</span><span class="o">:</span><span class="w"> </span><span class="n">dword</span>
<span class="w">    </span><span class="n">baz</span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span>
<span class="w">    </span><span class="n">qux</span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span><span class="p">[</span><span class="m">260</span><span class="p">]</span>
<span class="kd">endstruct</span>

<span class="kd">dim</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hoge</span><span class="p">()</span>

<span class="k">print</span><span class="w"> </span><span class="n">h</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="w">    </span><span class="c">// 24</span>
<span class="k">print</span><span class="w"> </span><span class="n">h</span><span class="o">.</span><span class="n">address</span><span class="p">()</span><span class="w"> </span><span class="c">// アドレスを返す</span>

<span class="c">// 代入していない場合は文字列バッファがないので0</span>
<span class="k">print</span><span class="w"> </span><span class="n">h</span><span class="o">.</span><span class="n">bufSize</span><span class="p">(</span><span class="s">&quot;baz&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 0</span>
<span class="k">print</span><span class="w"> </span><span class="n">h</span><span class="o">.</span><span class="n">bufSize</span><span class="p">(</span><span class="s">&quot;qux&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 0</span>
<span class="c">// 代入後はバッファのサイズが返る</span>
<span class="n">h</span><span class="o">.</span><span class="n">baz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;baz&quot;</span>
<span class="n">h</span><span class="o">.</span><span class="n">qux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;qux&quot;</span>
<span class="k">print</span><span class="w"> </span><span class="n">h</span><span class="o">.</span><span class="n">bufSize</span><span class="p">(</span><span class="s">&quot;baz&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 4</span>
<span class="k">print</span><span class="w"> </span><span class="n">h</span><span class="o">.</span><span class="n">bufSize</span><span class="p">(</span><span class="s">&quot;qux&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 260</span>

<span class="k">print</span><span class="w"> </span><span class="n">h</span><span class="o">.</span><span class="n">bufSize</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// 0 ※文字列型じゃない場合も0</span>
</pre></div>
</div>
</section>
<section id="id74">
<h4>ポインタから構造体を得る<a class="headerlink" href="#id74" title="この見出しへのパーマリンク">#</a></h4>
<p>DLL関数が返す構造体のポインタから構造体にアクセスできます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 第四引数にWTS_SESSION_INFO_1Wのポインタが返る</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">WTSEnumerateSessionsExW</span><span class="p">(</span><span class="n">handle</span><span class="o">,</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">dword</span><span class="o">,</span><span class="w"> </span><span class="n">dword</span><span class="o">,</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">pointer</span><span class="o">,</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">dword</span><span class="p">)</span><span class="o">:</span><span class="n">bool</span><span class="o">:</span><span class="n">Wtsapi32</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">WTSFreeMemoryExW</span><span class="p">(</span><span class="n">dword</span><span class="o">,</span><span class="w"> </span><span class="n">pointer</span><span class="o">,</span><span class="w"> </span><span class="n">dword</span><span class="p">)</span><span class="o">:</span><span class="n">bool</span><span class="o">:</span><span class="n">Wtsapi32</span>

<span class="kd">struct</span><span class="w"> </span><span class="n">WTS_SESSION_INFO_1W</span>
<span class="w">    </span><span class="n">ExecEnvId</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">dword</span>
<span class="w">    </span><span class="n">State</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">int</span>
<span class="w">    </span><span class="n">SessionId</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">dword</span>
<span class="w">    </span><span class="n">pSessionName</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span>
<span class="w">    </span><span class="n">pHostName</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span>
<span class="w">    </span><span class="n">pUserName</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span>
<span class="w">    </span><span class="n">pDomainName</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span>
<span class="w">    </span><span class="n">pFarmName</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">wstring</span>
<span class="kd">endstruct</span>

<span class="c">// 構造体のアドレスと個数を得るための変数</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">ptr</span><span class="o">,</span><span class="w"> </span><span class="n">cnt</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">WTS_SESSION_INFO_1W</span><span class="p">)</span>

<span class="k">if</span><span class="w"> </span><span class="n">WTSEnumerateSessionsExW</span><span class="p">(</span><span class="n">null</span><span class="o">,</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="n">ptr</span><span class="o">,</span><span class="w"> </span><span class="n">cnt</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>
<span class="w">        </span><span class="c">// 構造体は連続しているため、構造体サイズ分のオフセットを加える</span>
<span class="w">        </span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span>
<span class="w">        </span><span class="c">// アドレスから構造体を得る</span>
<span class="w">        </span><span class="n">wsi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WTS_SESSION_INFO_1W</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;addr: &lt;#addr&gt;&quot;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;ExecEnvId    : &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wsi</span><span class="o">.</span><span class="n">ExecEnvId</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;State        : &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wsi</span><span class="o">.</span><span class="n">State</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;SessionId    : &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wsi</span><span class="o">.</span><span class="n">SessionId</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;pSessionName : &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wsi</span><span class="o">.</span><span class="n">pSessionName</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;pHostName    : &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wsi</span><span class="o">.</span><span class="n">pHostName</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;pUserName    : &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wsi</span><span class="o">.</span><span class="n">pUserName</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;pDomainName  : &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wsi</span><span class="o">.</span><span class="n">pDomainName</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;pFarmName    : &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wsi</span><span class="o">.</span><span class="n">pFarmName</span>
<span class="w">        </span><span class="k">print</span>
<span class="w">    </span><span class="k">next</span>

<span class="w">    </span><span class="c">// WTS_SESSION_INFO_1W構造体をすべて開放する</span>
<span class="w">    </span><span class="n">WTSFreeMemoryExW</span><span class="p">(</span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="n">ptr</span><span class="o">,</span><span class="w"> </span><span class="n">cnt</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id75">
<h2>スレッド<a class="headerlink" href="#id75" title="この見出しへのパーマリンク">#</a></h2>
<section id="thread">
<h3>thread<a class="headerlink" href="#thread" title="この見出しへのパーマリンク">#</a></h3>
<p>関数を別のスレッドで実行します</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">thread</span><span class="w"> </span><span class="n">func</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>スレッドスコープで実行されます</dt><dd><ul>
<li><p>(その中でさらに関数スコープに入ります)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>グローバルスコープへのアクセスは可能</dt><dd><ul>
<li><p>public, const, function/procedure, module/class</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>呼び出した関数内でエラーが発生した場合スクリプトが終了します</p></li>
</ul>
</section>
</section>
<section id="task-object">
<span id="id76"></span><h2>タスク<a class="headerlink" href="#task-object" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">関数を非同期実行します</div>
<div class="line">threadとは異なり関数が完了し次第戻り値を受け取れます</div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>タスク関数</dt><dd><ul>
<li><p><a class="reference internal" href="../builtins/scriptcontrol.html#Task" title="Task"><code class="xref any py py-func docutils literal notranslate"><span class="pre">Task</span></code></a></p></li>
<li><p><a class="reference internal" href="../builtins/scriptcontrol.html#WaitTask" title="WaitTask"><code class="xref any py py-func docutils literal notranslate"><span class="pre">WaitTask</span></code></a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>構文</dt><dd><ul>
<li><p><a class="reference internal" href="#async"><span class="std std-ref">async</span></a></p></li>
<li><p><a class="reference internal" href="#await"><span class="std std-ref">await</span></a></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<section id="async">
<span id="id77"></span><h3>async<a class="headerlink" href="#async" title="この見出しへのパーマリンク">#</a></h3>
<p>タスクを返す関数を宣言します</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">function宣言の前に</span> <span class="k">async</span> <span class="n">キーワードを付与</span>
<span class="k">async</span> <span class="n">function</span> <span class="n">関数名</span><span class="p">()</span>
<span class="n">fend</span>
</pre></div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="n">MyFuncAsync</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">sleep</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&lt;#n&gt;秒待ちました&quot;</span>
<span class="kd">fend</span>

<span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyFuncAsync</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c">// resultの値ではなくタスクを返す</span>

<span class="c">// 以下と同じ結果になります</span>
<span class="kd">function</span><span class="w"> </span><span class="n">MyFuncAsync</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">sleep</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&lt;#n&gt;秒待ちました&quot;</span>
<span class="kd">fend</span>

<span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Task</span><span class="p">(</span><span class="n">MyFuncAsync</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="await">
<span id="id78"></span><h3>await<a class="headerlink" href="#await" title="この見出しへのパーマリンク">#</a></h3>
<p>async宣言した関数の終了を待ち、resultの値を得ます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="n">MyFuncAsync</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">sleep</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&lt;#n&gt;秒待ちました&quot;</span>
<span class="kd">fend</span>

<span class="c">// MyFuncAsync()の処理が終了するまで待つ</span>
<span class="k">print</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">MyFuncAsync</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c">// 5秒待ちました</span>
</pre></div>
</div>
</section>
</section>
<section id="with">
<h2>with<a class="headerlink" href="#with" title="この見出しへのパーマリンク">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.</span></code> 演算子の左辺(module名やオブジェクト)を省略できます</p>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">module</span><span class="w"> </span><span class="n">foo</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;bar&#39;</span>
<span class="w">    </span><span class="kd">procedure</span><span class="w"> </span><span class="n">baz</span><span class="p">()</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">endmodule</span>

<span class="kd">with</span><span class="w"> </span><span class="n">foo</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">.</span><span class="n">bar</span><span class="w"> </span><span class="c">// foo.bar</span>
<span class="w">    </span><span class="o">.</span><span class="n">baz</span><span class="p">()</span><span class="w">     </span><span class="c">// foo.baz()</span>
<span class="kd">endwith</span>

<span class="c">// ネストも可</span>

<span class="kd">module</span><span class="w"> </span><span class="n">m</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;m.p&quot;</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="n">f</span><span class="p">()</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m2</span>
<span class="w">    </span><span class="kd">fend</span>
<span class="kd">endmodule</span>

<span class="kd">module</span><span class="w"> </span><span class="n">m2</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;m2.p&quot;</span>
<span class="kd">endmodule</span>

<span class="kd">with</span><span class="w"> </span><span class="n">m</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">.</span><span class="n">p</span><span class="w"> </span><span class="c">// m.p</span>
<span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="o">.</span><span class="n">f</span><span class="p">()</span><span class="w"> </span><span class="c">// m.f() のwithでネスト</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">.</span><span class="n">p</span><span class="w"> </span><span class="c">// m2.p</span>
<span class="w">    </span><span class="kd">endwith</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">.</span><span class="n">p</span><span class="w"> </span><span class="c">// m.p</span>
<span class="kd">endwith</span>
</pre></div>
</div>
</section>
<section id="textblock">
<h2>textblock<a class="headerlink" href="#textblock" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">複数行文字列の定数を定義します</div>
<div class="line">textblock内での改行は <code class="docutils literal notranslate"><span class="pre">&lt;#CR&gt;</span></code> と同様です</div>
<div class="line">特殊文字(<code class="docutils literal notranslate"><span class="pre">&lt;#CR&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;#DBL&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;#TAB&gt;</span></code>)はtextblock文の評価時に展開されます</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">textblock</span> <span class="p">[</span><span class="n">定数名</span><span class="p">]</span>
<span class="p">(</span><span class="n">複数行文字列</span><span class="p">)</span>
<span class="n">endtextblock</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">定数名が省略された場合は複数行コメントとなり、スクリプトの一部として扱われません</div>
<div class="line">(構文木が作られない)</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 定数hogeが作られる</span>
<span class="k">textblock</span><span class="w"> </span><span class="n">hoge</span>
<span class="s">foo</span>
<span class="s">bar</span>
<span class="s">baz</span>
<span class="k">endtextblock</span>

<span class="c">// 定数省略時はコメント扱い</span>
<span class="c">// 値を呼び出すことができない</span>
<span class="k">textblock</span>
<span class="c">ここはコメントです</span>
<span class="k">endtextblock</span>
</pre></div>
</div>
<section id="textblockex">
<h3>textblockex<a class="headerlink" href="#textblockex" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">変数展開が可能なtextblockです</div>
<div class="line">textblockex変数の評価時に展開されます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">textblockex</span><span class="w"> </span><span class="n">hoge</span>
<span class="s">&lt;#fuga&gt;</span>
<span class="k">endtextblock</span>

<span class="n">fuga</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">123</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="w"> </span><span class="c">// 123</span>
<span class="n">fuga</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">456</span>
<span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="w"> </span><span class="c">// 456</span>
</pre></div>
</div>
</section>
</section>
<section id="call">
<h2>call<a class="headerlink" href="#call" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">他のスクリプトを取り込みます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">call</span><span class="w"> </span><span class="n">hoge</span><span class="o">.</span><span class="n">uws</span><span class="w">          </span><span class="c">// 実行するスクリプトからの相対パス</span>
<span class="n">call</span><span class="w"> </span><span class="n">hoge</span><span class="w">              </span><span class="c">// 拡張子のないファイルもOK、見つからない場合は.uwsを付けて開く</span>
<span class="n">call</span><span class="w"> </span><span class="n">fuga</span><span class="o">.</span><span class="n">uws</span><span class="p">(</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c">// 引数を渡すと PARAM_STR にはboolが入る</span>

<span class="c">// urlから読み込み</span>
<span class="k">call</span><span class="w"> </span><span class="k">url</span><span class="p">[</span><span class="l">https://example.com/hoge.uws</span><span class="p">]</span><span class="w">        </span><span class="c">// url[ ] の中でurlを指定</span>
<span class="k">call</span><span class="w"> </span><span class="k">url</span><span class="p">[</span><span class="l">https://example.com/hoge.uws</span><span class="p">](</span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c">// url[ ] の後に()をつけて引数を渡せる</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>グローバル定義はスクリプト実行前に処理されます</dt><dd><ul>
<li><p>public</p></li>
<li><p>const</p></li>
<li><p>textblock</p></li>
<li><p>function</p></li>
<li><p>procedure</p></li>
<li><p>module</p></li>
<li><p>class</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>それ以外の処理部分はcall文が呼ばれる際に実行されます</dt><dd><ul>
<li><p>呼び出し元とは異なるスコープで実行されます</p></li>
<li><p>呼び出し元の <code class="docutils literal notranslate"><span class="pre">PARAM_STR</span></code> にはアクセスできません (独自の <code class="docutils literal notranslate"><span class="pre">PARAM_STR</span></code> を持つため)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<section id="id79">
<h3>同一ファイルの複数箇所呼び出し<a class="headerlink" href="#id79" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">同じファイルを複数箇所でcallした場合、グローバル定義 (関数やmodule等) および宣言 (定数やpublic) は初回のみ処理されます</div>
<div class="line">実行可能部分はcall呼び出しの都度処理されます</div>
</div>
<p>複数箇所呼び出しの例:</p>
<ul class="simple">
<li><p>ファイルAから複数箇所でファイルBがcallされる場合</p></li>
<li><p>ファイルAからファイルB、Cをcallし、BとCのそれぞれからファイルDがcallされる場合</p></li>
<li><p>ファイルAと、ファイルAからcallされたファイルBのそれぞれからファイルCがcallされる場合</p></li>
</ul>
</section>
<section id="uwsl">
<h3>uwslファイルの読み込み<a class="headerlink" href="#uwsl" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">uwslファイルをcallして使えます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">call</span><span class="w"> </span><span class="n">mylib</span><span class="o">.</span><span class="n">uwsl</span><span class="w"> </span><span class="c">// 拡張子はuwslのみ (省略不可)</span>
</pre></div>
</div>
</section>
<section id="id80">
<h3>uwslファイルについて<a class="headerlink" href="#id80" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">構文木をバイナリとして保存したものです</div>
<div class="line">以下のコマンドでバイナリファイルを生成できます</div>
<div class="line">ファイルはスクリプトと同じディレクトリに作成されます</div>
<div class="line">拡張子は <code class="docutils literal notranslate"><span class="pre">.uwsl</span></code> になります</div>
</div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">uwscr</span> <span class="p">-</span><span class="n">-lib</span> <span class="n">path</span><span class="p">\</span><span class="n">to</span><span class="p">\</span><span class="n">module</span><span class="p">.</span><span class="n">uws</span> <span class="c"># module.uwsl が出力される</span>
</pre></div>
</div>
<p>callでの呼び出しにのみ対応しており、直接実行することはできません</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">uwscr</span> <span class="n">module</span><span class="p">.</span><span class="n">uwsl</span> <span class="p">//</span> <span class="n">ng</span>
</pre></div>
</div>
<section id="id81">
<h4>uwslファイル作成の流れ<a class="headerlink" href="#id81" title="この見出しへのパーマリンク">#</a></h4>
<ol class="arabic simple">
<li><p>指定されたスクリプトを読み出す</p></li>
<li><p>構文解析を行い構文木を生成する</p></li>
<li><p>構文木をバイナリデータとしてファイルに書き出す</p></li>
</ol>
</section>
<section id="id82">
<h4>使用例<a class="headerlink" href="#id82" title="この見出しへのパーマリンク">#</a></h4>
<ol class="arabic">
<li><p>多段callしているファイルをまとめてバイナリ化</p>
<blockquote>
<div><p>ファイル構成例</p>
<ul class="simple">
<li><dl class="simple">
<dt>mylib.uws (module1 ~ 3 をcall)</dt><dd><ul>
<li><p>module1.uws</p></li>
<li><dl class="simple">
<dt>module2.uws (submodule1, 2 をcall)</dt><dd><ul>
<li><p>submodule1.uws</p></li>
<li><p>submodule2.uws</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>module3.uws</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">uwscr</span> <span class="n">-l</span> <span class="n">mylib</span><span class="p">.</span><span class="n">uws</span> <span class="c"># mylib.uwslが出力される</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>uwslファイルをcallして使う</p>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">call</span><span class="w"> </span><span class="n">mylib</span><span class="o">.</span><span class="n">uwsl</span>

<span class="n">MyLib</span><span class="o">.</span><span class="n">DoSomething</span><span class="p">()</span>
<span class="n">Module1</span><span class="o">.</span><span class="n">DoSomethingElse</span><span class="p">()</span>
<span class="n">Module2</span><span class="o">.</span><span class="n">DoSomethingWithSubmodule</span><span class="p">(</span><span class="n">Submodule1</span><span class="o">.</span><span class="n">DoSomething</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</section>
</section>
</section>
<section id="id83">
<h2>例外処理<a class="headerlink" href="#id83" title="この見出しへのパーマリンク">#</a></h2>
<ul class="simple">
<li><p><cite>try-except-endtry</cite></p></li>
<li><p><cite>try-finally-endtry</cite></p></li>
<li><p><cite>try-except-finally-endtry</cite></p></li>
</ul>
<div class="line-block">
<div class="line">try部で発生した実行エラーを抑制し、以下の特殊変数にエラー情報を格納します</div>
</div>
<ul class="simple">
<li><p><cite>TRY_ERRMSG</cite>: エラーメッセージ</p></li>
<li><p><cite>TRY_ERRLINE</cite>: エラー行</p></li>
</ul>
<div class="line-block">
<div class="line">except部はtryでエラーが発生した場合のみ実行されます</div>
<div class="line">finally部は必ず実行されます</div>
<div class="line">finally部では <code class="docutils literal notranslate"><span class="pre">continue</span></code>, <code class="docutils literal notranslate"><span class="pre">break</span></code>, <code class="docutils literal notranslate"><span class="pre">exit</span></code> が使えません (構文解析エラーになる)</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">try-except-finally-endtry</span></code> は</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">try</span>
<span class="w">    </span><span class="k">try</span>
<span class="w">    </span><span class="k">except</span>
<span class="w">    </span><span class="k">endtry</span>
<span class="k">finally</span>
<span class="k">endtry</span>
</pre></div>
</div>
<p>と同等です</p>
<section id="except">
<h3>except例<a class="headerlink" href="#except" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">try</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="n">raise</span><span class="p">(</span><span class="s">&quot;エラー&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// ここでエラー</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// 実行されない</span>
<span class="k">except</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">TRY_ERRMSG</span><span class="w"> </span><span class="c">// 実行される</span>
<span class="k">endtry</span>

<span class="k">try</span>
<span class="w">    </span><span class="c">// エラーが発生しない場合</span>
<span class="k">except</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// 実行されない</span>
<span class="k">endtry</span>
</pre></div>
</div>
</section>
<section id="finally">
<h3>finally例<a class="headerlink" href="#finally" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">try</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="n">raise</span><span class="p">(</span><span class="s">&quot;エラー&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// ここでエラー</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// 実行されない</span>
<span class="k">finally</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">TRY_ERRMSG</span><span class="w"> </span><span class="c">// 実行される</span>
<span class="k">endtry</span>

<span class="k">try</span>
<span class="w">    </span><span class="c">// エラーが発生しない場合</span>
<span class="k">finally</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// 実行される</span>
<span class="k">endtry</span>
</pre></div>
</div>
</section>
<section id="except-finally">
<h3>except-finally例<a class="headerlink" href="#except-finally" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">try</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="n">raise</span><span class="p">(</span><span class="s">&quot;エラー&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// ここでエラー</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// 実行されない</span>
<span class="k">except</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">TRY_ERRMSG</span><span class="w"> </span><span class="c">// 実行される</span>
<span class="k">finally</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">TRY_ERRMSG</span><span class="w"> </span><span class="c">// 実行される</span>
<span class="k">endtry</span>

<span class="k">try</span>
<span class="w">    </span><span class="c">// エラーが発生しない場合</span>
<span class="k">except</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// 実行されない</span>
<span class="k">finally</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// 実行される</span>
<span class="k">endtry</span>
</pre></div>
</div>
</section>
</section>
<section id="id84">
<h2>制御文<a class="headerlink" href="#id84" title="この見出しへのパーマリンク">#</a></h2>
<p>説明文中の <code class="docutils literal notranslate"><span class="pre">式</span></code> とは主に値を返す演算式や関数など
<code class="docutils literal notranslate"><span class="pre">文</span></code> は制御文のことです
<code class="docutils literal notranslate"><span class="pre">ブロック文``は</span> <span class="pre">``文</span></code> が複数行ある状態です</p>
<section id="if">
<h3>if<a class="headerlink" href="#if" title="この見出しへのパーマリンク">#</a></h3>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">if</span></code> と <code class="docutils literal notranslate"><span class="pre">ifb</span></code> が区別されません</div>
<div class="line">どちらも同じものとして扱われます</div>
</div>
</div>
<section id="id85">
<h4>単行if<a class="headerlink" href="#id85" title="この見出しへのパーマリンク">#</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">条件式</span> <span class="n">then</span> <span class="n">文</span> <span class="p">[</span><span class="k">else</span> <span class="n">文</span><span class="p">]</span>
</pre></div>
</div>
<div class="tip admonition">
<p class="admonition-title">条件式について</p>
<div class="line-block">
<div class="line">if文の条件式はオプションにより異なる判定を行います</div>
<div class="line">詳しくは <a class="reference internal" href="#tf-cond"><span class="std std-ref">条件式の判定</span></a> を参照してください</div>
</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="c">// foo が真の場合 bar が実行され、偽の場合なにもしない</span>
<span class="k">if</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">baz</span><span class="c">// foo が真の場合 bar、偽の場合 baz が実行される</span>

<span class="c">// UWSCとは異なり ifb でもエラーにはならない</span>
<span class="n">ifb</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">bar</span>
</pre></div>
</div>
</section>
<section id="id86">
<h4>複数行if<a class="headerlink" href="#id86" title="この見出しへのパーマリンク">#</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">条件式</span> <span class="p">[</span><span class="n">then</span><span class="p">]</span>
    <span class="n">ブロック文</span>
<span class="p">[</span><span class="n">elseif</span> <span class="n">条件式</span> <span class="p">[</span><span class="n">then</span><span class="p">]]</span>
    <span class="n">ブロック文</span>
<span class="p">[</span><span class="k">else</span><span class="p">]</span>
    <span class="n">ブロック文</span>
<span class="n">endif</span>
</pre></div>
</div>
<div class="tip admonition">
<p class="admonition-title">条件式について</p>
<div class="line-block">
<div class="line">if及びelseifの条件式はオプションにより異なる判定を行います</div>
<div class="line">詳しくは <a class="reference internal" href="#tf-cond"><span class="std std-ref">条件式の判定</span></a> を参照してください</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><code class="docutils literal notranslate"><span class="pre">elseif</span></code> は複数回記述できる</p>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="c">// fooが真なら実行され偽ならなにもしない</span>
<span class="k">endif</span>

<span class="k">if</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="c">// fooが真なら実行される</span>
<span class="k">else</span>
<span class="w">    </span><span class="c">// fooが偽なら実行される</span>
<span class="k">endif</span>


<span class="k">if</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="c">// fooが真なら実行される</span>
<span class="k">elseif</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="c">// fooが偽かつbarが真なら実行される</span>
<span class="k">elseif</span><span class="w"> </span><span class="n">baz</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="c">// fooが偽かつbazが真なら実行される</span>
<span class="k">else</span>
<span class="w">    </span><span class="c">// foobarbazいずれも偽なら実行される</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
</section>
<section id="for">
<h3>for<a class="headerlink" href="#for" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">変数</span> <span class="o">=</span> <span class="n">式1</span> <span class="n">to</span> <span class="n">式2</span> <span class="p">[</span><span class="n">step</span> <span class="n">式3</span><span class="p">]</span>
    <span class="n">ブロック文</span>
<span class="nb">next</span>
</pre></div>
</div>
<p><cite>式1</cite> ～ <cite>式3</cite> はいずれも数値を返す必要があります
<cite>step 式3</cite> が省略された場合 <cite>step 1</cite> として扱われます
小数が渡された場合は整数に丸められます (UWSCとは仕様が異なります)</p>
<ol class="arabic simple">
<li><p><cite>変数</cite> に <cite>式1</cite> を代入した状態で <cite>ブロック文</cite> を処理</p></li>
<li><p><cite>変数</cite> の値に <cite>式3</cite> を加算したものを再代入し <cite>ブロック文</cite> を処理</p></li>
<li><p><cite>変数</cite> に <cite>式2</cite> を超える値が代入されたら終了</p></li>
<li><p>終了後も変数の値は維持されます</p></li>
</ol>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">2</span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">// 順に 0 1 2 が出力される</span>
<span class="w">  </span><span class="k">next</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">// 3</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="m">2</span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">// 順に 0 2 4 が出力される</span>
<span class="w">  </span><span class="k">next</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">// 6</span>

<span class="w">  </span><span class="c">// stepは減算も可能</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">-</span><span class="m">1</span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="n">i</span>
<span class="w">  </span><span class="k">next</span>

<span class="w">  </span><span class="c">// ループ変数に代入した場合</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">0</span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">// 0</span>
<span class="w">      </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">// 10</span>
<span class="w">  </span><span class="k">next</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w">     </span><span class="c">// 1</span>

<span class="w">  </span><span class="c">// UWSCでは小数が利用可能でしたがUWSCRでは整数値に変換されます</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">.</span><span class="m">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">1</span><span class="o">.</span><span class="m">9</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="m">0</span><span class="o">.</span><span class="m">1</span><span class="w"> </span><span class="c">// 0.1 -&gt; 0, 1.9 -&gt; 2 に丸められます</span>
<span class="w">  </span><span class="k">next</span>
</pre></div>
</div>
</section>
<section id="for-in">
<h3>for-in<a class="headerlink" href="#for-in" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">変数</span><span class="p">[,</span> <span class="n">位置</span><span class="p">,</span> <span class="n">最終周フラグ</span><span class="p">]</span> <span class="ow">in</span> <span class="n">式</span>
    <span class="n">ブロック文</span>
<span class="nb">next</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">式</span></code> は以下を返す必要があります</div>
</div>
<ul class="simple">
<li><p>配列</p></li>
<li><p>連想配列</p></li>
<li><p>文字列</p></li>
<li><p>COMのコレクション</p></li>
<li><p>Iteratorを実装するRemoteObject</p></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">式</span></code> が返す値をその種類に応じて分解し <code class="docutils literal notranslate"><span class="pre">変数</span></code> に代入していきます</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">位置</span></code> に識別子(変数)を入れた場合、その識別子に位置(インデックス)番号を代入します</div>
<div class="line">最終周フラグ に識別子(変数)を入れた場合、最終周であればTRUE、そうでなければFALSEをその識別子に代入します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 文字列は1文字ずつ分解</span>
<span class="k">for</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s">&quot;あいうえお&quot;</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="c">// あ い う え お が順に出力される</span>
<span class="k">next</span>

<span class="c">// 配列は各要素</span>
<span class="k">for</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;あ&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;い&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;う&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;え&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;お&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="c">// あ い う え お が順に出力される</span>
<span class="k">next</span>

<span class="c">// 連想配列はキーを返す</span>
<span class="kd">hashtbl</span><span class="w"> </span><span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HASH_SORT</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;d&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>
<span class="n">hoge</span><span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>

<span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">hoge</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">key</span><span class="w">        </span><span class="c">// a b c d の順に出力される</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">hoge</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w">  </span><span class="c">// 1 2 3 4 の順に出力される</span>
<span class="k">next</span>

<span class="c">// 位置を得る</span>
<span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="p">]</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="c">// 1, 3, 5 と出力される</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">// 0, 1, 2 と出力される</span>
<span class="k">next</span>

<span class="c">// インデックスおよび最終周フラグを得る</span>
<span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="p">]</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="c">// 1, 3, 5 と出力される</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">// 0, 1, 2 と出力される</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="c">// False, False, True と出力される</span>
<span class="k">next</span>

<span class="c">// インデックス得ず最終周フラグのみ得る</span>
<span class="c">// 識別子を省略する</span>
<span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="o">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="o">,</span><span class="w"> </span><span class="m">3</span><span class="o">,</span><span class="w"> </span><span class="m">5</span><span class="p">]</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="c">// 1, 3, 5 と出力される</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="c">// False, False, True と出力される</span>
<span class="k">next</span>
</pre></div>
</div>
</section>
<section id="for-else-endfor">
<h3>for-else-endfor<a class="headerlink" href="#for-else-endfor" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a</span> <span class="n">to</span> <span class="n">b</span>
    <span class="n">ブロック文</span>
<span class="k">else</span>
    <span class="n">ブロック文</span>
<span class="n">endfor</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">b</span>
    <span class="n">ブロック文</span>
<span class="k">else</span>
    <span class="n">ブロック文</span>
<span class="n">endfor</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">forループをbreakで抜けなかった場合にelse句以降が実行されます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="c">// 要素のいずれかがtargetと一致した場合break</span>
<span class="w">        </span><span class="n">target_found</span><span class="p">()</span>
<span class="w">        </span><span class="k">break</span>
<span class="w">    </span><span class="k">endif</span>
<span class="k">else</span>
<span class="w">    </span><span class="c">// いずれの要素もtargetと一致しない場合はbreakしないのでこちらが実行される</span>
<span class="w">    </span><span class="n">target_not_found</span><span class="p">()</span>
<span class="k">endfor</span>

<span class="c">// for-inにも対応</span>
<span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">items</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="n">target_found</span><span class="p">()</span>
<span class="w">        </span><span class="k">break</span>
<span class="w">    </span><span class="k">endif</span>
<span class="k">else</span>
<span class="w">    </span><span class="n">target_not_found</span><span class="p">()</span>
<span class="k">endfor</span>

<span class="c">// ループ内の処理が行われない場合でもelseが実行される</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">-</span><span class="m">1</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c">// 実行されないため表示もされない</span>
<span class="k">else</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c">// 2と表示される</span>
<span class="k">endfor</span>
<span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c">// 実行されない</span>
<span class="k">else</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="c">// 4と表示される</span>
<span class="k">endfor</span>
</pre></div>
</div>
</section>
<section id="while">
<h3>while<a class="headerlink" href="#while" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="n">条件式</span>
    <span class="n">ブロック文</span>
<span class="n">wend</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><cite>条件式</cite> が真である限り <cite>ブロック文</cite> を繰り返し処理します</div>
<div class="line">(ループ中に条件式を偽にしない限り無限ループする)</div>
</div>
<div class="tip admonition">
<p class="admonition-title">条件式について</p>
<div class="line-block">
<div class="line">while文の条件式はオプションにより異なる判定を行います</div>
<div class="line">詳しくは <a class="reference internal" href="#tf-cond"><span class="std std-ref">条件式の判定</span></a> を参照してください</div>
</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span>
<span class="k">while</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoSomething</span><span class="p">()</span><span class="w"> </span><span class="c">// 偽値を返せばループ終了</span>
<span class="k">wend</span>

<span class="k">while</span><span class="w"> </span><span class="n">false</span>
<span class="w">    </span><span class="c">// 式が偽なら何も実行されない</span>
<span class="k">wend</span>

<span class="k">while</span><span class="w"> </span><span class="n">TRUE</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;無限ループ&quot;</span>
<span class="k">wend</span>
</pre></div>
</div>
</section>
<section id="repeat">
<h3>repeat<a class="headerlink" href="#repeat" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repeat</span>
    <span class="n">ブロック文</span>
<span class="n">until</span> <span class="n">条件式</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><cite>条件式</cite> が偽である限り <cite>ブロック文</cite> を繰り返し処理します</div>
<div class="line">(ループ中に式を真にしない限り無限ループする)</div>
</div>
<div class="tip admonition">
<p class="admonition-title">条件式について</p>
<div class="line-block">
<div class="line">repeat文の条件式はオプションにより異なる判定を行います</div>
<div class="line">詳しくは <a class="reference internal" href="#tf-cond"><span class="std std-ref">条件式の判定</span></a> を参照してください</div>
</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">false</span>
<span class="k">repeat</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoSomething</span><span class="p">()</span><span class="w"> </span><span class="c">// 真値を返せばループ終了</span>
<span class="k">until</span><span class="w"> </span><span class="n">a</span>

<span class="k">repeat</span>
<span class="w">    </span><span class="c">// 式が真でも一度は必ず実行される</span>
<span class="k">until</span><span class="w"> </span><span class="n">TRUE</span>

<span class="k">repeat</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;無限ループ&quot;</span>
<span class="k">until</span><span class="w"> </span><span class="n">FALSE</span>
</pre></div>
</div>
</section>
<section id="continue">
<h3>continue<a class="headerlink" href="#continue" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">continue</span> <span class="p">[</span><span class="n">式</span><span class="p">]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">ループ文(for, while, repet)にてループの先頭に戻ります</div>
<div class="line"><cite>式</cite> は正の整数を指定します</div>
<div class="line">省略した場合 <cite>式</cite> は <cite>1</cite> として扱われます</div>
<div class="line">多重ループで複数のループをcontinueしたい場合 <cite>式</cite> に2以上(ループの数分)を指定します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">2</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;3回出力される&quot;</span>
<span class="w">    </span><span class="k">continue</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;出力されない&quot;</span>
<span class="k">next</span>

<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="k">while</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">5</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="n">TRUE</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="w">        </span><span class="k">continue</span><span class="w"> </span><span class="m">2</span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">wend</span>
<span class="k">wend</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 5</span>
<span class="k">print</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="c">// 1</span>
</pre></div>
</div>
</section>
<section id="break">
<h3>break<a class="headerlink" href="#break" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">break</span> <span class="p">[</span><span class="n">式</span><span class="p">]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">ループ文(for, while, repet)にてループを抜けます</div>
<div class="line"><cite>式</cite> は正の整数を指定します</div>
<div class="line">省略した場合 <cite>式</cite> は <cite>1</cite> として扱われます</div>
<div class="line">多重ループで複数のループをbreakしたい場合 <cite>式</cite> に2以上(ループの数分)を指定します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="m">2</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;1回だけ出力される&quot;</span>
<span class="w">    </span><span class="k">break</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;出力されない&quot;</span>
<span class="k">next</span>

<span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="k">repeat</span>
<span class="w">    </span><span class="k">repeat</span>
<span class="w">        </span><span class="k">repeat</span>
<span class="w">            </span><span class="k">break</span><span class="w"> </span><span class="m">3</span>
<span class="w">            </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="w">        </span><span class="k">until</span><span class="w"> </span><span class="n">FALSE</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">until</span><span class="w"> </span><span class="n">FALSE</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="k">until</span><span class="w"> </span><span class="n">FALSE</span>
<span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">// 0</span>
</pre></div>
</div>
</section>
<section id="select">
<h3>select<a class="headerlink" href="#select" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>select 式
    case 式
        ブロック文
    [case 式, 式 …]
        ブロック文
    [default]
        ブロック文
selend
</pre></div>
</div>
<div class="line-block">
<div class="line">select式を評価し、その結果とcase式が一致した場合にそのcase以下のブロック文が処理されます</div>
<div class="line">caseに <code class="docutils literal notranslate"><span class="pre">,</span></code> 区切りで式を複数指定した場合、いずれかが一致すればそのブロック文が処理されます</div>
</div>
<ol class="arabic simple">
<li><p>select式を評価し結果を得る</p></li>
<li><dl class="simple">
<dt>case式を評価しselect式の結果と比較</dt><dd><ul class="simple">
<li><p>一致した場合: その下のブロック文を処理しselectを終了する</p></li>
<li><p>不一致の場合: 次のcaseまたはdefaultに進む</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>defaultに到達した場合必ずその下のブロック文を処理する</p></li>
<li><p>defaultがなくいずれのcaseにも一致しない場合なにも行わない</p></li>
</ol>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="kd">select</span><span class="w"> </span><span class="n">hoge</span>
<span class="w">    </span><span class="kd">case</span><span class="w"> </span><span class="m">1</span>
<span class="w">        </span><span class="c">// hogeが1なら実行される</span>
<span class="w">    </span><span class="kd">case</span><span class="w"> </span><span class="m">2</span><span class="o">,</span><span class="w"> </span><span class="m">3</span>
<span class="w">        </span><span class="c">// hogeが2か3なら実行される</span>
<span class="w">    </span><span class="kd">case</span><span class="w"> </span><span class="m">3</span>
<span class="w">        </span><span class="c">// hogeが3でも上のcaseが該当してるので実行されない</span>
<span class="w">    </span><span class="kd">default</span>
<span class="w">        </span><span class="c">// hogeが1～3以外なら実行される</span>
<span class="kd">selend</span>

<span class="kd">select</span><span class="w"> </span><span class="n">hoge</span>
<span class="w">    </span><span class="kd">default</span>
<span class="w">        </span><span class="c">// 必ず実行される</span>
<span class="kd">selend</span>

<span class="kd">select</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="kd">case</span><span class="w"> </span><span class="m">2</span>
<span class="w">        </span><span class="c">// なにも実行されない</span>
<span class="kd">selend</span>
</pre></div>
</div>
</section>
<section id="exit">
<h3>exit<a class="headerlink" href="#exit" title="この見出しへのパーマリンク">#</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>スクリプト本文に記述した場合</dt><dd><p>スクリプト実行を終了します</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>関数内に記述した場合</dt><dd><p>関数を抜けます</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>REPLで実行した場合</dt><dd><p>REPLを終了します</p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">hoge</span><span class="p">()</span><span class="w"> </span><span class="c">// 2 は出力されない</span>

<span class="kd">procedure</span><span class="w"> </span><span class="n">hoge</span><span class="p">()</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="n">exit</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="m">2</span>
<span class="kd">fend</span>
</pre></div>
</div>
</section>
<section id="exitexit">
<h3>exitexit<a class="headerlink" href="#exitexit" title="この見出しへのパーマリンク">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">exitexit</span> <span class="p">[</span><span class="n">数値</span><span class="p">]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">数値を指定した場合はUWSCRの終了コードになります</div>
<div class="line">(省略時は終了コード0)</div>
</div>
</section>
<section id="print">
<h3>print<a class="headerlink" href="#print" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">評価した式を文字列として出力します</div>
<div class="line">またそれをログファイルに記録します</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">式</span>
</pre></div>
</div>
<section id="id87">
<h4>print文の出力<a class="headerlink" href="#id87" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line">標準ではコンソールウィンドウに対して出力が行われます</div>
<div class="line">以下の場合はprintウィンドウに出力します</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OPTION</span> <span class="pre">GUIPRINT</span></code> が有効の場合</p></li>
<li><p>ウィンドウモードでUWSCRを実行している場合 (<code class="docutils literal notranslate"><span class="pre">uwscr.exe</span> <span class="pre">-w</span></code>)</p></li>
<li><p>GUIビルドのUWSCRを実行している場合</p></li>
</ul>
</section>
<section id="id88">
<h4>ログファイルへの書き出し<a class="headerlink" href="#id88" title="この見出しへのパーマリンク">#</a></h4>
<div class="line-block">
<div class="line">ログ出力が有効になっている場合はprintした内容をログファイルに書き出します</div>
</div>
</section>
</section>
</section>
<section id="com">
<span id="com-object"></span><h2>COMオブジェクト<a class="headerlink" href="#com" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line"><a class="reference internal" href="../builtins/comobject.html#createoleobj" title="createoleobj"><code class="xref py py-func docutils literal notranslate"><span class="pre">createoleobj()</span></code></a>, <a class="reference internal" href="../builtins/comobject.html#getactiveoleobj" title="getactiveoleobj"><code class="xref py py-func docutils literal notranslate"><span class="pre">getactiveoleobj()</span></code></a> により取得可能</div>
<div class="line">またCOMオブジェクトのプロパティやメソッドが別のCOMオブジェクトを返す場合もあります</div>
</div>
<section id="id89">
<h3>プロパティの取得<a class="headerlink" href="#id89" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">COMオブジェクト.プロパティ名</span></code> でプロパティの値を取得できます</div>
</div>
<section id="id90">
<h4>プロパティ取得<a class="headerlink" href="#id90" title="この見出しへのパーマリンク">#</a></h4>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">CurrentDirectory</span><span class="w"> </span><span class="c">// 現在のワーキングフォルダのパスが表示される</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id91">
<h4>インデックス指定<a class="headerlink" href="#id91" title="この見出しへのパーマリンク">#</a></h4>
<blockquote>
<div><div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">Environment</span><span class="o">.</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;windir&quot;</span><span class="p">]</span><span class="w"> </span><span class="c">// %SystemRoot%</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">Environment</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="s">&quot;windir&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// () も可</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id92">
<h4>コレクションに対するインデックス指定<a class="headerlink" href="#id92" title="この見出しへのパーマリンク">#</a></h4>
<blockquote>
<div><div class="line-block">
<div class="line">COMオブジェクトがコレクションの場合、インデックス指定で要素を得られる</div>
<div class="line">Item(i)の糖衣構文として実装されているため、Itemメソッドを持たない場合はエラーになる</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="c">// ws.SpecialFoldersはIWshCollectionというコレクション</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">SpecialFolders</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="c">// いずれかの特殊フォルダのパスが表示される</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">SpecialFolders</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="c">// ()でもOK</span>
<span class="c">// これらは以下と同じ</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">SpecialFolders</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="id93">
<h3>プロパティの変更<a class="headerlink" href="#id93" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">プロパティに対して値を代入することでプロパティを変更できます</div>
</div>
<section id="id94">
<h4>代入<a class="headerlink" href="#id94" title="この見出しへのパーマリンク">#</a></h4>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">CurrentDirectory</span><span class="w"> </span><span class="c">// 元々のカレントディレクトリ</span>
<span class="n">ws</span><span class="o">.</span><span class="n">CurrentDirectory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;D:\Hoge&quot;</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">CurrentDirectory</span><span class="w"> </span><span class="c">// D:\Hoge</span>
</pre></div>
</div>
</section>
<section id="id95">
<h4>インデックス指定による代入<a class="headerlink" href="#id95" title="この見出しへのパーマリンク">#</a></h4>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">excel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;Excel.Application&quot;</span><span class="p">)</span>
<span class="n">excel</span><span class="o">.</span><span class="n">visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span>
<span class="n">excel</span><span class="o">.</span><span class="n">Workbooks</span><span class="o">.</span><span class="n">Add</span><span class="p">()</span>

<span class="n">range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">excel</span><span class="o">.</span><span class="n">ActiveSheet</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s">&quot;A1:A2&quot;</span><span class="p">)</span>
<span class="c">// A1に値を代入</span>
<span class="n">range</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hoge&quot;</span>
<span class="k">print</span><span class="w"> </span><span class="n">range</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">.</span><span class="n">Value</span><span class="w"> </span><span class="c">// hoge</span>
<span class="c">// A2にA1を代入</span>
<span class="n">range</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="k">print</span><span class="w"> </span><span class="n">range</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">.</span><span class="n">Value</span><span class="w"> </span><span class="c">// hoge</span>
</pre></div>
</div>
</section>
</section>
<section id="id96">
<h3>メソッドの実行<a class="headerlink" href="#id96" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">COMオブジェクト.メソッド名([引数,</span> <span class="pre">引数,</span> <span class="pre">...])</span></code> でメソッドを実行できます</div>
<div class="line">通常の引数に加え、名前付き引数(<code class="docutils literal notranslate"><span class="pre">名前</span> <span class="pre">:=</span> <span class="pre">値</span></code>)や参照渡し(<code class="docutils literal notranslate"><span class="pre">ref</span> <span class="pre">変数</span></code>)が利用可能です</div>
</div>
<div class="caution admonition">
<p class="admonition-title">メソッドの()なし実行について</p>
<div class="line-block">
<div class="line">UWSCでは引数のない(または全て省略可能な)メソッドは <code class="docutils literal notranslate"><span class="pre">()</span></code> を付けなくても実行できましたが、UWSCRではこれをメソッド扱いしません</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// ()省略サンプル</span>
<span class="n">excel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;Excel.Application&quot;</span><span class="p">)</span>
<span class="n">excel</span><span class="o">.</span><span class="n">Quit</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">UWSCではQuitメソッドを実行していましたが、UWSCRではQuitプロパティへのアクセス扱いとなります</div>
<div class="line">Excel.ApplicationにはQuitプロパティが存在しないためエラーになります</div>
<div class="line">メソッドとして実行する場合は必ず <code class="docutils literal notranslate"><span class="pre">()</span></code> を付けてください</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// こうすればUWSCでもUWSCRでも正常に動作する</span>
<span class="n">excel</span><span class="o">.</span><span class="n">Quit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<section id="id97">
<h4>名前なし引数<a class="headerlink" href="#id97" title="この見出しへのパーマリンク">#</a></h4>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">Popup</span><span class="p">(</span><span class="s">&quot;テキスト&quot;</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;タイトル&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id98">
<h4>名前付き引数<a class="headerlink" href="#id98" title="この見出しへのパーマリンク">#</a></h4>
<blockquote>
<div><div class="line-block">
<div class="line">名前を指定してメソッドに引数を渡すことができます</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">引数名</span> <span class="pre">:=</span> <span class="pre">値</span></code> と記述します</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">Popup</span><span class="p">(</span><span class="n">Text</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;テキスト&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;タイトル&quot;</span><span class="p">)</span>

<span class="c">// 名前なし引数との併記</span>
<span class="c">// 名前なし引数は正しい位置に書く必要がある</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">Popup</span><span class="p">(</span><span class="s">&quot;テキスト&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;タイトル&quot;</span><span class="p">)</span>

<span class="c">// 名前付き引数のあとに名前なしは書けない</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">Popup</span><span class="p">(</span><span class="n">Text</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;テキスト&quot;</span><span class="o">,</span><span class="w"> </span><span class="m">0</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;タイトル&quot;</span><span class="p">)</span><span class="w"> </span><span class="c">// エラー</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="id99">
<h4>参照渡し<a class="headerlink" href="#id99" title="この見出しへのパーマリンク">#</a></h4>
<blockquote>
<div><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ref</span></code> または <code class="docutils literal notranslate"><span class="pre">var</span></code> キーワードで参照渡しになります</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// uwscr x86でのみ動作</span>

<span class="n">sc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;ScriptControl&quot;</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;VBScript&quot;</span>
<span class="n">sc</span><span class="o">.</span><span class="n">ExecuteStatement</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>

<span class="kd">dim</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>
<span class="k">print</span><span class="w"> </span><span class="n">sc</span><span class="o">.</span><span class="n">CodeObject</span><span class="o">.</span><span class="n">Hoge</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="c">// 50</span>
<span class="k">print</span><span class="w"> </span><span class="n">n</span><span class="w">                         </span><span class="c">// 100</span>

<span class="k">textblock</span><span class="w"> </span><span class="n">script</span>
<span class="s">Function Hoge(ByRef n)</span>
<span class="s">    Hoge = n &#39;引数をそのまま返す</span>
<span class="s">    n = 100  &#39;引数の値を更新する</span>
<span class="s">End Function</span>
<span class="k">endtextblock</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="wmi">
<h4>一部のWMIオブジェクトのメソッドについて<a class="headerlink" href="#wmi" title="この見出しへのパーマリンク">#</a></h4>
<div class="important admonition">
<p class="admonition-title">一部WMIメソッドの注意点</p>
<div class="line-block">
<div class="line">一部のWMIオブジェクトのメソッドは通常のCOMオブジェクトのようなメソッド実行ができません</div>
<div class="line">このようなメソッドに対しては内部で自動的にWMIオブジェクトのメソッド実行処理に切り替わります</div>
<div class="line">この場合以下の制限があります</div>
</div>
<ul class="simple">
<li><p>名前付き引数が利用できません</p></li>
</ul>
<div class="line-block">
<div class="line">該当するWMIオブジェクトは以下になります</div>
</div>
<ul class="simple">
<li><p>ISWbemObject</p></li>
<li><p>ISWbemObjectEx</p></li>
</ul>
<div class="line-block">
<div class="line">以下は実行例です</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="kd">dim</span><span class="w"> </span><span class="n">hDefKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">$80000002</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">sSubKeyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\&quot;</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">sValueName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CurrentVersion&quot;</span>

<span class="n">locator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateOleObj</span><span class="p">(</span><span class="s">&quot;Wbemscripting.SWbemLocator&quot;</span><span class="p">)</span>
<span class="n">service</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">locator</span><span class="o">.</span><span class="n">ConnectServer</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">,</span><span class="w"> </span><span class="s">&quot;root\default&quot;</span><span class="p">)</span>
<span class="n">stdRegProv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">service</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;StdRegProv&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">stdRegProv</span><span class="w"> </span><span class="c">// ComObject(ISWbemObjectEx)</span>

<span class="c">// stdRegProv.GetStringValueは通常の実行ができないためWMIメソッド処理で実行される</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">sValue</span>
<span class="k">print</span><span class="w"> </span><span class="n">stdRegProv</span><span class="o">.</span><span class="n">GetStringValue</span><span class="p">(</span><span class="n">hDefKey</span><span class="o">,</span><span class="w"> </span><span class="n">sSubKeyName</span><span class="o">,</span><span class="w"> </span><span class="n">sValueName</span><span class="o">,</span><span class="w"> </span><span class="k">ref</span><span class="w"> </span><span class="n">sValue</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">sValue</span>

<span class="c">// 上記のメソッド実行は以下のコードと同等の処理を内部的に行っています</span>
<span class="n">inparam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdRegProv</span><span class="o">.</span><span class="n">Methods_</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="s">&quot;GetStringValue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">InParameters</span><span class="o">.</span><span class="n">SpawnInstance_</span><span class="p">()</span>
<span class="n">inparam</span><span class="o">.</span><span class="n">hDefKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hDefKey</span>
<span class="n">inparam</span><span class="o">.</span><span class="n">sSubKeyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sSubKeyName</span>
<span class="n">inparam</span><span class="o">.</span><span class="n">sValueName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sValueName</span>
<span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdRegProv</span><span class="o">.</span><span class="n">ExecMethod_</span><span class="p">(</span><span class="s">&quot;GetStringValue&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">inparam</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">out</span><span class="o">.</span><span class="n">ReturnValue</span>
<span class="k">print</span><span class="w"> </span><span class="n">out</span><span class="o">.</span><span class="n">sValue</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="id100">
<h3>型の確認<a class="headerlink" href="#id100" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">COMオブジェクトをprintすることで型の名前を確認できます</div>
<div class="line">オブジェクトがコレクションの場合は <code class="docutils literal notranslate"><span class="pre">型名[]</span></code> と表示されます</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="w">                </span><span class="c">// ComObject(IWshShell3)</span>
<span class="k">print</span><span class="w"> </span><span class="n">ws</span><span class="o">.</span><span class="n">specialfolders</span><span class="w"> </span><span class="c">// ComObject(IWshCollection[])</span>
</pre></div>
</div>
</section>
<section id="com-err-ign-com-err-ret">
<h3>COM_ERR_IGN-COM_ERR_RET<a class="headerlink" href="#com-err-ign-com-err-ret" title="この見出しへのパーマリンク">#</a></h3>
<div class="line-block">
<div class="line">COMエラーの発生を無視して処理を続行させることができます</div>
</div>
<div class="line-block">
<div class="line"><cite>COM_ERR_IGN</cite> でCOMエラーを抑制します</div>
<div class="line"><cite>COM_ERR_RET</cite> でCOMエラーの抑制を解除します</div>
<div class="line"><br /></div>
<div class="line"><cite>COM_ERR_IGN</cite> から <cite>COM_ERR_RET</cite> の間でCOMエラーが発生した場合</div>
<div class="line">実行時エラーで終了することなく処理を続行します</div>
<div class="line">その際に <cite>COM_ERR_FLG</cite> が <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> になります</div>
<div class="line"><br /></div>
<div class="line"><cite>COM_ERR_FLG</cite> は <cite>COM_ERR_IGN</cite> を呼んだ際に <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> に初期化されます</div>
<div class="line"><cite>COM_ERR_RET</cite> を呼んだ場合は値がそのまま維持されます</div>
<div class="line"><br /></div>
<div class="line"><cite>COM_ERR_IGN</cite> によるCOMエラーの抑制はスレッド単位で有効です</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 通常はCOMエラーで動作停止する</span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;Some.ComObject&quot;</span><span class="p">)</span>
<span class="n">obj</span><span class="o">.</span><span class="n">FireError</span><span class="p">()</span><span class="w"> </span><span class="c">// COMエラー！</span>

<span class="c">// COMエラーを抑制するパターン</span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createoleobj</span><span class="p">(</span><span class="s">&quot;Some.ComObject&quot;</span><span class="p">)</span>
<span class="c">// COMエラー抑制開始</span>
<span class="n">COM_ERR_IGN</span>

<span class="k">print</span><span class="w"> </span><span class="n">COM_ERR_FLG</span><span class="w"> </span><span class="c">// False</span>
<span class="n">obj</span><span class="o">.</span><span class="n">FireError</span><span class="p">()</span><span class="w"> </span><span class="c">// エラーになるがスクリプトは停止しない</span>
<span class="k">print</span><span class="w"> </span><span class="n">COM_ERR_FLG</span><span class="w"> </span><span class="c">// Trueになる</span>

<span class="c">// COMエラー抑制終了</span>
<span class="n">COM_ERR_RET</span>

<span class="k">print</span><span class="w"> </span><span class="n">COM_ERR_FLG</span><span class="w"> </span><span class="c">// True; COM_ERR_RETでは初期化されない</span>

<span class="n">obj</span><span class="o">.</span><span class="n">FireError</span><span class="p">()</span><span class="w"> </span><span class="c">// 抑制していないのでCOMエラー</span>
</pre></div>
</div>
</section>
</section>
<section id="id101">
<h2>リストの改行表記<a class="headerlink" href="#id101" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">一部リスト表記 (<code class="docutils literal notranslate"><span class="pre">,</span></code> 区切りの式) で改行を含めることができます</div>
<div class="line">従来では <code class="docutils literal notranslate"><span class="pre">_</span></code> による行連結が必要だったところを簡潔に記述できるようになりました</div>
</div>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 従来</span>
<span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">_</span>
<span class="w">    </span><span class="s">&quot;foo&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">_</span>
<span class="w">    </span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="w"> </span><span class="n">_</span>
<span class="w">    </span><span class="s">&quot;baz&quot;</span><span class="w">  </span><span class="n">_</span>
<span class="p">]</span>
<span class="c">// 0.5.0以降</span>
<span class="n">hoge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s">&quot;foo&quot;</span><span class="o">,</span>
<span class="w">    </span><span class="s">&quot;bar&quot;</span><span class="o">,</span>
<span class="w">    </span><span class="s">&quot;baz&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>改行を含めることができる構文</dt><dd><ul>
<li><p>配列リテラル</p></li>
<li><p>関数呼び出し時の引数</p></li>
<li><p>関数定義の引数</p></li>
<li><p>def_dllの引数型指定時</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>改行を含めることができない構文</dt><dd><ul>
<li><p>dim配列定義</p></li>
<li><p>select文case句の複数条件</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-uwscr notranslate"><div class="highlight"><pre><span></span><span class="c">// 配列リテラル</span>
<span class="k">print</span><span class="w"> </span><span class="p">[</span><span class="w">     </span><span class="c">// [ の後の改行</span>
<span class="w">    </span><span class="s">&quot;foo&quot;</span><span class="o">,</span><span class="w">  </span><span class="c">// カンマの後の改行</span>
<span class="w">    </span><span class="s">&quot;bar&quot;</span><span class="w">   </span><span class="c">// 式の後の改行</span>
<span class="w">    </span><span class="o">,</span><span class="s">&quot;baz&quot;</span><span class="w">  </span><span class="c">// カンマを式の前に書いてもいい</span>
<span class="p">]</span><span class="w">           </span><span class="c">// ] 前の改行</span>

<span class="c">// 関数呼び出し</span>
<span class="k">print</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="w"> </span><span class="c">// ( の後の改行</span>
<span class="w">    </span><span class="n">foo</span><span class="o">,</span><span class="w">    </span><span class="c">// カンマの後の改行</span>
<span class="w">    </span><span class="o">,</span><span class="w">       </span><span class="c">// 引数省略</span>
<span class="w">    </span><span class="n">bar</span><span class="w">     </span><span class="c">// 式の後の改行</span>
<span class="w">    </span><span class="o">,</span><span class="n">baz</span><span class="w">    </span><span class="c">// カンマを式の前に書いてもいい</span>
<span class="p">)</span><span class="w">           </span><span class="c">// ) 前の改行</span>

<span class="c">// 関数定義</span>
<span class="kd">function</span><span class="w"> </span><span class="n">hoge</span><span class="p">(</span>
<span class="w">    </span><span class="n">a</span><span class="o">,</span>
<span class="w">    </span><span class="k">ref</span><span class="w"> </span><span class="n">b</span><span class="o">,</span>
<span class="w">    </span><span class="n">c</span><span class="o">:</span><span class="w"> </span><span class="n">string</span><span class="o">,</span>
<span class="w">    </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="p">)</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">do_something_with</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="w">    </span><span class="n">do_something_with</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="p">)</span>
<span class="kd">fend</span>

<span class="c">// def_dll</span>
<span class="kd">def_dll</span><span class="w"> </span><span class="n">MessageBoxA</span><span class="p">(</span>
<span class="w">    </span><span class="n">hwnd</span><span class="o">,</span>
<span class="w">    </span><span class="n">string</span><span class="o">,</span>
<span class="w">    </span><span class="n">string</span><span class="o">,</span>
<span class="w">    </span><span class="n">uint</span>
<span class="p">)</span><span class="o">:</span><span class="n">int</span><span class="o">:</span><span class="n">user32</span>

<span class="c">// 以下は対象外</span>

<span class="c">// dim配列宣言で改行するとエラーになる</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">fuga</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span>
<span class="w">             </span><span class="m">2</span><span class="o">,</span>
<span class="w">             </span><span class="m">3</span>
<span class="c">// 必ず一行で書く</span>
<span class="kd">dim</span><span class="w"> </span><span class="n">hoge</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span>

<span class="c">// select文case句の複数条件で改行するとエラー</span>
<span class="kd">select</span><span class="w"> </span><span class="n">fuga</span>
<span class="w">    </span><span class="kd">case</span><span class="w"> </span><span class="m">1</span><span class="o">,</span>
<span class="w">         </span><span class="m">2</span><span class="o">,</span>
<span class="w">         </span><span class="m">3</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;ng&quot;</span>
<span class="kd">selend</span>
<span class="c">// 必ず一行で書く</span>
<span class="kd">select</span><span class="w"> </span><span class="n">hoge</span>
<span class="w">    </span><span class="kd">case</span><span class="w"> </span><span class="m">1</span><span class="o">,</span><span class="m">2</span><span class="o">,</span><span class="m">3</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="s">&quot;ok&quot;</span>
<span class="kd">selend</span>
</pre></div>
</div>
</section>
<section id="value-types">
<span id="id102"></span><h2>値型<a class="headerlink" href="#value-types" title="この見出しへのパーマリンク">#</a></h2>
<div class="line-block">
<div class="line">UWSCRは動的型付け言語であり、その値は状況により様々な型を持ちます</div>
<div class="line">以下に値が取りうる型とその詳細を記します</div>
<div class="line">各項目は以下を示します</div>
</div>
<ul class="simple">
<li><p>型: 型の呼称</p></li>
<li><p>解説: 型についての解説</p></li>
<li><dl class="simple">
<dt>文字列変換時: 暗黙の型変換で文字列に変換された場合</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">_name_</span></code> のような表記はプレースホルダです</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>種別: 値であるか参照であるか</p></li>
</ul>
<div class="table-wrapper docutils container" id="id103">
<table class="docutils align-default" id="id103">
<caption><span class="caption-text">型一覧</span><a class="headerlink" href="#id103" title="このテーブルへのパーマリンク">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>型</p></th>
<th class="head"><p>解説</p></th>
<th class="head"><p>種別</p></th>
<th class="head"><p>文字列変換時</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>数値</p></td>
<td><p>double (倍精度浮動小数点型)</p></td>
<td><p>値</p></td>
<td><p>123 → <code class="docutils literal notranslate"><span class="pre">&quot;123&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>文字列</p></td>
<td><p>文字列</p></td>
<td><p>値</p></td>
<td><p>そのまま</p></td>
</tr>
<tr class="row-even"><td><p>真偽値</p></td>
<td><p>TRUE/FALSE</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;True&quot;</span></code> / <code class="docutils literal notranslate"><span class="pre">&quot;False&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>配列</p></td>
<td><p>要素として異なる値型を格納できる</p></td>
<td><p>値</p></td>
<td><p>[1,&quot;a&quot;] → <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">a]</span></code></p></td>
</tr>
<tr class="row-even"><td><p>連想配列</p></td>
<td><p>連想配列</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">{&quot;KEY1&quot;:</span> <span class="pre">value1,</span> <span class="pre">&quot;KEY2&quot;:</span> <span class="pre">value2}</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>無名関数</p></td>
<td><p>名前なしで定義されたfunction/procedure</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">anonymous</span> <span class="pre">function(_params_)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>関数</p></td>
<td><p>名前ありで定義されたfunction/procedure</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">function:</span> <span class="pre">_name_(_params_)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>非同期関数</p></td>
<td><p>async宣言した関数</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">function:</span> <span class="pre">_name_(_params_)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>組み込み関数</p></td>
<td><p>組み込み(ビルトイン)関数</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">builtin:</span> <span class="pre">_name_()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>モジュール</p></td>
<td><p>module定義</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">module:</span> <span class="pre">_name_</span></code></p></td>
</tr>
<tr class="row-even"><td><p>クラス定義</p></td>
<td><p>class定義</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">class:</span> <span class="pre">_name_</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>クラスインスタンス</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">クラス名()</span></code> で得られる</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">instance</span> <span class="pre">of</span> <span class="pre">_name_</span></code></p></td>
</tr>
<tr class="row-even"><td><p>NULL</p></td>
<td><p>def_dllにおけるNULL文字(chr(0))、UObjectのnull値</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\0</span> <span class="pre">(chr(0))</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>EMPTY</p></td>
<td><p>空の値、場合により空文字や0として扱われる</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span> <span class="pre">(空文字)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>NOTHING</p></td>
<td><p>空オブジェクト</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NOTHING</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>正規表現</p></td>
<td><p>正規表現パターン</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">regex:</span> <span class="pre">_pattern_</span></code></p></td>
</tr>
<tr class="row-even"><td><p>UObject</p></td>
<td><p>UObject</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">JSON文字列</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>列挙型</p></td>
<td><p>enum定義</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Enum:</span> <span class="pre">_name_</span></code></p></td>
</tr>
<tr class="row-even"><td><p>タスク</p></td>
<td><p>非同期に行われる処理</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Task</span> <span class="pre">[_state_]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>DLL関数</p></td>
<td><p>def_dll定義</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">_name_(_params_):_rtype_:_path_</span></code></p></td>
</tr>
<tr class="row-even"><td><p>構造体定義</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">struct-endstruct</span></code> で得られる、関数のように呼ぶと構造体を得られる</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">_name_</span> <span class="pre">{_member_:</span> <span class="pre">_type_}</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>構造体</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">構造体定義名()</span></code> で得られる</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">_name_(_address_)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>COMオブジェクト</p></td>
<td><p>createoleobj/getactiveoleobj</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ComObject(_type_or_address_)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Unknownオブジェクト</p></td>
<td><p>COMオブジェクトのプロパティ・メソッドが返す場合がある</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IUnknown(_address_)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>VARIANT</p></td>
<td><p>値</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARIANT(_vt_)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>BrowserBuilderオブジェクト</p></td>
<td><p>起動するブラウザを構成するためのオブジェクト</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BrowserBuilder</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Browserオブジェクト</p></td>
<td><p>操作対象のブラウザを示すオブジェクト</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Browser:</span> <span class="pre">_id_</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>TabWindowオブジェクト</p></td>
<td><p>ブラウザのタブを示すオブジェクト</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TabWindow:</span> <span class="pre">_id_</span></code></p></td>
</tr>
<tr class="row-even"><td><p>RemoteObjectオブジェクト</p></td>
<td><p>Webページ上のJavaScriptオブジェクト</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RemoteObject(_id_)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>WebRequestオブジェクト</p></td>
<td><p>HTTPリクエストを構成するためのオブジェクト</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">WebRequest</span></code></p></td>
</tr>
<tr class="row-even"><td><p>WebResponseオブジェクト</p></td>
<td><p>HTTPレスポンスを示すオブジェクト</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">_responsebody_</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>HtmlNodeオブジェクト</p></td>
<td><p>パースされたHTMLドキュメントを示すオブジェクト</p></td>
<td><p>値</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">_html_</span></code></p></td>
</tr>
<tr class="row-even"><td><p>ファイルID</p></td>
<td><p>fopen()が返す</p></td>
<td><p>参照</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">_filepath_(_detail_)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>バイト配列</p></td>
<td><p>encode()で得られる</p></td>
<td><p>値</p></td>
<td><p>[1,2,3] → <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="special_variables.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">特殊変数</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../usage/example.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">サンプルコード集</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, stuncloud
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">スクリプト構文</a><ul>
<li><a class="reference internal" href="#id2">識別子</a><ul>
<li><a class="reference internal" href="#id3">キーワード一覧</a><ul>
<li><a class="reference internal" href="#id4">識別子 (変数名、定数名、関数名など) に使用できないキーワード</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id5">変数定義</a><ul>
<li><a class="reference internal" href="#dim">dim</a></li>
<li><a class="reference internal" href="#public">public</a></li>
<li><a class="reference internal" href="#const">const</a></li>
<li><a class="reference internal" href="#id6">一括定義</a></li>
<li><a class="reference internal" href="#id7">配列</a><ul>
<li><a class="reference internal" href="#id8">+演算子による要素の追加</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9">多次元配列</a></li>
<li><a class="reference internal" href="#id10">連想配列</a><ul>
<li><a class="reference internal" href="#id11">連想配列一括定義</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#enum">enum</a></li>
<li><a class="reference internal" href="#id12">関数定義</a><ul>
<li><a class="reference internal" href="#procedure">procedure</a></li>
<li><a class="reference internal" href="#function">function</a><ul>
<li><a class="reference internal" href="#id13">特殊な引数</a><ul>
<li><a class="reference internal" href="#id14">参照渡し</a></li>
<li><a class="reference internal" href="#id15">配列表記</a></li>
<li><a class="reference internal" href="#id16">デフォルト値</a></li>
<li><a class="reference internal" href="#id17">可変長引数</a></li>
<li><a class="reference internal" href="#id18">特殊な引数の組み合わせ</a></li>
</ul>
</li>
<li><a class="reference internal" href="#type-check">引数の型チェック</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id20">無名関数</a></li>
<li><a class="reference internal" href="#id21">簡易関数式</a><ul>
<li><a class="reference internal" href="#id22">即時関数</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id23">関数の特殊な使用例</a><ul>
<li><a class="reference internal" href="#id24">高階関数</a></li>
<li><a class="reference internal" href="#id25">クロージャ</a></li>
<li><a class="reference internal" href="#id26">エイリアス</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module">module</a><ul>
<li><a class="reference internal" href="#id27">module関数内でのみ使える特殊な書式</a></li>
<li><a class="reference internal" href="#id28">プライベート関数</a></li>
</ul>
</li>
<li><a class="reference internal" href="#class">class</a><ul>
<li><a class="reference internal" href="#id29">デストラクタ</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#uobject">UObject</a><ul>
<li><a class="reference internal" href="#id31">オブジェクトの作成</a></li>
<li><a class="reference internal" href="#id32">値の呼び出し、変更</a></li>
<li><a class="reference internal" href="#id33">UObjectメソッド</a><ul>
<li><a class="reference internal" href="#keys"><code class="docutils literal notranslate"><span class="pre">keys()</span></code></a></li>
<li><a class="reference internal" href="#values"><code class="docutils literal notranslate"><span class="pre">values()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id34">評価の順序</a></li>
<li><a class="reference internal" href="#id35">スコープ</a><ul>
<li><a class="reference internal" href="#id36">無名関数のスコープ</a></li>
<li><a class="reference internal" href="#id37">moduleのスコープ</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id38">数値</a></li>
<li><a class="reference internal" href="#id39">文字列</a><ul>
<li><a class="reference internal" href="#id40">特殊文字の展開</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id41">ホワイトスペース</a></li>
<li><a class="reference internal" href="#id42">演算子</a><ul>
<li><a class="reference internal" href="#id43">演算式の優先順位</a></li>
<li><a class="reference internal" href="#id44">特殊な演算</a></li>
<li><a class="reference internal" href="#id45">三項演算子</a></li>
<li><a class="reference internal" href="#id46">ビット演算子、論理演算子</a><ul>
<li><a class="reference internal" href="#id47">論理演算子</a></li>
<li><a class="reference internal" href="#id48">ビット演算子</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tf-cond">条件式の判定</a><ul>
<li><a class="reference internal" href="#id50">真偽性判定 (デフォルト)</a></li>
<li><a class="reference internal" href="#id51">真偽値のみ</a></li>
<li><a class="reference internal" href="#uwsc">UWSC方式</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id52">コメント</a><ul>
<li><a class="reference internal" href="#id53">ダミーコメント</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id54">行結合</a></li>
<li><a class="reference internal" href="#id55">マルチステートメント</a></li>
<li><a class="reference internal" href="#id56">組み込み定数</a><ul>
<li><a class="reference internal" href="#nan">NaNについて</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id57">16進数</a></li>
<li><a class="reference internal" href="#id58">起動時パラメータ</a></li>
<li><a class="reference internal" href="#option">OPTION</a></li>
<li><a class="reference internal" href="#def-dll">def_dll</a><ul>
<li><a class="reference internal" href="#id59">使用可能な型名</a></li>
<li><a class="reference internal" href="#id60">配列引数</a></li>
<li><a class="reference internal" href="#id61">参照渡し</a></li>
<li><a class="reference internal" href="#id62">構造体</a><ul>
<li><a class="reference internal" href="#id63">ポインタではない構造体</a></li>
<li><a class="reference internal" href="#id64">ネストした構造体</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about-callback">コールバック</a></li>
<li><a class="reference internal" href="#about-dll-string-param">文字列型について</a></li>
<li><a class="reference internal" href="#dll">DLL関数定義およびその呼び出し方の例</a></li>
<li><a class="reference internal" href="#id67">別名による呼び出し例</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id68">構造体</a><ul>
<li><a class="reference internal" href="#id69">構造体定義</a></li>
<li><a class="reference internal" href="#id70">構造体の利用方法</a><ul>
<li><a class="reference internal" href="#id71">構造体の初期化</a></li>
<li><a class="reference internal" href="#id72">構造体メンバへのアクセス</a></li>
<li><a class="reference internal" href="#id73">構造体のメソッド</a></li>
<li><a class="reference internal" href="#id74">ポインタから構造体を得る</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id75">スレッド</a><ul>
<li><a class="reference internal" href="#thread">thread</a></li>
</ul>
</li>
<li><a class="reference internal" href="#task-object">タスク</a><ul>
<li><a class="reference internal" href="#async">async</a></li>
<li><a class="reference internal" href="#await">await</a></li>
</ul>
</li>
<li><a class="reference internal" href="#with">with</a></li>
<li><a class="reference internal" href="#textblock">textblock</a><ul>
<li><a class="reference internal" href="#textblockex">textblockex</a></li>
</ul>
</li>
<li><a class="reference internal" href="#call">call</a><ul>
<li><a class="reference internal" href="#id79">同一ファイルの複数箇所呼び出し</a></li>
<li><a class="reference internal" href="#uwsl">uwslファイルの読み込み</a></li>
<li><a class="reference internal" href="#id80">uwslファイルについて</a><ul>
<li><a class="reference internal" href="#id81">uwslファイル作成の流れ</a></li>
<li><a class="reference internal" href="#id82">使用例</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id83">例外処理</a><ul>
<li><a class="reference internal" href="#except">except例</a></li>
<li><a class="reference internal" href="#finally">finally例</a></li>
<li><a class="reference internal" href="#except-finally">except-finally例</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id84">制御文</a><ul>
<li><a class="reference internal" href="#if">if</a><ul>
<li><a class="reference internal" href="#id85">単行if</a></li>
<li><a class="reference internal" href="#id86">複数行if</a></li>
</ul>
</li>
<li><a class="reference internal" href="#for">for</a></li>
<li><a class="reference internal" href="#for-in">for-in</a></li>
<li><a class="reference internal" href="#for-else-endfor">for-else-endfor</a></li>
<li><a class="reference internal" href="#while">while</a></li>
<li><a class="reference internal" href="#repeat">repeat</a></li>
<li><a class="reference internal" href="#continue">continue</a></li>
<li><a class="reference internal" href="#break">break</a></li>
<li><a class="reference internal" href="#select">select</a></li>
<li><a class="reference internal" href="#exit">exit</a></li>
<li><a class="reference internal" href="#exitexit">exitexit</a></li>
<li><a class="reference internal" href="#print">print</a><ul>
<li><a class="reference internal" href="#id87">print文の出力</a></li>
<li><a class="reference internal" href="#id88">ログファイルへの書き出し</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#com">COMオブジェクト</a><ul>
<li><a class="reference internal" href="#id89">プロパティの取得</a><ul>
<li><a class="reference internal" href="#id90">プロパティ取得</a></li>
<li><a class="reference internal" href="#id91">インデックス指定</a></li>
<li><a class="reference internal" href="#id92">コレクションに対するインデックス指定</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id93">プロパティの変更</a><ul>
<li><a class="reference internal" href="#id94">代入</a></li>
<li><a class="reference internal" href="#id95">インデックス指定による代入</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id96">メソッドの実行</a><ul>
<li><a class="reference internal" href="#id97">名前なし引数</a></li>
<li><a class="reference internal" href="#id98">名前付き引数</a></li>
<li><a class="reference internal" href="#id99">参照渡し</a></li>
<li><a class="reference internal" href="#wmi">一部のWMIオブジェクトのメソッドについて</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id100">型の確認</a></li>
<li><a class="reference internal" href="#com-err-ign-com-err-ret">COM_ERR_IGN-COM_ERR_RET</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id101">リストの改行表記</a></li>
<li><a class="reference internal" href="#value-types">値型</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../_static/custom.js"></script>
    </body>
</html>